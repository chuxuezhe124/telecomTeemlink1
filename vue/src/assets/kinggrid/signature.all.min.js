/*
 artDialog v6.0.5 | https://github.com/aui/artDialog kgDialog*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
!function(){function a(b){b=c[b];return"object"==typeof b?b:(b.exports||(b.exports={},b.exports=b.call(b.exports,a,b.exports,b)||b.exports),b.exports)}function b(a,b){c[a]=b}var c={};b("jquery",function(){return jQuery});b("popup",function(a){function b(){this.destroyed=!1;this.__popup=c("<div />").css({display:"none",position:"absolute",outline:0}).attr("tabindex","-1").html(this.innerHTML).appendTo("body");this.__backdrop=this.__mask=c("<div />").css({opacity:.7,background:"#000"});this.node=this.__popup[0];
this.backdrop=this.__backdrop[0];d++}var c=a("jquery"),d=0,h=!("minWidth"in c("html")[0].style),k=!h;return c.extend(b.prototype,{node:null,backdrop:null,fixed:!1,destroyed:!0,open:!1,returnValue:"",autofocus:!0,align:"bottom left",innerHTML:"",className:"ui-popup",show:function(a){if(this.destroyed)return this;var d=this.__popup,e=this.__backdrop;if(this.__activeElement=this.__getActive(),this.open=!0,this.follow=a||this.follow,!this.__ready){if(d.addClass(this.className).attr("role",this.modal?
"alertdialog":"dialog").css("position",this.fixed?"fixed":"absolute"),h||c(window).on("resize",c.proxy(this.reset,this)),this.modal)a={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",zIndex:this.zIndex||b.zIndex},d.addClass(this.className+"-modal"),k||c.extend(a,{position:"absolute",width:c(window).width()+"px",height:c(document).height()+"px"}),e.css(a).attr({tabindex:"0"}).on("focus",c.proxy(this.focus,this)),this.__mask=e.clone(!0).attr("style","").insertAfter(d),
e.addClass(this.className+"-backdrop").insertBefore(d),this.__ready=!0;d.html()||d.html(this.innerHTML)}return d.addClass(this.className+"-show").show(),e.show(),this.reset().focus(),this.__dispatchEvent("show"),this},showModal:function(){return this.modal=!0,this.show.apply(this,arguments)},close:function(a){return!this.destroyed&&this.open&&(void 0!==a&&(this.returnValue=a),this.__popup.hide().removeClass(this.className+"-show"),this.__backdrop.hide(),this.open=!1,this.blur(),this.__dispatchEvent("close")),
this},remove:function(){if(this.destroyed)return this;this.__dispatchEvent("beforeremove");b.current===this&&(b.current=null);this.__popup.remove();this.__backdrop.remove();this.__mask.remove();h||c(window).off("resize",this.reset);this.__dispatchEvent("remove");for(var a in this)delete this[a];return this},reset:function(){var a=this.follow;return a?this.__follow(a):this.__center(),this.__dispatchEvent("reset"),this},focus:function(){var a=this.node,d=this.__popup,e=b.current,f=this.zIndex=b.zIndex++;
(e&&e!==this&&e.blur(!1),c.contains(a,this.__getActive()))||(e=d.find("[autofocus]")[0],!this._autofocus&&e?this._autofocus=!0:e=a,this.__focus(e));return d.css("zIndex",f),b.current=this,d.addClass(this.className+"-focus"),this.__dispatchEvent("focus"),this},blur:function(a){var b=this.__activeElement;return!1!==a&&this.__focus(b),this._autofocus=!1,this.__popup.removeClass(this.className+"-focus"),this.__dispatchEvent("blur"),this},addEventListener:function(a,b){return this.__getEventListener(a).push(b),
this},removeEventListener:function(a,b){a=this.__getEventListener(a);for(var c=0;c<a.length;c++)b===a[c]&&a.splice(c--,1);return this},__getEventListener:function(a){var b=this.__listener;return b||(b=this.__listener={}),b[a]||(b[a]=[]),b[a]},__dispatchEvent:function(a){var b=this.__getEventListener(a);this["on"+a]&&this["on"+a]();for(a=0;a<b.length;a++)b[a].call(this)},__focus:function(a){try{this.autofocus&&!/^iframe$/i.test(a.nodeName)&&a.focus()}catch(m){}},__getActive:function(){try{var a=document.activeElement,
b=a.contentDocument;return b&&b.activeElement||a}catch(p){}},__center:function(){var a=this.__popup,b=c(window),d=c(document),e=this.fixed,f=e?0:d.scrollLeft();d=e?0:d.scrollTop();e=b.width();var g=b.height();b=a.width();var h=a.height();g=382*(g-h)/1E3+d;a=a[0].style;a.left=Math.max(parseInt((e-b)/2+f),f)+"px";a.top=Math.max(parseInt(g),d)+"px"},__follow:function(a){var b=a.parentNode&&c(a),d=this.__popup;if(this.__followSkin&&d.removeClass(this.__followSkin),b){var e=b.offset();if(0>e.left*e.top)return this.__center()}var f=
this.fixed,g=c(window);e=c(document);var h=g.width(),k=g.height(),l=e.scrollLeft(),x=e.scrollTop();e=d.width();g=d.height();var y=b?b.outerWidth():0,z=b?b.outerHeight():0,u=this.__offset(a);a=u.left;u=u.top;a=f?a-l:a;u=f?u-x:u;l=f?0:l;f=f?0:x;h=l+h-e;k=f+k-g;x={};var w=this.align.split(" "),C=this.className+"-",G={top:"bottom",bottom:"top",left:"right",right:"left"},t={top:"top",bottom:"top",left:"left",right:"left"},F=[{top:u-g,bottom:u+z,left:a-e,right:a+y},{top:u,bottom:u-g+z,left:a,right:a-e+
y}];e={left:a+y/2-e/2,top:u+z/2-g/2};var H={left:[l,h],top:[f,k]};c.each(w,function(a,b){F[a][b]>H[t[b]][1]&&(b=w[a]=G[b]);F[a][b]<H[t[b]][0]&&(w[a]=G[b])});w[1]||(t[w[1]]="left"===t[w[0]]?"top":"left",F[1][w[1]]=e[t[w[1]]]);this.__followSkin=C+=w.join("-")+" "+this.className+"-follow";b&&d.addClass(C);x[t[w[0]]]=parseInt(F[0][w[0]]);x[t[w[1]]]=parseInt(F[1][w[1]]);d.css(x)},__offset:function(a){var b=a.parentNode,d=b?c(a).offset():{left:a.pageX,top:a.pageY};a=b?a:a.target;b=a.ownerDocument;a=b.defaultView||
b.parentWindow;if(a==window)return d;a=a.frameElement;var e=c(b);b=e.scrollLeft();e=e.scrollTop();a=c(a).offset();return{left:d.left+a.left-b,top:d.top+a.top-e}}}),b.zIndex=1024,b.current=null,b});b("dialog-config",{backdropBackground:"#000",backdropOpacity:.7,content:'<span class="ui-dialog-loading">Loading..</span>',title:"",statusbar:"",button:null,ok:null,cancel:null,okValue:"ok",cancelValue:"cancel",cancelDisplay:!0,width:"",height:"",padding:"",skin:"",quickClose:!1,cssUri:"../css/ui-dialog.css",
innerHTML:'<div i="dialog" class="ui-dialog"><div class="ui-dialog-arrow-a"></div><div class="ui-dialog-arrow-b"></div><table class="ui-dialog-grid"><tr><td i="header" class="ui-dialog-header"><button i="close" class="ui-dialog-close">&#215;</button><div i="title" class="ui-dialog-title"></div></td></tr><tr><td i="body" class="ui-dialog-body"><div i="content" class="ui-dialog-content"></div></td></tr><tr><td i="footer" class="ui-dialog-footer"><div i="statusbar" class="ui-dialog-statusbar"></div><div i="button" class="ui-dialog-button"></div></td></tr></table></div>'});
b("dialog",function(a){var b=a("jquery"),c=a("popup"),d=a("dialog-config"),h=d.cssUri;h&&(a=a[a.toUrl?"toUrl":"resolve"])&&(h=a(h),h='<link rel="stylesheet" href="'+h+'" />',b("base")[0]?b("base").before(h):b("head").append(h));var k=0,l=new Date-0;h=!("minWidth"in b("html")[0].style);var m="createTouch"in document&&!("onmousemove"in document)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent),p=!h&&!m,n=function(a,c,d){var e=a=a||{};"string"!=typeof a&&1!==a.nodeType||(a={content:a,fixed:!m});a=b.extend(!0,
{},n.defaults,a);a.original=e;e=a.id=a.id||l+k;var f=n.get(e);return f?f.focus():(p||(a.fixed=!1),a.quickClose&&(a.modal=!0,a.backdropOpacity=0),b.isArray(a.button)||(a.button=[]),void 0!==d&&(a.cancel=d),a.cancel&&a.button.push({id:"cancel",value:a.cancelValue,callback:a.cancel,display:a.cancelDisplay}),void 0!==c&&(a.ok=c),a.ok&&a.button.push({id:"ok",value:a.okValue,callback:a.ok,autofocus:!0}),n.list[e]=new n.create(a))};h=function(){};h.prototype=c.prototype;h=n.prototype=new h;return n.create=
function(a){var d=this;b.extend(this,new c);var e=(a.original,b(this.node).html(a.innerHTML)),f=b(this.backdrop);return this.options=a,this._popup=e,b.each(a,function(a,b){"function"==typeof d[a]?d[a](b):d[a]=b}),a.zIndex&&(c.zIndex=a.zIndex),e.attr({"aria-labelledby":this._$("title").attr("id","title:"+this.id).attr("id"),"aria-describedby":this._$("content").attr("id","content:"+this.id).attr("id")}),this._$("close").css("display",!1===this.cancel?"none":"").attr("title",this.cancelValue).on("click",
function(a){d._trigger("cancel");a.preventDefault()}),this._$("dialog").addClass(this.skin),this._$("body").css("padding",this.padding),a.quickClose&&f.on("onmousedown"in document?"mousedown":"click",function(){return d._trigger("cancel"),!1}),this.addEventListener("show",function(){f.css({opacity:0,background:a.backdropBackground}).animate({opacity:a.backdropOpacity},150)}),this._esc=function(a){var b=a.target,e=b.nodeName,f=/^input|textarea$/i;a=a.keyCode;c.current!==d||f.test(e)&&"button"!==b.type||
27===a&&d._trigger("cancel")},b(document).on("keydown",this._esc),this.addEventListener("remove",function(){b(document).off("keydown",this._esc);delete n.list[this.id]}),k++,n.oncreate(this),this},n.create.prototype=h,b.extend(h,{content:function(a){var c=this._$("content");return"object"==typeof a?(a=b(a),c.empty("").append(a.show()),this.addEventListener("beforeremove",function(){b("body").append(a.hide())})):c.html(a),this.reset()},title:function(a){return this._$("title").text(a),this._$("header")[a?
"show":"hide"](),this},width:function(a){return this._$("content").css("width",a),this.reset()},height:function(a){return this._$("content").css("height",a),this.reset()},button:function(a){a=a||[];var c=this,d="",e=0;return this.callbacks={},"string"==typeof a?(d=a,e++):b.each(a,function(a,f){var g=f.id=f.id||f.value;a="";c.callbacks[g]=f.callback;!1===f.display?a=' style="display:none"':e++;d+='<button type="button" i-id="'+g+'"'+a+(f.disabled?" disabled":"")+(f.autofocus?' autofocus class="ui-dialog-autofocus"':
"")+">"+f.value+"</button>";c._$("button").on("click","[i-id="+g+"]",function(a){b(this).attr("disabled")||c._trigger(g);a.preventDefault()})}),this._$("button").html(d),this._$("footer")[e?"show":"hide"](),this},statusbar:function(a){return this._$("statusbar").html(a)[a?"show":"hide"](),this},_$:function(a){return this._popup.find("[i="+a+"]")},_trigger:function(a){a=this.callbacks[a];return"function"!=typeof a||!1!==a.call(this)?this.close().remove():this}}),n.oncreate=b.noop,n.getCurrent=function(){return c.current},
n.get=function(a){return void 0===a?n.list:n.list[a]},n.list={},n.defaults=d,n});window.dialog=a("dialog")}();var maxTickDepth$$module$webapp$kinggrid$signature_all=100,toString$$module$webapp$kinggrid$signature_all=Object.prototype.toString,nextTick$$module$webapp$kinggrid$signature_all="function"===typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},isArray$$module$webapp$kinggrid$signature_all=Array.isArray||function(a){return"[object Array]"===toString$$module$webapp$kinggrid$signature_all.call(a)};
function slice$$module$webapp$kinggrid$signature_all(a,b){var c=a.length,d=Array(c);for(b=b||0;c-- >b;)d[c-b]=a[c];return d}function carry$$module$webapp$kinggrid$signature_all(a,b){try{b.apply(null,slice$$module$webapp$kinggrid$signature_all(arguments,2))}catch(c){a(c)}}function defer$$module$webapp$kinggrid$signature_all(a,b){var c=slice$$module$webapp$kinggrid$signature_all(arguments,2);nextTick$$module$webapp$kinggrid$signature_all(function(){try{b.apply(null,c)}catch(d){a(d)}})}
function Thenjs$$module$webapp$kinggrid$signature_all(a,b){if(a instanceof Thenjs$$module$webapp$kinggrid$signature_all)return a;if(!(this instanceof Thenjs$$module$webapp$kinggrid$signature_all))return new Thenjs$$module$webapp$kinggrid$signature_all(a,b);this._finally=this._error=this._fail=this._result=this._nextThen=this._chain=this._success=this._each=this._eachSeries=this._parallel=this._series=null;if(!arguments.length)return this;var c=genContinuation$$module$webapp$kinggrid$signature_all(this,
b);try{"function"===typeof a?a(c):null==a?c():"function"===typeof a.toThunk?a.toThunk()(c):"function"===typeof a.then?a.then(function(a){c(null,a)},c):c(null,a)}catch(d){c(d)}}Thenjs$$module$webapp$kinggrid$signature_all.defer=defer$$module$webapp$kinggrid$signature_all;
Thenjs$$module$webapp$kinggrid$signature_all.each=function(a,b,c){return thenFactory$$module$webapp$kinggrid$signature_all(function(c){defer$$module$webapp$kinggrid$signature_all(c,each$$module$webapp$kinggrid$signature_all,c,a,b)},null,c)};Thenjs$$module$webapp$kinggrid$signature_all.eachSeries=function(a,b,c){return thenFactory$$module$webapp$kinggrid$signature_all(function(c){defer$$module$webapp$kinggrid$signature_all(c,eachSeries$$module$webapp$kinggrid$signature_all,c,a,b)},null,c)};
Thenjs$$module$webapp$kinggrid$signature_all.parallel=function(a,b){return thenFactory$$module$webapp$kinggrid$signature_all(function(b){defer$$module$webapp$kinggrid$signature_all(b,parallel$$module$webapp$kinggrid$signature_all,b,a)},null,b)};Thenjs$$module$webapp$kinggrid$signature_all.series=function(a,b){return thenFactory$$module$webapp$kinggrid$signature_all(function(b){defer$$module$webapp$kinggrid$signature_all(b,series$$module$webapp$kinggrid$signature_all,b,a)},null,b)};
Thenjs$$module$webapp$kinggrid$signature_all.nextTick=function(a){var b=slice$$module$webapp$kinggrid$signature_all(arguments,1);nextTick$$module$webapp$kinggrid$signature_all(function(){a.apply(null,b)})};Thenjs$$module$webapp$kinggrid$signature_all.onerror=function(a){console.error("Thenjs caught error: ",a);throw a;};var proto$$module$webapp$kinggrid$signature_all=Thenjs$$module$webapp$kinggrid$signature_all.prototype;
proto$$module$webapp$kinggrid$signature_all.fin=proto$$module$webapp$kinggrid$signature_all.all=proto$$module$webapp$kinggrid$signature_all["finally"]=function(a){return thenFactory$$module$webapp$kinggrid$signature_all(function(b,c){c._finally=wrapTaskHandler$$module$webapp$kinggrid$signature_all(b,a)},this)};
proto$$module$webapp$kinggrid$signature_all.then=function(a,b){return thenFactory$$module$webapp$kinggrid$signature_all(function(c,d){d._success=wrapTaskHandler$$module$webapp$kinggrid$signature_all(c,a);d._error=b&&wrapTaskHandler$$module$webapp$kinggrid$signature_all(c,b)},this)};
proto$$module$webapp$kinggrid$signature_all.fail=proto$$module$webapp$kinggrid$signature_all["catch"]=function(a){return thenFactory$$module$webapp$kinggrid$signature_all(function(b,c){c._fail=wrapTaskHandler$$module$webapp$kinggrid$signature_all(b,a);c._success=function(){b.apply(null,[null].concat(slice$$module$webapp$kinggrid$signature_all(arguments)))}},this)};
proto$$module$webapp$kinggrid$signature_all.each=function(a,b){return thenFactory$$module$webapp$kinggrid$signature_all(function(c,d){d._each=function(d,f){each$$module$webapp$kinggrid$signature_all(c,a||d,b||f)}},this)};proto$$module$webapp$kinggrid$signature_all.eachSeries=function(a,b){return thenFactory$$module$webapp$kinggrid$signature_all(function(c,d){d._eachSeries=function(d,f){eachSeries$$module$webapp$kinggrid$signature_all(c,a||d,b||f)}},this)};
proto$$module$webapp$kinggrid$signature_all.parallel=function(a){return thenFactory$$module$webapp$kinggrid$signature_all(function(b,c){c._parallel=function(c){parallel$$module$webapp$kinggrid$signature_all(b,a||c)}},this)};proto$$module$webapp$kinggrid$signature_all.series=function(a){return thenFactory$$module$webapp$kinggrid$signature_all(function(b,c){c._series=function(c){series$$module$webapp$kinggrid$signature_all(b,a||c)}},this)};
proto$$module$webapp$kinggrid$signature_all.toThunk=function(){var a=this;return function(b){a._result?(b.apply(null,a._result),a._result=!1):!1!==a._result&&(a._finally=b)}};
function continuation$$module$webapp$kinggrid$signature_all(a){var b=this,c=arguments;if(!1!==b._result){!b._result&&b._chain&&b.debug.apply(b,["\nChain "+b._chain+": "].concat(slice$$module$webapp$kinggrid$signature_all(c)));b._result=!1;try{continuationExec$$module$webapp$kinggrid$signature_all(b,c,a)}catch(d){nextTick$$module$webapp$kinggrid$signature_all(function(){continuationError$$module$webapp$kinggrid$signature_all(b,d,a)})}}}
function continuationExec$$module$webapp$kinggrid$signature_all(a,b,c){if(a._finally)return a._finally.apply(null,b);if(null!=c)throw c;if(c=a._success||a._each||a._eachSeries||a._parallel||a._series)return c.apply(null,slice$$module$webapp$kinggrid$signature_all(b,1));a._result=b}
function continuationError$$module$webapp$kinggrid$signature_all(a,b,c){var d=a,e=a._error||a._fail;a._nextThen&&null==c&&(e=null,d=a._nextThen);for(;!e&&d;)e=d._fail,d=d._nextThen;if(e)return e(b);if(Thenjs$$module$webapp$kinggrid$signature_all.onerror)return Thenjs$$module$webapp$kinggrid$signature_all.onerror(b);d._result=[b]}
function genContinuation$$module$webapp$kinggrid$signature_all(a,b){function c(){return continuation$$module$webapp$kinggrid$signature_all.apply(a,arguments)}c._isCont=!0;b&&(proto$$module$webapp$kinggrid$signature_all.debug="function"===typeof b?b:defaultDebug$$module$webapp$kinggrid$signature_all,a._chain=1);return c}
function thenFactory$$module$webapp$kinggrid$signature_all(a,b,c){var d=new Thenjs$$module$webapp$kinggrid$signature_all;c=genContinuation$$module$webapp$kinggrid$signature_all(d,c);a(c,b);if(!b)return d;b._nextThen=d;b._chain&&(d._chain=b._chain+1);b._result&&nextTick$$module$webapp$kinggrid$signature_all(function(){continuation$$module$webapp$kinggrid$signature_all.apply(b,b._result)});return d}
function wrapTaskHandler$$module$webapp$kinggrid$signature_all(a,b){return b._isCont?b:function(){b.apply(null,[a].concat(slice$$module$webapp$kinggrid$signature_all(arguments)))}}function parallelNext$$module$webapp$kinggrid$signature_all(a,b,c,d){function e(e,g){if(!c.finished){if(null!=e)return c.finished=!0,a(e);b[d]=g;return 0>--c.i&&a(null,b)}}e._isCont=!0;return e}
function each$$module$webapp$kinggrid$signature_all(a,b,c){var d,e=[],f={};if(!isArray$$module$webapp$kinggrid$signature_all(b))return a(errorify$$module$webapp$kinggrid$signature_all(b,"each"));f.i=d=b.length-1;if(0>d)return a(null,e);for(var g=0;g<=d;g++)c(parallelNext$$module$webapp$kinggrid$signature_all(a,e,f,g),b[g],g,b)}
function parallel$$module$webapp$kinggrid$signature_all(a,b){var c,d=[],e={};if(!isArray$$module$webapp$kinggrid$signature_all(b))return a(errorify$$module$webapp$kinggrid$signature_all(b,"parallel"));e.i=c=b.length-1;if(0>c)return a(null,d);for(var f=0;f<=c;f++)b[f](parallelNext$$module$webapp$kinggrid$signature_all(a,d,e,f),f,b)}
function eachSeries$$module$webapp$kinggrid$signature_all(a,b,c){function d(l,m){if(null!=l)return a(l);f[e]=m;if(++e>k)return a(null,f);g=0<--h?carry$$module$webapp$kinggrid$signature_all:(h=maxTickDepth$$module$webapp$kinggrid$signature_all,defer$$module$webapp$kinggrid$signature_all);g(a,c,d,b[e],e,b)}var e=0,f=[],g,h=maxTickDepth$$module$webapp$kinggrid$signature_all;d._isCont=!0;if(!isArray$$module$webapp$kinggrid$signature_all(b))return a(errorify$$module$webapp$kinggrid$signature_all(b,"eachSeries"));
var k=b.length-1;if(0>k)return a(null,f);c(d,b[0],0,b)}
function series$$module$webapp$kinggrid$signature_all(a,b){function c(k,l){if(null!=k)return a(k);e[d]=l;if(++d>h)return a(null,e);f=0<--g?carry$$module$webapp$kinggrid$signature_all:(g=maxTickDepth$$module$webapp$kinggrid$signature_all,defer$$module$webapp$kinggrid$signature_all);f(a,b[d],c,d,b)}var d=0,e=[],f,g=maxTickDepth$$module$webapp$kinggrid$signature_all;c._isCont=!0;if(!isArray$$module$webapp$kinggrid$signature_all(b))return a(errorify$$module$webapp$kinggrid$signature_all(b,"series"));
var h=b.length-1;if(0>h)return a(null,e);b[0](c,0,b)}function defaultDebug$$module$webapp$kinggrid$signature_all(){console.log.apply(console,arguments)}function errorify$$module$webapp$kinggrid$signature_all(a,b){return Error("The argument "+(a&&a.toString())+' in "'+b+'" is not Array!')}Thenjs$$module$webapp$kinggrid$signature_all.NAME="Thenjs";Thenjs$$module$webapp$kinggrid$signature_all.VERSION="1.3.4";
var instance$$module$webapp$kinggrid$signature_all,root$$module$webapp$kinggrid$signature_all=window,KG$$module$webapp$kinggrid$signature_all=function(){function a(a,b){var c=p.length,d=a.constructor;d=q.is("Function",d)&&d.prototype||ObjProto;var e="constructor";for(q.has(a,e)&&!_.contains(b,e)&&b.push(e);c--;)e=p[c],e in a&&a[e]!==d[e]&&!_.contains(b,e)&&b.push(e)}function b(a){a=JSON.stringify(a);return e?a.replace(/\\u([0-9a-fA-F]{2,4})/g,function(a,b){return String.fromCharCode(parseInt(b,16))}):
a}function c(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)?!1:"qq"==a.match(/QQ/i)?!1:"weibo"==a.match(/WeiBo/i)?!1:null!=a.match(/Android/i)?null==a.match(/browser/i):null!=a.match(/iPhone/i)?null==a.match(/safari/i):null==a.match(/macintosh/i)&&null==a.match(/windows/i)}function d(a){for(var c=[],d=0;d<a.length;d++){var e={};e.type=Q[Object.prototype.toString.call(a[d]).slice(8,-1)];e.value=a[d];c.push(e)}return b(c)}var e=!1;root$$module$webapp$kinggrid$signature_all.JSON&&
(e='{"x":"\u4e2d"}'!==root$$module$webapp$kinggrid$signature_all.JSON.stringify({x:"\u4e2d"}));var f=function(a,b){a=this.words=a||[];this.sigBytes=void 0!=b?b:4*a.length};f.prototype={clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=Math.ceil(b/4)},toString:function(a){return(a||g).stringify(this)}};var g={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},
parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},h={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new f(c,b)}},k={stringify:function(a){try{return decodeURIComponent(escape(h.stringify(a)))}catch(K){throw Error("Malformed UTF-8 data");
}},parse:function(a){return h.parse(unescape(encodeURIComponent(a)))}},l=function(a){this.map=a};l.map={};l.of=function(a){a=a||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var b=l.map[a];b||(b=new l(a));return b};l.prototype={decodeByte:function(a){var b=a.length,c=this.map,d=c.charAt(64);d&&(d=a.indexOf(d),-1!=d&&(b=d));d=[];for(var e=0,g=0;g<b;g++)if(g%4){var h=c.indexOf(a.charAt(g-1))<<g%4*2,I=c.indexOf(a.charAt(g))>>>6-g%4*2;d[e>>>2]|=(h|I)<<24-e%4*8;e++}return new f(d,
e)},decode:function(a){return k.stringify(this.decodeByte(a))},encode:function(a){if(a)return this.encodeByte(k.parse(a))},encodeByte:function(a){var b=a.words,c=a.sigBytes,d=this.map;a.clamp();a=[];for(var e=0;e<c;e+=3)for(var f=(b[e>>>2]>>>24-e%4*8&255)<<16|(b[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|b[e+2>>>2]>>>24-(e+2)%4*8&255,g=0;4>g&&e+.75*g<c;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")}};var m=!{toString:null}.propertyIsEnumerable("toString"),
p="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" "),n=function(a,b){var c=a.length,d=[];for(b=b||0;c-- >b;)d[c-b]=a[c];return d},r=function(){},q={Utf8:k,Base64:l,slice:n,boolean:function(a,b,c){return!(a.hasOwnProperty(b)?!a[b]:!c)},rand:function(a){return Math.ceil((9301*(new Date).getTime()+49297)%233280/233280*a)},addEvent:function(a){var b=c();return a?function(a,b,c){b=b.split(" ");for(var d=0;d<b.length;d++)a.attachEvent("on"+b[d],function(b){b.target=
a;b.preventDefault=r;b.stopPropagation=r;c(b)})}:function(a,c,d){void 0===a.eventList&&(a.eventList={});for(var e=c.split(" "),f=0;f<e.length;f++){for(var g in a.eventList)if(g===e[f])return;b?a.addEventListener(e[f],d):document.addEventListener.apply(a,[e[f]].concat(q.slice(arguments,2)));a.eventList[e[f]]=!0}}}(root$$module$webapp$kinggrid$signature_all.document.attachEvent),extend:function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;e<d;e++)for(var f=arguments[e],
g=a(f),h=g.length,K=0;K<h;K++){var I=g[K];b&&void 0!==c[I]||(c[I]=f[I])}return c}}(function(b){if(!q.is("Object",b))return[];var c=[],d;for(d in b)c.push(d);m&&a(b,c);return c}),filter:function(a,b){var c={},d=b;if(q.is("String",b)){var e=q.slice(arguments,1);d=function(a){for(var b=0;b<e.length;b++)if(e[b]===a)return!1;return!0}}for(var f in a)(e=d.call(a,f))&&(c[f]=a[f]);return c},val:function(a,b){if(q.is("Function",a)){var c=3>arguments.length?[]:[].slice.call(arguments).slice(2);return a.apply(b,
c)}return a},$:function(a){var b=document.getElementById(a);if(!b){var c=document.getElementsByName(a);c&&0<c.length&&(b=c[0])}b||(c=document.getElementsByTagName(a))&&0<c.length&&(b=c[0]);return b},keys:function(b){if(!q.is("Object",b))return[];if(nativeKeys)return nativeKeys(b);var c=[],d;for(d in b)q.has(b,d)&&c.push(d);m&&a(b,c);return c},contains:function(a,b,c){var d=a&&a.length;"number"==typeof d&&0<=d&&d<=MAX_ARRAY_INDEX||(a=_.values(a));return 0<=_.indexOf(a,b,"number"==typeof c&&c)},values:function(a){for(var b=
_.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d},has:function(a,b){return null!=a&&Object.prototype.hasOwnProperty.call(a,b)},inherit:function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.uber=b.prototype},is:function(a,b){var c=Object.prototype.toString.call(b).slice(8,-1);return void 0!==b&&null!==b&&c===a},colorRgb:function(a){a=a.toLowerCase();var b=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(a&&b.test(a)){if(4===a.length){var c="#";
for(b=1;4>b;b+=1)c+=a.slice(b,b+1).concat(a.slice(b,b+1));a=c}c=[];for(b=1;7>b;b+=2)c.push(parseInt("0x"+a.slice(b,b+2)));return"RGB("+c.join(",")+")"}return a},colorHex:function(a){if(/^(rgb|RGB)/.test(a)){for(var b=a.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),c="#",d=0;d<b.length;d++){var e=Number(b[d]).toString(16);"0"===e&&(e+=e);c+=e}7!==c.length&&(c=a);return c.toUpperCase()}if(/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a)&&(b=a.replace(/#/,"").split(""),6!==b.length&&3===b.length))for(a="#",
d=0;d<b.length;d+=1)a+=b[d]+b[d];return a.toUpperCase()},dateConvert:function(a,b){var c=["\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d".split(""),"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d".split("")];a=a.match(/^(\d{2}|\d{4})(\u5e74)(\d{1,2})(\u6708)(\d{1,2})(\u65e5)$/);var d="";if(null!=a){for(var e=1;e<a.length;e+=2){var f=a[e];if(2==f.length)f="1"==f.charAt(0)?"0"==f.charAt(1)?"\u5341":"\u5341"+c[b-1][f.charAt(1)]:"0"==f.charAt(1)?c[b-1][f.charAt(0)]+"\u5341":
c[b-1][f.charAt(0)]+"\u5341"+c[b-1][f.charAt(1)];else{for(var g="",h=0;h<f.length;h++)g+=c[b-1][f.charAt(h)];f=g}d+=f+a[e+1]}return d}},formatDate:function(a,b){var c={MMM:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)(new RegExp("("+
d+")")).test(b)&&(a=c[d],2==RegExp.$1.length&&(a=("00"+c[d]).substr((""+c[d]).length)),b=b.replace(RegExp.$1,a));/[*]/gi.test(b)&&(c=b.replace(/[*]/gi,""),b=this.dateConvert(c,b.length-c.length));return b},template:function(a,b){for(var c=/<%([^%>]+)?%>/g,d=/(^( )?(var|if|for|else|switch|case|break|{|}))(.*)?/g,e="var r=[];\n",f=0,g=function(a,b){b?e+=a.match(d)?a+"\n":"r.push("+a+");\n":e+=""!=a?'r.push("'+a.replace(/"/g,'\\"')+'");\n':"";return g},h;h=c.exec(a);)g(a.slice(f,h.index))(h[1],!0),f=
h.index+h[0].length;g(a.substr(f,a.length-f));e+='return r.join("");';return(new Function(e.replace(/[\r\t\n]/g,""))).apply(b,n(arguments,2))},first:function(a,b){return a.substring(0,1)[b?"toLowerCase":"toUpperCase"]()+a.substring(1)},html2Escape:function(a){return a.replace(/[<>&"]/g,function(a){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[a]})}},B=function(a){this.name=a};B.prototype={on:function(a,b){this.__getEventListener(a).push(b);return this},off:function(a,b){a=this.__getEventListener(a);
for(var c=0;c<a.length;c++)b===a[c]&&a.splice(c--,1);return this},clear:function(a){0<this.__getEventListener(a).length&&(this.__listener[a]=[]);return this},trigger:function(a){var b,c=this.__getEventListener(a),d=Array.prototype.slice.call(arguments);this["on"+a]&&(b=this["on"+a].apply(this,d.slice(1)));for(var e=0;e<c.length;e++)c[e].apply(this,d.slice(1));return b},__getEventListener:function(a){var b=this.__listener;b||(b=this.__listener={});b[a]||(b[a]=[]);return b[a]}};var v=function(a,b){var c=
0,d="",e;for(e in a){var f=a[e];if(void 0!=f){var g=function(a){0<c&&(d+=b);d+=e+"="+a;c++};if(q.is("Array",f))for(var h=0;h<f.length;h++)g(f[h]);else g(f)}}D.trigger("formatData",d);return d},E=function(a,b){var c="";b=b||"";if(q.is("Array",a))for(var d=0;d<a.length;d++)0<d&&(c+=b),c+=v(a[d],b);else c=v(a,b);return c},x={result:!1,errcode:"interErr"},y={result:!1,errcode:"responseErr"},z={result:!1,errcode:"connectionErr"},u={result:!1,errcode:"parseErr"},w={result:!1,errcode:"timeoutErr"},C=function(a,
b){D.trigger.apply(D,["response",b].concat(this));n(arguments,1);a&&a(b)},G=function(a,b){this.url=a;this.data=b;D.trigger("beforeJSONP",a,b)},t=G.prototype;t.parseData=function(){var a="",b=this.data;if(q.is("String",b))a=b;else if(q.is("Object",b))for(var c in b)b[c]&&(a+="&"+c+"="+encodeURIComponent(b[c]));else if(q.is("Array",b))for(var d=0;d<b.length;d++){var e=b[d];for(c in e)e[c]&&(a+="&"+c+"="+encodeURIComponent(e[c]))}a+="&hookback="+this.name;a+="&_="+(new Date).getTime();a=a.substr(1);
D.trigger("parseData",a);return a};t.getJSON=function(a){var b=this,c=b.url,d=b.data,e=this.name="jsonp_"+(new Date).getTime()+"_"+q.rand(1E5);c=c+(-1===c.indexOf("?")?"?":"&")+this.parseData(d);var f=document.createElement("script");f.type="text/javascript";f.src=c;f.id=e;f.charset="utf-8";var g=function(){setTimeout(function(){clearTimeout(h);f.parentNode.removeChild(f);try{delete window[e]}catch(W){}},1)};window[e]=function(c){b._execed=!0;C.call(b,a,c)};f.onload=function(){g();b._execed||C.call(b,
a,u)};f.onerror=function(){g();void 0!==Signature$$module$webapp$kinggrid$signature_all.options.isResponseErr&&Signature$$module$webapp$kinggrid$signature_all.options.isResponseErr||C.call(b,a,y)};var h=setTimeout(function(){g();C.call(b,a,w)},A.options.timeout);(c=document.getElementsByTagName("head"))&&c[0]&&c[0].appendChild(f)};var F=function(a,b){this.url=a;this.data=b;this.xdr=new XDomainRequest};F.prototype.getJSON=function(a){var b=this.xdr;b.onload=function(){try{var c=JSON.parse(b.responseText)}catch(T){C.call(b,
a,u);return}C.call(b,a,c)};b.onerror=function(){C.call(b,a,z)};b.timeout=A.options.timeout;b.ontimeout=function(){C.call(b,a,w)};b.open("POST",this.url);b.send(E(this.data,"\r\n")+"\r\na=1")};var H=function(a,b){if(window.XMLHttpRequest)var c=new XMLHttpRequest;else if(window.ActiveXObject)for(var d=0;d<activexName.length;d++)try{c=new ActiveXObject(activexName[d]);break}catch(U){}this.xhr=c;this.url=a;this.data=b};H.prototype.getJSON=function(a){var b=this.xhr,c=!1;b.onreadystatechange=function(){if(4==
b.readyState)if(200==b.status||304==b.status)try{var d=JSON.parse(b.responseText);C.call(b,a,d)}catch(V){C.call(b,a,u)}else c&&C.call(b,a,y)};b.open("POST",this.url,!0);b.onerror=function(){C.call(b,a,z)};b.timeout=A.options.timeout;b.ontimeout=function(){c=!0;C.call(b,a,w)};b.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var d=E(this.data,"\r\n");b.send(d)};var P="withCredentials"in XMLHttpRequest.prototype?!1:"undefined"!=typeof XDomainRequest?!0:!1,J=function(a,b,c){D.trigger.apply(D,
["beforeAjax"].concat(n(arguments)));return c?new G(a,b):P?new F(a,b):new H(a,b)},Q={Boolean:"BOOL",String:"BSTR",Number:"LONG"},A=function(){};A.errCode={1E4:"\u7cfb\u7edf\u9519\u8bef",20001:"\u5bc6\u94a5\u76d8\u4fe1\u606f\u9519\u8bef",20003:"\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u8f93\u5165\u6b63\u786e\u5bc6\u7801",20004:"\u8bf7\u8f93\u5165\u5bc6\u7801!",11100:"\u7b7e\u7ae0\u670d\u52a1\u5668\u9519\u8bef",111001:"\u8be5\u7528\u6237\u6ca1\u6709\u516c\u7ae0",111002:"\u8be5\u7528\u6237\u6ca1\u6709\u79c1\u7ae0",
111003:"\u8be5\u7528\u6237\u6ca1\u6709\u6cd5\u4eba\u7ae0",111004:"\u8be5\u7528\u6237\u6ca1\u6709\u6cd5\u4eba\u7b7e\u540d\u5370\u7ae0",111005:"\u8be5\u7528\u6237\u6ca1\u6709\u624b\u5199\u7b7e\u540d\u5370\u7ae0",11101:"\u5f53\u524d\u7528\u6237\u6ca1\u6709\u7b7e\u7ae0",11102:"\u5370\u7ae0\u9519\u8bef",11103:"\u8bc1\u4e66\u8fc7\u671f",11104:"\u5370\u7ae0\u8fc7\u671f",11105:"\u83b7\u53d6\u7b7e\u7ae0\u4fe1\u606f\u5931\u8d25!",11106:"\u83b7\u53d6\u8bc1\u4e66\u4fe1\u606f\u5931\u8d25!",11107:"\u672a\u641c\u7d22\u5230\u60a8\u8981\u7684\u7b7e\u7ae0!",
11108:"\u672a\u8bbe\u7f6e\u7b7e\u7ae0\u5bc6\u7801!",11109:"\u64cd\u4f5c\u5931\u8d25\uff0c\u7b7e\u7ae0\u52a9\u624b\u672a\u542f\u7528\u6216\u672a\u6388\u6743",11110:"\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u62d4\u6389\u5f53\u524d\u94a5\u5319\u76d8\u518d\u8fdb\u884c\u64cd\u4f5c",11111:"\u5141\u8bb8\u79fb\u52a8\u5931\u8d25\uff0c\u8bf7\u4f7f\u7528\u539f\u7b7e\u7ae0\u5bc6\u94a5\u5141\u8bb8\u79fb\u52a8\uff01",11112:"\u5141\u8bb8\u79fb\u52a8\u5931\u8d25\uff0c\u8be5\u7b7e\u7ae0\u6570\u636e\u6ca1\u6709\u5141\u8bb8\u79fb\u52a8\u8bf7\u6c42\u6743\u9650\uff01",
11113:"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u624b\u5199\u7b7e\u540d\u3002",none:"\u5ba2\u6237\u7aef\u672a\u77e5\u5f02\u5e38!",signErr:"\u7b7e\u540d\u5931\u8d25",serverErr:"\u8c03\u7528\u4ea7\u54c1\u7ec4\u4ef6\u5f02\u5e38",parseErr:"\u6570\u636e\u683c\u5f0f\u5f02\u5e38",responseErr:"\u4ea7\u54c1\u7ec4\u4ef6\u54cd\u5e94\u5f02\u5e38",connectionErr:"\u4ea7\u54c1\u7ec4\u4ef6\u8fde\u63a5\u5f02\u5e38",timeoutErr:"\u8bf7\u6c42\u54cd\u5e94\u8d85\u65f6",interErr:"\u83b7\u53d6\u63a5\u53e3\u5f02\u5e38",
"-7":"\u7b7e\u540d\u7ec4\u4ef6\u9519\u8bef"};q.extend(A.errCode,{then:{"-1":"\u8bf7\u5b89\u88c5\u5ba2\u6237\u7aef","-2":"\u8bf7\u63d2\u5165\u5f53\u524d\u7b7e\u7ae0\u6240\u5c5e\u7684\u5bc6\u94a5\u76d8","-3":"\u672a\u5b89\u88c5\u624b\u673a\u76fe\u7ec4\u4ef6","-12":"\u83b7\u53d6\u8bc1\u4e66\u5931\u8d25","-13":"\u7b7e\u540d\u65f6\uff0c\u52a0\u8f7d\u8bc1\u4e66\u5931\u8d25","-15":"\u7b7e\u540d\u6570\u636e\u4e0d\u80fd\u4e3a\u7a7a","-16":"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a","-17":"\u89e3\u6790\u8bc1\u4e66\u5931\u8d25",
"-18":"\u672a\u5b89\u88c5\u624b\u673a\u76fe\u7ec4\u4ef6","-19":"\u624b\u673a\u76fe\u767b\u5f55\u5931\u8d25",1:"\u6ca1\u6709\u68c0\u6d4b\u5230\u5bc6\u94a5\u76d8",2:"\u5bc6\u94a5\u76d8\u6ca1\u6709\u6b63\u786e\u521d\u59cb\u5316",3:"\u5bc6\u94a5\u76d8\u9a71\u52a8\u672a\u5b89\u88c5",4:"\u53ea\u80fd\u63d2\u5165\u4e00\u4e2a\u5bc6\u94a5\u76d8",7:"\u5bc6\u7801\u9519\u8bef\u6216\u5bc6\u94a5\u76d8\u88ab\u9501\u5b9a",8:"\u975e\u6cd5\u6388\u6743",9:"\u7f51\u7edc\u8fde\u63a5\u5931\u8d25",10:"\u624b\u673a\u76fe\u767b\u5f55\u5931\u8d25",
11:"\u5f53\u524d\u5bc6\u94a5\u76d8\u6ca1\u6709\u5370\u7ae0",12:"\u83b7\u53d6\u5370\u7ae0\u4fe1\u606f\u5931\u8d25",35:"\u94a5\u5319\u76d8\u672a\u751f\u6548\uff0c\u4e0d\u80fd\u7b7e\u7ae0\uff01",36:"\u94a5\u5319\u76d8\u5df2\u8fc7\u671f\uff0c\u4e0d\u80fd\u7b7e\u7ae0\uff01",37:"\u6388\u6743\u4fe1\u606f\u7ed3\u6784\u975e\u6cd5\uff01",38:"\u7b7e\u7ae0\u8bc1\u4e66\u5df2\u7ecf\u8fc7\u671f\u6216\u8fd8\u672a\u751f\u6548\uff01",39:"\u7b7e\u7ae0\u8bc1\u4e66\u4e0d\u53d7\u9881\u53d1\u673a\u6784\u4fe1\u4efb\uff01",
40:"\u7b7e\u7ae0\u8bc1\u4e66\u5df2\u88ab\u540a\u9500\uff01",41:"\u7b7e\u7ae0\u8bc1\u4e66\u6839\u8bc1\u4e66\u672a\u5b89\u88c5\u6216\u65e0\u6548\u7684\u6839\u8bc1\u4e66\uff01",42:"\u540a\u9500\u5217\u8868\u6587\u4ef6\u4e0d\u5b58\u5728",43:"\u672a\u68c0\u6d4b\u5230\u8bc1\u4e66",44:"\u6839\u8bc1\u4e66\u6587\u4ef6\u4e0d\u5b58\u5728",45:"\u6839\u8bc1\u4e66\u548c\u8be5\u8bc1\u4e66\u7684\u6839\u8bc1\u4e66\u4e0d\u914d\u5957",46:"\u540a\u9500\u5217\u8868\u548c\u8be5\u8bc1\u4e66\u7684\u540a\u9500\u5217\u8868\u4e0d\u914d\u5957",
"-101":"\u83b7\u53d6\u5bc6\u94a5\u76d8\u6709\u6548\u671f\u5f02\u5e38","-103":"\u5bc6\u94a5\u76d8\u672a\u751f\u6548","-104":"\u671f\u9650\u8bb8\u53ef\u5df2\u8fc7\u671f","-999":"\u91d1\u683c\u7ec4\u4ef6\u672a\u77e5\u9519\u8bef","30001@gm":"\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5931\u8d25\uff1a\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u7b7e\u540d\u503c\u5931\u8d25\uff01","30002@gm":"\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5931\u8d25\uff1a\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5236\u7ae0\u4eba\u8bc1\u4e66\u6709\u6548\u671f\u5931\u8d25\uff01",
"30003@gm":"\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5931\u8d25\uff1a\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u7684\u6709\u6548\u671f\u5931\u8d25\uff01","30004@gm":"\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5931\u8d25\uff1a\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u6709\u6548\u6027\u5931\u8d25\uff01","30005@gm":"\u9a8c\u8bc1\u7535\u5b50\u5370\u7ae0\u5931\u8d25\uff1a\u9a8c\u8bc1\u7535\u5b50\u7b7e\u7ae0\u6570\u636e\u5931\u8d25\uff01","-7@KGCrySignMessage":"\u7b7e\u540d\u7ec4\u4ef6\u9519\u8bef","8@KGVerifySign":"\u9a8c\u8bc1\u5931\u6548",
"1@KGVerifySign":"\u672a\u5b89\u88c5\u7b7e\u540d\u7ec4\u4ef6","2@KGCrySignMessage":"\u83b7\u53d6\u8bc1\u4e66\u5931\u8d25","3@KGCrySignMessage":"\u7b7e\u540d\u65f6\uff0c\u52a0\u8f7d\u8bc1\u4e66\u5931\u8d25","5@KGCrySignMessage":"\u7b7e\u540d\u6570\u636e\u4e0d\u80fd\u4e3a\u7a7a","6@KGCrySignMessage":"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a","7@KGCrySignMessage":"\u89e3\u6790\u8bc1\u4e66\u5931\u8d25"},KGRunFingerPrints:{"-1":"\u8bbe\u5907\u7c7b\u578b\u8bbe\u7f6e\u9519\u8bef","-2":"\u6ca1\u6709\u5b89\u88c5\u6307\u7eb9\u7ec4\u4ef6",
"-3":"\u6307\u7eb9\u91c7\u96c6\u5931\u8d25"},KGRunHandWritten:{"-1":"\u8bbe\u5907\u7c7b\u578b\u8bbe\u7f6e\u9519\u8bef","-2":"\u6ca1\u6709\u5b89\u88c5\u624b\u5199\u7ec4\u4ef6","-3":"\u6388\u6743\u7801\u4e0d\u6b63\u786e","-4":"\u7b7e\u540d\u53d6\u6d88","-5":"\u65e0\u670d\u52a1\u53ef\u7528","-6":"\u7b7e\u540d\u8bbe\u5907\u9519\u8bef","-7":"\u672a\u77e5\u9519\u8bef"},KGGetTSWithDigest:{1:"\u83b7\u53d6\u65f6\u95f4\u6233\u5f02\u5e38",2:"\u83b7\u53d6\u65f6\u95f4\u6233\u5931\u8d25",3:"\u54cd\u5e94\u6570\u636e\u4e3a\u7a7a"},
KGGetTSURLInfo:{1:"\u65f6\u95f4\u6233\u672a\u542f\u7528"},KGValidate_GM:{"-1":"\u6ca1\u6709\u5b89\u88c5\u7b7e\u540d\u7ec4\u4ef6","-2":"\u6ca1\u6709\u516c\u5171\u6a21\u5757\u7ec4\u4ef6","-3":"KCL280 \u9a8c\u8bc1\u5931\u8d25\uff0c\u672a\u77e5\u539f\u56e0\u7684\u9a8c\u8bc1\u5931\u8d25",1:"KCL272_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5df2\u8fc7\u671f\u6216\u672a\u751f\u6548\uff01",2:"KCL274 \u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u6839\u8bc1\u4e66\u9a8c\u8bc1\u672a\u901a\u8fc7!",
3:" KCL270_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5df2\u88ab\u540a\u9500\uff01",4:" KCL276 \u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u6839\u8bc1\u4e66\u5b89\u88c5\u672a\u6210\u529f!",5:" KCL266_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u540a\u9500\u5217\u8868\uff01",6:"KCL260_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u7b7e\u7ae0\u4eba\u8bc1\u4e66\uff01",
7:"KCL262_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u6839\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u7b7e\u7ae0\u4eba\u6839\u8bc1\u4e66\uff01",8:"KCL264_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u6839\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u4e0e\u8be5\u8bc1\u4e66\u7684\u6839\u8bc1\u4e66\u4e0d\u5339\u914d\uff01",9:"KCL268_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u4e0e\u8be5\u8bc1\u4e66\u540a\u9500\u5217\u8868\u4e0d\u5339\u914d\uff01",10:"KCL273_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u5df2\u8fc7\u671f\u6216\u672a\u751f\u6548",
11:"KCL275 \u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u6839\u8bc1\u4e66\u9a8c\u8bc1\u672a\u901a\u8fc7!",12:"KCL271_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u5df2\u88ab\u540a\u9500\uff01",13:"KCL277_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u6839\u8bc1\u4e66\u5b89\u88c5\u672a\u6210\u529f!",14:"KCL267_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u5236\u7ae0\u4eba\u8bc1\u4e66\u540a\u9500\u5217\u8868\uff01",
15:"KCL281_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u5236\u7ae0\u4eba\u8bc1\u4e66\uff01",16:"KCL263_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u6839\u8bc1\u4e66\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u5236\u7ae0\u4eba\u6839\u8bc1\u4e66\uff01",17:"KCL265_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u6839\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u4e0e\u8be5\u8bc1\u4e66\u7684\u6839\u8bc1\u4e66\u4e0d\u5339\u914d\uff01",18:"KCL269_\u9a8c\u8bc1\u5236\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u5236\u7ae0\u4eba\u8bc1\u4e66\u4e0e\u8be5\u8bc1\u4e66\u540a\u9500\u5217\u8868\u4e0d\u5339\u914d\uff01",
19:"KCL261_\u9a8c\u8bc1\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5931\u8d25\uff0c\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u4e0d\u5728\u5370\u7ae0\u7684\u7b7e\u7ae0\u4eba\u8bc1\u4e66\u5217\u8868\u4e2d\uff01",20:"KCL278_\u9a8c\u8bc1\u5370\u7ae0\u5236\u7ae0\u65f6\u95f4\u5931\u8d25\uff0c\u5370\u7ae0\u672a\u751f\u6548\uff01",21:"KCL279 \u9a8c\u8bc1\u5370\u7ae0\u5236\u7ae0\u65f6\u95f4\u5931\u8d25\uff0c\u5370\u7ae0\u5df2\u7ecf\u8fc7\u671f\uff01"},KGValidateCertificate:{"-1":"\u6ca1\u6709\u5b89\u88c5\u7b7e\u540d\u7ec4\u4ef6",
"-2":"\u672a\u77e5\u9519\u8bef",1:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u7b7e\u7ae0\u8bc1\u4e66\u5df2\u7ecf\u8fc7\u671f\u6216\u8fd8\u672a\u751f\u6548\uff01",2:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u7b7e\u7ae0\u8bc1\u4e66\u4e0d\u53d7\u9881\u53d1\u673a\u6784\u4fe1\u4efb\uff01",3:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u7b7e\u7ae0\u8bc1\u4e66\u5df2\u88ab\u540a\u9500\uff01",4:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u7b7e\u7ae0\u8bc1\u4e66\u6839\u8bc1\u4e66\u672a\u5b89\u88c5\u6216\u65e0\u6548\u7684\u6839\u8bc1\u4e66\uff01",5:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u540a\u9500\u5217\u8868\u6587\u4ef6\u4e0d\u5b58\u5728\uff01",
6:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u672a\u68c0\u6d4b\u5230\u8bc1\u4e66\uff01",7:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u6839\u8bc1\u4e66\u6587\u4ef6\u4e0d\u5b58\u5728\uff01",8:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u6839\u8bc1\u4e66\u548c\u8be5\u8bc1\u4e66\u7684\u6839\u8bc1\u4e66\u4e0d\u914d\u5957\uff01",9:"\u9a8c\u8bc1\u5931\u8d25\uff0c\u540a\u9500\u5217\u8868\u548c\u8be5\u8bc1\u4e66\u7684\u540a\u9500\u5217\u8868\u4e0d\u914d\u5957\uff01"},KG_MSG:{in_pwd_msg:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01",timestamp_time:"(\u65f6\u95f4\u6765\u6e90\u4e8e\u65f6\u95f4\u6233\u670d\u52a1\u5668)",
server_time:"(\u65f6\u95f4\u6765\u6e90\u4e8e\u7b7e\u7ae0\u670d\u52a1\u5668)",local_time:"(\u65f6\u95f4\u6765\u6e90\u4e8e\u672c\u5730)",modify_signdata:"\u7b7e\u540d\u6570\u636e\u88ab\u7be1\u6539",normal_signdata:"\u7b7e\u540d\u6570\u636e\u9a8c\u8bc1\u6b63\u5e38",success_signdata:"\u6570\u5b57\u7b7e\u540d\u6210\u529f\uff01",invalid_signdata:"\u7b7e\u7ae0\u65e0\u6548\uff0c\u4e0d\u80fd\u6267\u884c\u6570\u5b57\u7b7e\u540d\uff01",cannot_move:"\u8fd9\u4e2a\u5370\u7ae0\u4e0d\u662f\u4f60\u5f53\u524d\u63d2\u5165\u7684key\u7684\u5370\u7ae0\uff0c\u4e0d\u80fd\u79fb\u52a8\uff01"},
KG_TITLE:{SignatureMoveNot:"\u7981\u6b62\u79fb\u52a8",SignatureMoveDo:"\u5141\u8bb8\u79fb\u52a8",SignSignature:"\u6570\u5b57\u7b7e\u540d",SignVerify:"\u7b7e\u540d\u9a8c\u8bc1",SignatureVerify:"\u7b7e\u7ae0\u9a8c\u8bc1",RevokeSignature:"\u64a4\u9500\u7b7e\u7ae0",KinggridSignature:"\u7535\u5b50\u7b7e\u7ae0",DateSet:"\u65e5\u671f\u8bbe\u7f6e",HWSignature:"\u624b\u5199\u7b7e\u540d",scanBCSignature:"\u626b\u7801\u7b7e\u7ae0",moveSignature:"\u79fb\u52a8\u7b7e\u7ae0",ProtectedDataSet:"\u4fdd\u62a4\u9879\u8bbe\u7f6e"},
KGVerifyGBSealAction:{"-1":"\u670d\u52a1\u5668\u901a\u8baf\u5931\u8d25",1:"\u5370\u7ae0\u7ed3\u6784\u4f53\u4e3a\u7a7a",2:"\u5370\u7ae0\u72b6\u6001\u65e0\u6548",3:"\u89e3\u6790\u5f02\u5e38",4:"\u5370\u7ae0\u5df2\u5220\u9664",5:"\u5370\u7ae0\u672a\u5236\u4f5c",6:"\u5370\u7ae0\u5df2\u51bb\u7ed3"}});A.msg=function(a,b){return A.errCode[a]||(b?A.errCode[b][a]:A.errCode[a])||a};A.options={_version:"1.0",timeout:2E4};A.Utils=q;A.Listener=B;var R=function(a,b){D.trigger("ajaxRequest",arguments);return A.ajax?
function(c){(new M(a,b)).getJSON(function(a){c(null,a)})}:function(c){J(a,b,!1).getJSON(function(a){c(null,a)})}},S=function(a,b,c,d){D.trigger("beforeProg",arguments);var e={value:'{"GetInterface":{"progid":"'+b+'","interface":"'+c+'"},"usercode":"'+d+'"}'};return function(b){J(a+"/GetInterface",e,!1).getJSON(function(a){D.trigger("resonseProg",a);"none"==a.type?b(null,y):"0"===a.value?b(null,x):b(null,a)})}},N=function(a,b,c,e){D.trigger("beforeMethod",arguments);var f=Array.prototype.slice.call(arguments).slice(4);
0==f.length?f='{"MethodCall":{"caller":"'+b+'","function":"'+e+'"},"usercode":"'+c+'"}':(f='"params":'+d(f),f='{"MethodCall":{"caller":"'+b+'","function":"'+e+'",'+f+'},"usercode":"'+c+'"}');var g={value:f};return function(b){J(a+"/MethodCall",g,!1).getJSON(function(a){D.trigger("responseMethod",a);"none"!=a.type&&b(null,a.value?a.value:a)})}},O=function(a,b,c){D.trigger("beforeAttr",arguments);var e=Array.prototype.slice.call(arguments).slice(3);0==e.length?e='{"PropertyCall":{"caller":"'+b+'","property":"'+
c+'"}}':(e='"params":'+d(e),e='{"MethodCall":{"caller":"'+b+'","property":"'+c+'",'+e+"}}");var f={value:e};return function(b){J(a,f,!0).getJSON(function(a){D.trigger("responseMethod",a);"none"!=a.type&&b(null,a.value)})}},M=function(a,b){this.url=a;this.data=b;D.trigger("beforeAjaxJ",a,b)};M.prototype.getJSON=function(a){var b=this;$$$module$webapp$kinggrid$signature_all.ajax({url:this.url,contentType:"text/plain;charset=utf-8",type:"POST",data:E(this.data,"\r\n"),success:function(c){C.call(b,a,
c)},error:function(c,d,e){C.call(b,a,z)}})};Thenjs$$module$webapp$kinggrid$signature_all.onerror=function(a){if(q.is("String",a))alert("[error]"+a);else throw a;};var L=function(a){this.serverUrl=a;this.thenjs=Thenjs$$module$webapp$kinggrid$signature_all(function(a){a(null)})};t=L.prototype;t.init=function(a,b,c){this.progid=a;this.interid=b;this.clientCode=c;return this};t.fail=function(a){var b=this;b.thenjs=b.thenjs.fail(function(c,d){var e=a.call(b,c,d);c(b.respData(void 0==e?d:e))});return b};
t.fin=function(a){var b=this;b.thenjs=b.thenjs.fin(function(c,d,e){a.call(b,c,d,e)});return b};t.then=function(a){var b=this;b.thenjs=b.thenjs.then(function(c,d){a.call(b,function(a,d){b.respData(d);c(a,d)},d)});return b};t.series=function(a){this.thenjs=this.thenjs.series(a);return this};t.calArgs=function(a){for(var b=this._data,c=[],d=0;d<a.length;d++){var e=a[d];q.is("Function",e)&&(e=e.call(this,b));q.is("Array",e)?c=c.concat(e):c.push(e)}return c};t.msg=function(a,b,c,d){b=b||this._method;c=
c||this.progid;d=A.errCode.then;D.trigger("msgArg",a,b,c);return A.errCode[a]||d[a+"@"+b+"."+c]||d[a+"@"+b]||d[a]||a};t.ret=function(a){var b=this;this.then(function(c,d){var e=a.call(b,d);c(null,b.respData(void 0==e?d:e))});return this};t.respData=function(a){a&&(this._data=a);return this._data};t.attr=function(a){var b=this,c=n(arguments);b.series([function(a){var d=b.calArgs(c);b._method=d[0];O.apply(null,[b.serverUrl,b.proid].concat(d))(a)}]).then(function(a,c){a(null,b.respData(c[0]))});return this};
t.attrSeries=function(){var a=this,b=[];a.initProid();for(var c=0;c<arguments.length;c++)b.push(function(){var b=a.calArgs(arguments);return function(c){a._method=b[0];O.apply(null,[a.serverUrl,a.proid].concat(b))(c)}}.apply(null,arguments[c]));a.series(b).then(function(b,c){a.respData(c);b(null,c)});return this};t.initProid=function(){var a=this;this.series([S(a.serverUrl,a.progid,a.interid,a.clientCode)]).then(function(b,c){c=c[0];D.trigger("initProid",c);c.value?(a.proid=c.value,b(null,c)):b(c.errcode)});
return this};t.invokeSeries=function(){var a=this,b=[];a.initProid();for(var c=0;c<arguments.length;c++)b.push(function(){var b=a.calArgs(arguments);return function(c){a._method=b[0];N.apply(null,[a.serverUrl,a.proid,a.clientCode].concat(b))(c)}}.apply(null,arguments[c]));a.series(b).then(function(b,c){a.respData(c);b(null,c)});return this};t.invoke=function(a){var b=this;b.initProid();var c=n(arguments);b.series([function(a){var d=b.calArgs(c);b._method=d[0];N.apply(null,[b.serverUrl,b.proid,b.clientCode].concat(d))(a)}]).then(function(a,
c){b.respData(c[0]);a(null,c[0])});return this};t.request=function(a,b){var c=this;c.series([R(c.serverUrl+a,b)]).then(function(a,b){b=b[0];c.respData(b);a(null,b)});return this};var D=new B("kgthen");A.addRequestListener=function(a,b){D.on(a,b)};A.surry=function(a,b,c,d){return(new L(a||"http://127.0.0.1:9581")).init(b,c,d)};A.KgThen=L;return A};
function KGInstance$$module$webapp$kinggrid$signature_all(){null==instance$$module$webapp$kinggrid$signature_all&&(instance$$module$webapp$kinggrid$signature_all=new KG$$module$webapp$kinggrid$signature_all);return instance$$module$webapp$kinggrid$signature_all}root$$module$webapp$kinggrid$signature_all.kinggrid=KGInstance$$module$webapp$kinggrid$signature_all();
var Utils$$module$webapp$kinggrid$signature_all=kinggrid.Utils,config$$module$webapp$kinggrid$signature_all=kinggrid.options,isIE8$$module$webapp$kinggrid$signature_all=!1;root$$module$webapp$kinggrid$signature_all.JSON&&(isIE8$$module$webapp$kinggrid$signature_all='{"x":"\u4e2d"}'!==root$$module$webapp$kinggrid$signature_all.JSON.stringify({x:"\u4e2d"}));var dialog$$module$webapp$kinggrid$signature_all=root$$module$webapp$kinggrid$signature_all.dialog;
dialog$$module$webapp$kinggrid$signature_all&&dialog$$module$webapp$kinggrid$signature_all.create&&(dialog$$module$webapp$kinggrid$signature_all.create.prototype.button=function(a){a=a||[];var b=this,c="",d=0;this.callbacks={};"string"===typeof a?(c=a,d++):$$$module$webapp$kinggrid$signature_all.each(a,function(a,f){var e=f.id=f.id||f.value;"cancel"==e&&(f.value="\u53d6\u6d88");a="";b.callbacks[e]=f.callback;!1===f.display?a=' style="display:none"':d++;c+='<button type="button" i-id="'+e+'"'+a+(f.disabled?
" disabled":"")+(f.autofocus?isIE8$$module$webapp$kinggrid$signature_all?' class="ui-dialog-autofocus"':' autofocus class="ui-dialog-autofocus"':"")+">"+f.value+"</button>";b._$("button").on("click","[i-id="+e+"]",function(a){$$$module$webapp$kinggrid$signature_all(this).attr("disabled")||b._trigger(e);a.preventDefault()})});this._$("button").html(c);this._$("footer")[d?"show":"hide"]();return this});
var dialogConfig$$module$webapp$kinggrid$signature_all={okValue:"\u786e\u5b9a",cancelValue:"\u5173\u95ed",modal:!0,fixed:!0,backdropOpacity:.2,skin:"kg-ui-dialog"},toBase64Img$$module$webapp$kinggrid$signature_all=function(a){var b=a.imgdata;0==b.indexOf(a.signsn)&&(b=a.imgdata.substring(65));return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encodeByte(Utils$$module$webapp$kinggrid$signature_all.Base64.of(a.signsn).decodeByte(b))},dialogList$$module$webapp$kinggrid$signature_all={},createDialog$$module$webapp$kinggrid$signature_all;
createDialog$$module$webapp$kinggrid$signature_all=function(a,b){b.id=a;return"undefined"!=typeof root$$module$webapp$kinggrid$signature_all.iframeDialog&&root$$module$webapp$kinggrid$signature_all.iframeDialog?root$$module$webapp$kinggrid$signature_all.top.dialog(b):root$$module$webapp$kinggrid$signature_all.dialog(b)};
var kingDialog$$module$webapp$kinggrid$signature_all=function(a,b){var c=this;if(!(c instanceof kingDialog$$module$webapp$kinggrid$signature_all))return new kingDialog$$module$webapp$kinggrid$signature_all(a,b);var d=Utils$$module$webapp$kinggrid$signature_all.extend({},plus$$module$webapp$kinggrid$signature_all.dialogConfig,b),e=d.onOk;e&&(delete d.onOk,d.ok=function(){return e.call(c)});var f=d.onCancel;f&&(delete d.onCancel,d.cancel=function(){return f.call(c)});c.init(a,d);c.options=b;c.id=a},
dialogProto$$module$webapp$kinggrid$signature_all=kingDialog$$module$webapp$kinggrid$signature_all.prototype;dialogProto$$module$webapp$kinggrid$signature_all.init=function(a,b){this[0]=createDialog$$module$webapp$kinggrid$signature_all(a,b);return this};dialogProto$$module$webapp$kinggrid$signature_all.on=function(a,b){this[0]["on"+a]=b};
dialogProto$$module$webapp$kinggrid$signature_all.show=function(a){this.options.iconClose&&this[0]._$("close").hide();this.options.onShow&&this.options.onShow.call(this);this[0].show();return this};dialogProto$$module$webapp$kinggrid$signature_all.remove=function(){this[0].remove();delete this[0]};dialogProto$$module$webapp$kinggrid$signature_all.close=function(){this[0].close();return this};dialogProto$$module$webapp$kinggrid$signature_all.content=function(a){this[0].content(a);return this};
dialogProto$$module$webapp$kinggrid$signature_all.find=function(a){return this[0]._popup.find(a)};
Thenjs$$module$webapp$kinggrid$signature_all.onerror=function(a){plus$$module$webapp$kinggrid$signature_all.hideLoading();if(Utils$$module$webapp$kinggrid$signature_all.is("String",a))"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&Signature$$module$webapp$kinggrid$signature_all.options.isResponseErr&&"connectionErr"==a?console.warn(kinggrid.msg(a,"then")):Signature$$module$webapp$kinggrid$signature_all.options.errorCall?Signature$$module$webapp$kinggrid$signature_all.options.errorCall.call(null,
{result:!1,errcode:a}):plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg(a,"then"),function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall.call()},function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call()});else throw a;};
var Switcher$$module$webapp$kinggrid$signature_all=function(a,b){var c=this;c.target=$$$module$webapp$kinggrid$signature_all(a);b&&$$$module$webapp$kinggrid$signature_all.each(b,function(a,b){if("function"===typeof c[a])c[a](b);else c[a]=b});c.init()};
Utils$$module$webapp$kinggrid$signature_all.extend(Switcher$$module$webapp$kinggrid$signature_all.prototype,{running:!1,index:0,animate:!0,init:function(){var a=this.target,b=this.wrapper=a.find(".kg-wrapper"),c=this.guide=a.find(".kg-guide");a=b.children(".kg-slide");var d=parseInt(a.css("height")),e=a.outerWidth(!0);b.css({height:d,width:a.length*e});this.count=a.length;b=parseFloat(this.index,10)||0;a.each(function(a){this.setAttribute("index",a);c.append('<span index="'+a+'"></span>')});this._active(b)},
_active:function(a){var b=this.index;this.wrapper.children().eq(b).removeClass("active");this.guide.children().eq(b).removeClass("active");this.wrapper.children().eq(a).addClass("active");this.guide.children().eq(a).addClass("active");this.index=a},to:function(a){var b=this;if(!b.running){var c=a%this.count;c!=b.index&&(b.running=!0,a=b.wrapper.children().eq(c),a=-c*a.outerWidth(!0),this.animate?this.wrapper.animate({left:a},100,function(){b._active(c);b.running=!1}):(this.wrapper.css({left:a}),b._active(c),
b.running=!1))}},swipePrev:function(){var a=this.index-1;0>a&&(a=this.wrapper.children().length-1);this.to(a)},swipeNext:function(){var a=this.index+1,b=this.wrapper.children().length;a+1>b&&(a=0);this.to(a)}});Utils$$module$webapp$kinggrid$signature_all.Switcher=Switcher$$module$webapp$kinggrid$signature_all;
var Tab$$module$webapp$kinggrid$signature_all=function(a){this.target=a;var b=this.nav=this.target.find(".kg-nav");this.content=this.target.find(".kg-tab-content");a=b.children();b=b.children(".active");0==b.length&&(b=a.eq(0));this.active(b);this.init()};
Tab$$module$webapp$kinggrid$signature_all.prototype={active:function(a){this.activeLi&&(this.activeContent.removeClass("active"),this.activeLi.removeClass("active"));a.addClass("active");var b=a.children("a").attr("kg-target");b=this.target.find("."+b);b.addClass("active");this.activeLi=a;this.activeContent=b},init:function(){var a=this;this.target.find(".kg-nav li").click(function(b){b.preventDefault();b=$$$module$webapp$kinggrid$signature_all(this);b.hasClass("active")||a.active(b)})}};
Utils$$module$webapp$kinggrid$signature_all.tab=function(a){return new Tab$$module$webapp$kinggrid$signature_all(a)};
var plus$$module$webapp$kinggrid$signature_all={dialogConfig:dialogConfig$$module$webapp$kinggrid$signature_all,alertConfig:{},loadingConfig:{}},showCacheDialog$$module$webapp$kinggrid$signature_all=function(a,b,c){var d=dialogList$$module$webapp$kinggrid$signature_all[a];if(!d){var e=c.okCall;e&&delete c.okCall;c=Utils$$module$webapp$kinggrid$signature_all.extend({onOk:function(){var a=!0;e&&(a=0==e.call(this)?!1:!0);a&&this.close().remove();return!1},cancel:!1},c);d=dialogList$$module$webapp$kinggrid$signature_all[a]=
plus$$module$webapp$kinggrid$signature_all.showDialog(a,c)}d.on("remove",function(){delete dialogList$$module$webapp$kinggrid$signature_all[a]});d.content(b);return d};
plus$$module$webapp$kinggrid$signature_all.alert=function(a,b,c){b=Utils$$module$webapp$kinggrid$signature_all.extend({title:"\u63d0\u793a",onShow:c,okCall:b},plus$$module$webapp$kinggrid$signature_all.alertConfig);return showCacheDialog$$module$webapp$kinggrid$signature_all("alert",'<div class="kg-dialog kg-alert" ><i class="kg-icon kg-icon-attention-circled"></i>'+a+"</div>",b)};
plus$$module$webapp$kinggrid$signature_all.showLoading=function(a){a=Utils$$module$webapp$kinggrid$signature_all.extend({onOk:!1},plus$$module$webapp$kinggrid$signature_all.loadingConfig);return showCacheDialog$$module$webapp$kinggrid$signature_all("loading",'<div class="kg-loading"><img title="\u52a0\u8f7d\u4e2d..." src="data:image/gif;base64,R0lGODlhIAAgALMAAP///7Ozs/v7+9bW1uHh4fLy8rq6uoGBgTQ0NAEBARsbG8TExJeXl/39/VRUVAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAAACwAAAAAIAAgAAAE5xDISSlLrOrNp0pKNRCdFhxVolJLEJQUoSgOpSYT4RowNSsvyW1icA16k8MMMRkCBjskBTFDAZyuAEkqCfxIQ2hgQRFvAQEEIjNxVDW6XNE4YagRjuBCwe60smQUDnd4Rz1ZAQZnFAGDd0hihh12CEE9kjAEVlycXIg7BAsMB6SlnJ87paqbSKiKoqusnbMdmDC2tXQlkUhziYtyWTxIfy6BE8WJt5YEvpJivxNaGmLHT0VnOgGYf0dZXS7APdpB309RnHOG5gDqXGLDaC457D1zZ/V/nmOM82XiHQjYKhKP1oZmADdEAAAh+QQFBQAAACwAAAAAGAAXAAAEchDISasKNeuJFKoHs4mUYlJIkmjIV54Soypsa0wmLSnqoTEtBw52mG0AjhYpBxioEqRNy8V0qFzNw+GGwlJki4lBqx1IBgjMkRIghwjrzcDti2/Gh7D9qN774wQGAYOEfwCChIV/gYmDho+QkZKTR3p7EQAh+QQFBQAAACwBAAAAHQAOAAAEchDISWdANesNHHJZwE2DUSEo5SjKKB2HOKGYFLD1CB/DnEoIlkti2PlyuKGEATMBaAACSyGbEDYD4zN1YIEmh0SCQQgYehNmTNNaKsQJXmBuuEYPi9ECAU/UFnNzeUp9VBQEBoFOLmFxWHNoQw6RWEocEQAh+QQFBQAAACwHAAAAGQARAAAEaRDICdZZNOvNDsvfBhBDdpwZgohBgE3nQaki0AYEjEqOGmqDlkEnAzBUjhrA0CoBYhLVSkm4SaAAWkahCFAWTU0A4RxzFWJnzXFWJJWb9pTihRu5dvghl+/7NQmBggo/fYKHCX8AiAmEEQAh+QQFBQAAACwOAAAAEgAYAAAEZXCwAaq9ODAMDOUAI17McYDhWA3mCYpb1RooXBktmsbt944BU6zCQCBQiwPB4jAihiCK86irTB20qvWp7Xq/FYV4TNWNz4oqWoEIgL0HX/eQSLi69boCikTkE2VVDAp5d1p0CW4RACH5BAUFAAAALA4AAAASAB4AAASAkBgCqr3YBIMXvkEIMsxXhcFFpiZqBaTXisBClibgAnd+ijYGq2I4HAamwXBgNHJ8BEbzgPNNjz7LwpnFDLvgLGJMdnw/5DRCrHaE3xbKm6FQwOt1xDnpwCvcJgcJMgEIeCYOCQlrF4YmBIoJVV2CCXZvCooHbwGRcAiKcmFUJhEAIfkEBQUAAAAsDwABABEAHwAABHsQyAkGoRivELInnOFlBjeM1BCiFBdcbMUtKQdTN0CUJru5NJQrYMh5VIFTTKJcOj2HqJQRhEqvqGuU+uw6AwgEwxkOO55lxIihoDjKY8pBoThPxmpAYi+hKzoeewkTdHkZghMIdCOIhIuHfBMOjxiNLR4KCW1ODAlxSxEAIfkEBQUAAAAsCAAOABgAEgAABGwQyEkrCDgbYvvMoOF5ILaNaIoGKroch9hacD3MFMHUBzMHiBtgwJMBFolDB4GoGGBCACKRcAAUWAmzOWJQExysQsJgWj0KqvKalTiYPhp1LBFTtp10Is6mT5gdVFx1bRN8FTsVCAqDOB9+KhEAIfkEBQUAAAAsAgASAB0ADgAABHgQyEmrBePS4bQdQZBdR5IcHmWEgUFQgWKaKbWwwSIhc4LonsXhBSCsQoOSScGQDJiWwOHQnAxWBIYJNXEoFCiEWDI9jCzESey7GwMM5doEwW4jJoypQQ743u1WcTV0CgFzbhJ5XClfHYd/EwZnHoYVDgiOfHKQNREAIfkEBQUAAAAsAAAPABkAEQAABGeQqUQruDjrW3vaYCZ5X2ie6EkcKaooTAsi7ytnTq046BBsNcTvItz4AotMwKZBIC6H6CVAJaCcT0CUBTgaTg5nTCu9GKiDEMPJg5YBBOpwlnVzLwtqyKnZagZWahoMB2M3GgsHSRsRACH5BAUFAAAALAEACAARABgAAARcMKR0gL34npkUyyCAcAmyhBijkGi2UW02VHFt33iu7yiDIDaD4/erEYGDlu/nuBAOJ9Dvc2EcDgFAYIuaXS3bbOh6MIC5IAP5Eh5fk2exC4tpgwZyiyFgvhEMBBEAIfkEBQUAAAAsAAACAA4AHQAABHMQyAnYoViSlFDGXBJ808Ep5KRwV8qEg+pRCOeoioKMwJK0Ekcu54h9AoghKgXIMZgAApQZcCCu2Ax2O6NUud2pmJcyHA4L0uDM/ljYDCnGfGakJQE5YH0wUBYBAUYfBIFkHwaBgxkDgX5lgXpHAXcpBIsRADs="></div>',
a)};plus$$module$webapp$kinggrid$signature_all.hideLoading=function(){var a=dialogList$$module$webapp$kinggrid$signature_all.loading;a&&a.close().remove()};plus$$module$webapp$kinggrid$signature_all.hideDialog=function(a){(a=root$$module$webapp$kinggrid$signature_all.dialog.list[a])&&a.close().remove()};plus$$module$webapp$kinggrid$signature_all.showDialog=function(a,b){a=kingDialog$$module$webapp$kinggrid$signature_all(a,b);a.show();return a};
var template$$module$webapp$kinggrid$signature_all=plus$$module$webapp$kinggrid$signature_all.template={sealTpl_nopassword:'<div class="kg-dialog kg-dialog-runSignature" id="sealTpl-dialog"><div class=" kg-switcher" id="kg-switcher" ><a class="arrow-left arrow" href="#"><i class="kg-icon kg-icon-angle-left" /></a><a class="arrow-right arrow" href="#"><i class="kg-icon kg-icon-angle-right"/></a><div class="kg-pagin"><d\tiv class="kg-guide"></div>\t</div><div class="kg-container" ><div class="kg-wrapper"><% var seals = this.seals; %><% for(var i=0;i<seals.length;i++) {%><div class="kg-slide" title="<%seals[i].signname%>"><div class="kg-image"><div class="title"><%seals[i].signname%></div><a class="kg-img" href="#" ><img src="data:image/<%seals[i].imgext.substring(1)%>;base64,<%arguments[arguments.length-1](seals[i])%>"></a></div><div class="kg-shade" style="z-index:100;"><img width="100%" height="100%"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVR42mNgAAIAAAUAAen63NgAAAAASUVORK5CYII="></div></div><%}%></div></div></div><div class="kg-form"><div class="kg-sm kg-sm-2"></div><div class="form-item clearfix i-addDate"><div class="kg-sm kg-sm-8"><% if(this.signDateIsCheck){ %><input type="checkbox" name="addDate" id="kg-addDate" checked="checked">&nbsp;<label for="kg-addDate">\u9644\u52a0\u65f6\u95f4</label>&nbsp;&nbsp;&nbsp;&nbsp;<%}else{%><input type="checkbox" name="addDate" id="kg-addDate">&nbsp;<label for="kg-addDate">\u9644\u52a0\u65f6\u95f4</label>&nbsp;&nbsp;&nbsp;&nbsp;<%}%><input type="button" style="width:50px" name="dateSet" id="kg-dateSet" value="\u8bbe\u7f6e"/><% if(this.showProtectedBtn){%>&nbsp;<input type="button" style="width:50px" name="proDataSet" id="kg-protectedDataSet" value="\u4fdd\u62a4\u9879"/><%}%></div> </div> </div></div></div>',
sealTpl:'<div class="kg-dialog kg-dialog-runSignature" id="sealTpl-dialog"><div class=" kg-switcher" id="kg-switcher" ><a class="arrow-left arrow" href="#"><i class="kg-icon kg-icon-angle-left" /></a><a class="arrow-right arrow" href="#"><i class="kg-icon kg-icon-angle-right"/></a><div class="kg-pagin"><d\tiv class="kg-guide"></div>\t</div><div class="kg-container" ><div class="kg-wrapper"><% var seals = this.seals; %><% for(var i=0;i<seals.length;i++) {%><div class="kg-slide" title="<%seals[i].signname%>"><div class="kg-image"><div class="title"><%seals[i].signname%></div><a class="kg-img" href="#" ><img src="data:image/<%seals[i].imgext.substring(1)%>;base64,<%arguments[arguments.length-1](seals[i])%>"></a></div><div class="kg-shade" style="z-index:100;"><img width="100%" height="100%"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVR42mNgAAIAAAUAAen63NgAAAAASUVORK5CYII="></div></div><%}%></div></div></div><div class="kg-form"><div class="form-item clearfix i-password"><div class="kg-sm kg-sm-2"></div><label class="kg-sm kg-sm-2 kg-label">\u5bc6\u7801\uff1a</label><div class="kg-sm kg-sm-6"> <input type="password" name="kgpassword" autocomplete="new-password" id="kg-password" class="form-control"></div><div class="kg-sm kg-sm-2"></div> </div><div class="kg-sm kg-sm-2"></div><div class="form-item clearfix i-addDate"><div class="kg-sm kg-sm-8"><% if(this.signDateIsCheck){ %><input type="checkbox" name="addDate" id="kg-addDate" checked="checked">&nbsp;<label style="display:inline;" for="kg-addDate">\u9644\u52a0\u65f6\u95f4</label>&nbsp;<%}else{%><input type="checkbox" name="addDate" id="kg-addDate">&nbsp;<label style="display:inline;" for="kg-addDate">\u9644\u52a0\u65f6\u95f4</label>&nbsp;<%}%><input type="button" style="width:40px;" name="dateSet" id="kg-dateSet" value="\u8bbe\u7f6e"/></div> </div> </div><div class="kg-sm kg-sm-2"></div><div class="form-item clearfix i-password kg-pwd"><div class="kg-sm kg-sm-9"><input type="checkbox" name="remenberPwd" id="kg-remenberPwd">&nbsp;<label style="display:inline;" for="kg-remenberPwd">\u8bb0\u4f4f\u5bc6\u7801</label><% if(this.showProtectedBtn){%>&nbsp;<input type="button" style="width:50px" name="proDataSet" id="kg-protectedDataSet" value="\u4fdd\u62a4\u9879"/><%}%></div> </div> </div></div></div>',
passwordTpl:'<div id="kg-verifyPass" class="kg-dialog kg-dialog-password"><div class="kg-form"><div class="form-item clearfix i-password"><label class="kg-sm kg-sm-3 kg-label">\u5bc6\u7801\uff1a</label><div class="kg-sm kg-sm-8"> <input type="password" name="kgpassword" autocomplete="new-password" id="kg-password" class="form-control"></div> </div><div class="kg-sm kg-sm-3"></div><div class="kg-sm kg-sm-8"><input type="checkbox" name="remenberPwd" id="kg-remenberPwd">&nbsp;<label for="kg-remenberPwd">\u8bb0\u4f4f\u5bc6\u7801</label></div> </div></div></div>'},
font$$module$webapp$kinggrid$signature_all=plus$$module$webapp$kinggrid$signature_all.fontTemplate={fontFormat:"yyyy-M-d;yyyy.M.d;yyyy/M/d;yyyy\u5e74M\u6708d\u65e5;yy/M/d;yy.M.d;yyyy-MM-dd;yyyy/MM/dd;yyyy.MM.dd;yyyy\u5e74M\u6708d\u65e5*;yyyy\u5e74M\u6708d\u65e5**;MM/dd;MM.dd;M/d;M.d;d-MMM-yyyy;d-MMM-yy;yyyy-M-d hh:mm:ss".split(";"),fontFamily:"@Arial Unicode MS;@Fixedsys;@Malgun Gothic;@Malgun Gothic Semilight;@Meiryo;@Meiryo UI;@Microsoft JhengHei;@Microsoft JhengHei Light;@Microsoft JhengHei UI;@Microsoft JhengHei UI Light;@Microsoft YaHei UI;@Microsoft YaHei UI Light;@MingLiU_HKSCS-ExtB;@MingLiU-ExtB;@MS Gothic;@MS PGothic;@MS UI Gothic;@PMingLiU-ExtB;@SimSun-ExtB;@System;@Terminal;@Yu Gothic;@Yu Gothic Light;@Yu Gothic Medium;@Yu Gothic UI;@Yu Gothic UI Light;@Yu Gothic UI Semibold;@Yu Gothic UI Semilight;@\u7b49\u7ebf;@\u7b49\u7ebf Light;@\u65b9\u6b63\u5170\u4ead\u8d85\u7ec6\u9ed1\u7b80\u4f53;@\u65b9\u6b63\u8212\u4f53;@\u65b9\u6b63\u59da\u4f53;@\u4eff\u5b8b;@\u9ed1\u4f53;@\u534e\u6587\u5f69\u4e91;@\u534e\u6587\u4eff\u5b8b;@\u534e\u6587\u884c\u6977;@\u534e\u6587\u7425\u73c0;@\u534e\u6587\u6977\u4f53;@\u534e\u6587\u96b6\u4e66;@\u534e\u6587\u5b8b\u4f53;@\u534e\u6587\u7ec6\u9ed1;@\u534e\u6587\u65b0\u9b4f;@\u534e\u6587\u4e2d\u5b8b;@\u6977\u4f53;@\u96b6\u4e66;@\u5b8b\u4f53;@\u5fae\u8f6f\u96c5\u9ed1;@\u5fae\u8f6f\u96c5\u9ed1 Light;@\u65b0\u5b8b\u4f53;@\u5e7c\u5706;ADMUI3Lg;ADMUI3Sm;Agency FB;Algerian;Arial;Arial Black;Arial Narrow;Arial Rounded MT Bold;Arial Unicode MS;Axure Handwriting;Baskerville Old Face;Bauhaus 93;Bell MT;Berlin Sans FB;Berlin Sans FB Demi;Bernard MT Condensed;Blackadder ITC;Bodoni MT;Bodoni MT Black;Bodoni MT Condensed;Bodoni MT Poster Compressed;Book Antiqua;Bookman Old Style;Bookshelf Symbol 7;Bradley Hand ITC;Britannic Bold;Broadway;Brush Script MT;Calibri;Calibri Light;Californian FB;Calisto MT;Cambria;Cambria Math;Candara;Castellar;Centaur;Century;Century Gothic;Century Schoolbook;Chiller;Colonna MT;Comic Sans MS;Consolas;Constantia;Cooper Black;Copperplate Gothic Bold;Copperplate Gothic Light;Corbel;Courier;Courier New;Curlz MT;Default;Ebrima;Edwardian Script ITC;Elephant;Engravers MT;Eras Bold ITC;Eras Demi ITC;Eras Light ITC;Eras Medium ITC;Euro Sign;Felix Titling;Fixedsys;Footlight MT Light;Forte;Franklin Gothic Book;Franklin Gothic Demi;Franklin Gothic Demi Cond;Franklin Gothic Heavy;Franklin Gothic Medium;Franklin Gothic Medium Cond;Freestyle Script;French Script MT;Gabriola;Gadugi;Garamond;Georgia;Gigi;Gill Sans MT;Gill Sans MT Condensed;Gill Sans MT Ext Condensed Bold;Gill Sans Ultra Bold;Gill Sans Ultra Bold Condensed;Gloucester MT Extra Condensed;Goudy Old Style;Goudy Stout;Haettenschweiler;Harlow Solid Italic;Harrington;High Tower Text;Impact;Imprint MT Shadow;Informal Roman;Javanese Text;Jokerman;Juice ITC;Kristen ITC;Kunstler Script;Leelawadee UI;Leelawadee UI Semilight;Lucida Bright;Lucida Calligraphy;Lucida Console;Lucida Fax;Lucida Handwriting;Lucida Sans;Lucida Sans Typewriter;Lucida Sans Unicode;Magneto;Maiandra GD;Malgun Gothic;Malgun Gothic Semilight;Marlett;Matura MT Script Capitals;Meiryo;Meiryo UI;Microsoft Himalaya;Microsoft JhengHei;Microsoft JhengHei Light;Microsoft JhengHei UI;Microsoft JhengHei UI Light;Microsoft New Tai Lue;Microsoft PhagsPa;Microsoft Sans Serif;Microsoft Tai Le;Microsoft YaHei UI;Microsoft YaHei UI Light;Microsoft Yi Baiti;MingLiU_HKSCS-ExtB;MingLiU-ExtB;Mistral;Modern;Modern No. 20;Mongolian Baiti;Monotype Corsiva;MS Gothic;MS Outlook;MS PGothic;MS Reference Sans Serif;MS Reference Specialty;MS Sans Serif;MS Serif;MS UI Gothic;MT Extra;MV Boli;Myanmar Text;Niagara Engraved;Niagara Solid;Nirmala UI;Nirmala UI Semilight;OCR A Extended;Old English Text MT;Onyx;Palace Script MT;Palatino Linotype;Papyrus;Parchment;Perpetua;Perpetua Titling MT;Playbill;PMingLiU-ExtB;Poor Richard;Pristina;Rage Italic;Ravie;Rockwell;Rockwell Condensed;Rockwell Extra Bold;Roman;Script;Script MT Bold;Segoe MDL2 Assets;Segoe Print;Segoe Script;Segoe UI;Segoe UI Black;Segoe UI Emoji;Segoe UI Historic;Segoe UI Light;Segoe UI Semibold;Segoe UI Semilight;Segoe UI Symbol;Showcard Gothic;SimSun-ExtB;Sitka Banner;Sitka Display;Sitka Heading;Sitka Small;Sitka Subheading;Sitka Text;Small Fonts;Snap ITC;Stencil;Sylfaen;Symbol;System;Tahoma;TeamViewer11;Tempus Sans ITC;Terminal;Times New Roman;Trebuchet MS;Tw Cen MT;Tw Cen MT Condensed;Tw Cen MT Condensed Extra Bold;Verdana;Viner Hand ITC;Vivaldi;Vladimir Script;Webdings;Wide Latin;Wingdings;Wingdings 2;Wingdings 3;Yu Gothic;Yu Gothic Light;Yu Gothic Medium;Yu Gothic UI;Yu Gothic UI Light;Yu Gothic UI Semibold;Yu Gothic UI Semilight;ZWAdobeF;\u7b49\u7ebf;\u7b49\u7ebf Light;\u65b9\u6b63\u5170\u4ead\u8d85\u7ec6\u9ed1\u7b80\u4f53;\u65b9\u6b63\u8212\u4f53;\u65b9\u6b63\u59da\u4f53;\u4eff\u5b8b;\u9ed1\u4f53;\u534e\u6587\u5f69\u4e91;\u534e\u6587\u4eff\u5b8b;\u534e\u6587\u884c\u6977;\u534e\u6587\u7425\u73c0;\u534e\u6587\u6977\u4f53;\u534e\u6587\u96b6\u4e66;\u534e\u6587\u5b8b\u4f53;\u534e\u6587\u7ec6\u9ed1;\u534e\u6587\u65b0\u9b4f;\u534e\u6587\u4e2d\u5b8b;\u6977\u4f53;\u96b6\u4e66;\u5b8b\u4f53;\u5fae\u8f6f\u96c5\u9ed1;\u5fae\u8f6f\u96c5\u9ed1 Light;\u65b0\u5b8b\u4f53;\u5e7c\u5706".split(";"),
fontSize:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],fontColor:"#000000 #800000 #008000 #808000 #000080 #800080 #008080 #808080 #C0C0C0 #FFFFFF #FF0000 #00FF00 #FFFF00 #0000FF #FF00FF #00FFFF".split(" "),fontPosition:[["center","middle","inside","",""],["center","bottom","inside","",""],["right","middle","inside","",""],["right","bottom","inside","",""],["right","top","outside","left",""],["center","top","outside","","below"],["left","middle","outside","right",""],["right","top","outside","",
"below"],["left","bottom","outside","right",""],["left","top","outside","right","below"]],position:"\u5c45\u4e2d \u5c45\u4e2d\u4e0b(\u7ae0\u5185) \u5c45\u53f3\u4e2d(\u7ae0\u5185) \u5c45\u53f3\u4e0b(\u7ae0\u5185) \u5c45\u5de6\u4e0a(\u7ae0\u5916) \u5c45\u4e2d\u4e0b(\u7ae0\u5916) \u5c45\u53f3\u4e2d(\u7ae0\u5916) \u5c45\u53f3\u4e0b(\u7ae0\u4e0b) \u5c45\u53f3\u4e0b(\u7ae0\u53f3) \u5c45\u53f3\u4e0b(\u7ae0\u53f3\u4e0b)".split(" ")},dafaultDate$$module$webapp$kinggrid$signature_all=plus$$module$webapp$kinggrid$signature_all.dafaultDate=
"2017/01/01 12:00:00",defaultFont$$module$webapp$kinggrid$signature_all=plus$$module$webapp$kinggrid$signature_all.defaultFont={fontFormat:plus$$module$webapp$kinggrid$signature_all.fontTemplate.fontFormat[0],fontFamily:"\u5b8b\u4f53",fontSize:12,fontColor:"#000000",position:plus$$module$webapp$kinggrid$signature_all.fontTemplate.position[0]};
plus$$module$webapp$kinggrid$signature_all.kgFont=function(a){var b={};b.fontFormat=a.fontFormat?a.fontFormat:plus$$module$webapp$kinggrid$signature_all.defaultFont.fontFormat;b.fontFamily=a.fontFamily?a.fontFamily:plus$$module$webapp$kinggrid$signature_all.defaultFont.fontFamily;b.fontSize=a.fontSize?a.fontSize:plus$$module$webapp$kinggrid$signature_all.defaultFont.fontSize;b.fontColor=a.fontColor?a.fontColor:plus$$module$webapp$kinggrid$signature_all.defaultFont.fontColor;null!=a.position?(a=jQuery.inArray(a.position,
plus$$module$webapp$kinggrid$signature_all.fontTemplate.position),b.fontPosition=plus$$module$webapp$kinggrid$signature_all.fontTemplate.fontPosition[a]):a.fontPositionIndex?b.fontPosition=plus$$module$webapp$kinggrid$signature_all.fontTemplate.fontPosition[a.fontPositionIndex]:(a=jQuery.inArray(plus$$module$webapp$kinggrid$signature_all.defaultFont.position,plus$$module$webapp$kinggrid$signature_all.fontTemplate.position),b.fontPosition=plus$$module$webapp$kinggrid$signature_all.fontTemplate.fontPosition[a]);
return b};var formatArgs$$module$webapp$kinggrid$signature_all=function(a){var b=[a],c=Utils$$module$webapp$kinggrid$signature_all.slice(arguments,1),d;if(0<c.length){var e=c[0];1<c.length&&(d=c.slice(1))}b.push(e);return b.concat(d)};
plus$$module$webapp$kinggrid$signature_all.showTplDialog=function(a,b,c){var d=Utils$$module$webapp$kinggrid$signature_all.slice(arguments,2),e=Utils$$module$webapp$kinggrid$signature_all.extend({content:function(){return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,[template$$module$webapp$kinggrid$signature_all[a]].concat(d))}},b);return plus$$module$webapp$kinggrid$signature_all.showDialog(a,e)};
plus$$module$webapp$kinggrid$signature_all.showTemplateDialog=function(a){var b=formatArgs$$module$webapp$kinggrid$signature_all.apply(null,Utils$$module$webapp$kinggrid$signature_all.slice(arguments));return plus$$module$webapp$kinggrid$signature_all.showTplDialog.apply(plus$$module$webapp$kinggrid$signature_all,b)};plus$$module$webapp$kinggrid$signature_all.create=function(a){Utils$$module$webapp$kinggrid$signature_all.extend(this,plus$$module$webapp$kinggrid$signature_all);this.king=a};
var noop$$module$webapp$kinggrid$signature_all=function(){plus$$module$webapp$kinggrid$signature_all.hideLoading();return!0};proto$$module$webapp$kinggrid$signature_all=plus$$module$webapp$kinggrid$signature_all.create.prototype;var kingPlus$$module$webapp$kinggrid$signature_all=function(a){return 0==arguments.length?plus$$module$webapp$kinggrid$signature_all:new plus$$module$webapp$kinggrid$signature_all.create(a)};
kingPlus$$module$webapp$kinggrid$signature_all.changeSkin=function(a){Utils$$module$webapp$kinggrid$signature_all.extend(kingDialog$$module$webapp$kinggrid$signature_all.prototype,a)};root$$module$webapp$kinggrid$signature_all.kingPlus=kingPlus$$module$webapp$kinggrid$signature_all;
var CryptoJS$$module$webapp$kinggrid$signature_all=CryptoJS$$module$webapp$kinggrid$signature_all||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;b&&c.mixIn(b);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>
2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8;b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&
15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},k=g.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new f.init(c,b)}},l=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(k.stringify(a)))}catch(r){throw Error("Malformed UTF-8 data");
}},parse:function(a){return k.parse(unescape(encodeURIComponent(a)))}},m=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=l.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g);h=b?a.ceil(h):a.max((h|0)-this._minBufferSize,0);b=h*g;e=a.min(4*b,e);if(b){for(var m=0;m<b;m+=g)this._doProcessBlock(d,m);m=d.splice(0,b);c.sigBytes-=
e}return new f.init(m,e)},clone:function(){var a=e.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=m.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){m.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,
c){return(new p.HMAC.init(a,c)).finalize(b)}}});var p=c.algo={};return c}(Math);
(function(){var a=CryptoJS$$module$webapp$kinggrid$signature_all,b=a.lib,c=b.WordArray,d=b.Hasher,e=[];b=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],f=c[1],g=c[2],p=c[3],n=c[4],r=0;80>r;r++){if(16>r)e[r]=a[b+r]|0;else{var q=e[r-3]^e[r-8]^e[r-14]^e[r-16];e[r]=q<<1|q>>>31}q=(d<<5|d>>>27)+n+e[r];q=20>r?q+((f&g|~f&p)+1518500249):40>r?q+((f^g^p)+1859775393):60>r?
q+((f&g|f&p|g&p)-1894007588):q+((f^g^p)-899497514);n=p;p=g;g=f<<30|f>>>2;f=d;d=q}c[0]=c[0]+d|0;c[1]=c[1]+f|0;c[2]=c[2]+g|0;c[3]=c[3]+p|0;c[4]=c[4]+n|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(b);a.HmacSHA1=
d._createHmacHelper(b)})(this);var $$$module$webapp$kinggrid$signature_all=window.jQuery;kingPlus$$module$webapp$kinggrid$signature_all=window.kingPlus;isIE8$$module$webapp$kinggrid$signature_all=!1;root$$module$webapp$kinggrid$signature_all.JSON&&(isIE8$$module$webapp$kinggrid$signature_all='{"x":"\u4e2d"}'!==root$$module$webapp$kinggrid$signature_all.JSON.stringify({x:"\u4e2d"}));var canCanvas$$module$webapp$kinggrid$signature_all=!0;
try{root$$module$webapp$kinggrid$signature_all.document.createElement("canvas").getContext("2d")}catch(a){canCanvas$$module$webapp$kinggrid$signature_all=!1}function stringify$$module$webapp$kinggrid$signature_all(a){a=JSON.stringify(a);return isIE8$$module$webapp$kinggrid$signature_all?a.replace(/\\u([0-9a-fA-F]{2,4})/g,function(a,c){return String.fromCharCode(parseInt(c,16))}):a}var now$$module$webapp$kinggrid$signature_all=function(){return(new Date).getTime()};
function rnd$$module$webapp$kinggrid$signature_all(a){return(9301*a+49297)%233280/233280}function rand$$module$webapp$kinggrid$signature_all(){var a=""+Math.ceil(99999*rnd$$module$webapp$kinggrid$signature_all((new Date).getTime())),b=5-a.length;if(0<b)for(var c=0;c<b;c++)a="0"+a;return a}Utils$$module$webapp$kinggrid$signature_all=kinggrid.Utils;
var $window$$module$webapp$kinggrid$signature_all=$$$module$webapp$kinggrid$signature_all(window),$document$$module$webapp$kinggrid$signature_all=$$$module$webapp$kinggrid$signature_all(document),html$$module$webapp$kinggrid$signature_all=document.documentElement,isIE6$$module$webapp$kinggrid$signature_all=!("minWidth"in html$$module$webapp$kinggrid$signature_all.style),isLosecapture$$module$webapp$kinggrid$signature_all=!isIE6$$module$webapp$kinggrid$signature_all&&"onlosecapture"in html$$module$webapp$kinggrid$signature_all,
isSetCapture$$module$webapp$kinggrid$signature_all="setCapture"in html$$module$webapp$kinggrid$signature_all,isTouch$$module$webapp$kinggrid$signature_all,EventTypes$$module$webapp$kinggrid$signature_all,getEvent$$module$webapp$kinggrid$signature_all=function(a){isTouch$$module$webapp$kinggrid$signature_all&&(a=a.originalEvent?a.originalEvent.touches.item(0):a.touches.item(0));return a},Drag$$module$webapp$kinggrid$signature_all=function(a){this.start=$$$module$webapp$kinggrid$signature_all.proxy(this.start,
this);this.over=$$$module$webapp$kinggrid$signature_all.proxy(this.over,this);this.end=$$$module$webapp$kinggrid$signature_all.proxy(this.end,this);this.onstart=this.onover=this.onend=$$$module$webapp$kinggrid$signature_all.noop;EventTypes$$module$webapp$kinggrid$signature_all||(isTouch$$module$webapp$kinggrid$signature_all="mousedown"!=a.type,EventTypes$$module$webapp$kinggrid$signature_all={start:isTouch$$module$webapp$kinggrid$signature_all?"touchstart":"mousedown",over:isTouch$$module$webapp$kinggrid$signature_all?
"touchmove":"mousemove",end:isTouch$$module$webapp$kinggrid$signature_all?"touchend":"mouseup"})};
Drag$$module$webapp$kinggrid$signature_all.prototype={start:function(a){a=this.startFix(a);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("dragStart",this,a);$document$$module$webapp$kinggrid$signature_all.on(EventTypes$$module$webapp$kinggrid$signature_all.over,this.over).on(EventTypes$$module$webapp$kinggrid$signature_all.end,this.end);this.onstart(a);return!1},over:function(a){a=this.overFix(a);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("dragOver",this,a);this.onover(a);
return!1},end:function(a){a=this.endFix(a);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("dragEnd",this,a);$document$$module$webapp$kinggrid$signature_all.off(EventTypes$$module$webapp$kinggrid$signature_all.over,this.over).off(EventTypes$$module$webapp$kinggrid$signature_all.end,this.end);this.onend(a);return!1},startFix:function(a){a=getEvent$$module$webapp$kinggrid$signature_all(a);this.target=$$$module$webapp$kinggrid$signature_all(a.target);this.selectstart=function(){return!1};
$document$$module$webapp$kinggrid$signature_all.on("selectstart",this.selectstart).on("dblclick",this.end);if(isLosecapture$$module$webapp$kinggrid$signature_all)this.target.on("losecapture",this.end);else $window$$module$webapp$kinggrid$signature_all.on("blur",this.end);isSetCapture$$module$webapp$kinggrid$signature_all&&this.target[0].setCapture();return a},overFix:function(a){return a=getEvent$$module$webapp$kinggrid$signature_all(a)},endFix:function(a){a=getEvent$$module$webapp$kinggrid$signature_all(a);
$document$$module$webapp$kinggrid$signature_all.off("selectstart",this.selectstart).off("dblclick",this.end);isLosecapture$$module$webapp$kinggrid$signature_all?this.target.off("losecapture",this.end):$window$$module$webapp$kinggrid$signature_all.off("blur",this.end);isSetCapture$$module$webapp$kinggrid$signature_all&&this.target[0].releaseCapture();return a}};
Drag$$module$webapp$kinggrid$signature_all.create=function(a,b,c){var d=$$$module$webapp$kinggrid$signature_all(a),e=new Drag$$module$webapp$kinggrid$signature_all(b),f=EventTypes$$module$webapp$kinggrid$signature_all.start,g=function(){},h=a.className.replace(/^\s|\s.*/g,"")+"-drag-start",k=d[0].style,l,m,p,n,r=0,q=0,B=parseInt(k.left),v=parseInt(k.top),E=B,x=v,y=B,z=v;c&&(E=parseInt(k.marginLeft),x=parseInt(k.marginTop),y=E,z=x);var u={onstart:g,onover:g,onend:g,off:function(){d.off(f,e.start)}},
w={scale:function(){var a=1,b=d.parents(".kg-translate");null!=b&&(b=b.css("transform"),null!=b&&(b=b.split("(")[1].split(")")[0].split(","),a=b[0],b=b[3],a=Math.max(Math.sqrt(a*a),Math.sqrt(b*b))));return a}};e.onstart=function(b){var c="fixed"===d.css("position"),e=$document$$module$webapp$kinggrid$signature_all.scrollLeft(),f=$document$$module$webapp$kinggrid$signature_all.scrollTop(),g=d.width(),k=d.height();g*=w.scale();k*=w.scale();m=l=0;p=c?$window$$module$webapp$kinggrid$signature_all.width()-
g+l:$document$$module$webapp$kinggrid$signature_all.width()-g;n=c?$window$$module$webapp$kinggrid$signature_all.height()-k+m:$document$$module$webapp$kinggrid$signature_all.height()-k;k=d.offset();g=this.startLeft=c?k.left-e:k.left;c=this.startTop=c?k.top-f:k.top;this.clientX=b.clientX;this.clientY=b.clientY;k=d.parent();k.is("body")||(r=k[0].getBoundingClientRect().left+e,q=k[0].getBoundingClientRect().top+f);d.addClass(h);u.onstart.call(a,b,g,c)};e.onover=function(b){var e=b.clientX-this.clientX+
this.startLeft,f=b.clientY-this.clientY+this.startTop,g=d[0].style;e=Math.max(l,Math.min(p,e));f=Math.max(m,Math.min(n,f));c?(e=g.marginLeft=(e-r-B)/w.scale()+"px",f=g.marginTop=(f-q-v)/w.scale()+"px"):(e=g.left=(e-r)/w.scale()+"px",f=g.top=(f-q)/w.scale()+"px");y=parseInt(e);z=parseInt(f);u.onover.call(a,b,e,f)};e.onend=function(b){var e=d.position(),f=e.left;e=e.top;d.removeClass(h);var g=d[0].style,m=!0;6>Math.abs(y-E)&&6>Math.abs(z-x)&&(m=!1);c?u.onend.call(a,b,m,g.marginLeft,g.marginTop):(console.log(3123),
u.onend.call(a,b,m,f,e))};e.off=function(){d.off(f,e.start)};if(b)e.start(b);else d.on(f,e.start);return u};var Listener$$module$webapp$kinggrid$signature_all=kinggrid.Listener,Service$$module$webapp$kinggrid$signature_all=function(){};$$$module$webapp$kinggrid$signature_all.extend(Service$$module$webapp$kinggrid$signature_all.prototype,Listener$$module$webapp$kinggrid$signature_all.prototype);var SealService$$module$webapp$kinggrid$signature_all=function(){};
SealService$$module$webapp$kinggrid$signature_all.className=SealService$$module$webapp$kinggrid$signature_all.name||"SealService";Utils$$module$webapp$kinggrid$signature_all.inherit(SealService$$module$webapp$kinggrid$signature_all,Service$$module$webapp$kinggrid$signature_all);
$$$module$webapp$kinggrid$signature_all.extend(SealService$$module$webapp$kinggrid$signature_all.prototype,{loadSeal:function(){throw Error("must impl");},saveLog:function(){},verifyPwd:function(){throw Error("must impl");}});var CertService$$module$webapp$kinggrid$signature_all=function(){};CertService$$module$webapp$kinggrid$signature_all.className=CertService$$module$webapp$kinggrid$signature_all.name||"CertService";
Utils$$module$webapp$kinggrid$signature_all.inherit(CertService$$module$webapp$kinggrid$signature_all,Service$$module$webapp$kinggrid$signature_all);$$$module$webapp$kinggrid$signature_all.extend(CertService$$module$webapp$kinggrid$signature_all.prototype,{sign:function(){throw Error("must impl");},verifySign:function(){throw Error("must impl");}});var KgObject$$module$webapp$kinggrid$signature_all=function(){};
$$$module$webapp$kinggrid$signature_all.extend(KgObject$$module$webapp$kinggrid$signature_all.prototype,{getAttr:function(a){return this[a]},setAttr:function(a){var b=this;$$$module$webapp$kinggrid$signature_all.each(a,function(a,d){if("function"===typeof b[a])b[a](d);else b[a]=d})},removeAttr:function(a){delete this[a]}});
var Signature$$module$webapp$kinggrid$signature_all=function(a,b){var c=this;c.signatureid=a;c.setSignatureData(b);c.on("load",function(){Signature$$module$webapp$kinggrid$signature_all.list[a]=this});c.on("remove",function(a){a=c._getLogInfo(Utils$$module$webapp$kinggrid$signature_all.extend(a||{},{LOGTYPE:"00",LOGSORT:"14",LOGMEMO:"\u64a4\u9500\u7b7e\u7ae0\u6210\u529f"}));c.sealService.saveLog(a);delete Signature$$module$webapp$kinggrid$signature_all.list[c.signatureid]});c.on("update",function(a){"signMeta"===
c._item&&(a=c._getLogInfo(Utils$$module$webapp$kinggrid$signature_all.extend(a||{},{LOGTYPE:"00",LOGSORT:"304",LOGMEMO:"\u6570\u5b57\u7b7e\u540d\u6210\u529f"})),c.sealService.saveLog(a))});c.on("fireremove",function(){Signature$$module$webapp$kinggrid$signature_all.removeList.push(c.signatureid)});c.on("fireupdate",function(){for(var a=!1,b=0;b<Signature$$module$webapp$kinggrid$signature_all.updateList.length;b++)if(Signature$$module$webapp$kinggrid$signature_all.updateList[b]===c){a=!0;break}a||
Signature$$module$webapp$kinggrid$signature_all.updateList.push(c)});for(var d in Signature$$module$webapp$kinggrid$signature_all)Signature$$module$webapp$kinggrid$signature_all.hasOwnProperty(d)&&0==d.indexOf("on")&&(this[d]=Signature$$module$webapp$kinggrid$signature_all[d]);return this},blankImg$$module$webapp$kinggrid$signature_all="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVR42mNgAAIAAAUAAen63NgAAAAASUVORK5CYII=",blackImg$$module$webapp$kinggrid$signature_all=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAADElEQVR42mNoaGgAAAMEAYF1LgG8AAAAAElFTkSuQmCC",createImg$$module$webapp$kinggrid$signature_all=function(a,b,c){if(canCanvas$$module$webapp$kinggrid$signature_all){var d=root$$module$webapp$kinggrid$signature_all.document.createElement("canvas");d.height=c;d.width=b;var e=d.getContext("2d"),f=new Image;f.src=a;f.onload=function(){e.drawImage(f,0,0,b,c)}}else d=root$$module$webapp$kinggrid$signature_all.document.createElement("img"),
d.style.width=b+"px",d.style.height=c+"px",d.setAttribute("src",a);return d};Utils$$module$webapp$kinggrid$signature_all.inherit(Signature$$module$webapp$kinggrid$signature_all,KgObject$$module$webapp$kinggrid$signature_all);$$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.prototype,Listener$$module$webapp$kinggrid$signature_all.prototype);
$$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.prototype,{hashAlg:"sha1",encryptAlg:"RSA",_init:function(){},_getLogInfo:function(a){var b=decodeURIComponent(window.location.href),c=this.signatureData;return Utils$$module$webapp$kinggrid$signature_all.extend(a||{},{KEYSN:c.gbOvalue&&""!=c.gbOvalue?c.gbOvalue:c.keysn,SIGNSN:c.seal.signsn,DOCUMENTID:c.documentid,DOCUMENTNAME:c.documentname,APPVERSION:version$$module$webapp$kinggrid$signature_all.name,
APPTYPE:"HTML",APPCODE:this.appcode,EXTPARAM2:b})},error:function(a,b,c,d){c=a;Utils$$module$webapp$kinggrid$signature_all.is("Object",a)&&(c=a.errcode&&"511"!=a.errcode?a.errcode:a.errmsg);c||(c="-999");b=Utils$$module$webapp$kinggrid$signature_all.is("String",b)?b:"then";plus$$module$webapp$kinggrid$signature_all.hideLoading();Signature$$module$webapp$kinggrid$signature_all.options.errorCall?Signature$$module$webapp$kinggrid$signature_all.options.errorCall.call(null,a,b):plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg(c,
b),function(){d&&d._beginDlgOkCall&&1==d._beginDlgOkCall||Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall.call()},function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call()})},load:function(a){this.trigger("beforeLoad");this.setAttr(a);this.certService=new Signature$$module$webapp$kinggrid$signature_all.factory.cert[Signature$$module$webapp$kinggrid$signature_all.options.certType](a,
this.signatureData);var b=this.signatureData;if(void 0!==a.extra&&null!==a.extra&&void 0!==a.extra[this.signatureid]){if(void 0!==a.extra[this.signatureid].scaleImage&&null!==a.extra[this.signatureid].scaleImage&&(b.seal.height*=a.extra[this.signatureid].scaleImage,b.seal.width*=a.extra[this.signatureid].scaleImage),void 0!=a.extra[this.signatureid].position){var c=$$$module$webapp$kinggrid$signature_all.extend({},b.position),d="",e;for(e in c)d=e;this.removeItem(b.position);this.updatePos(a.extra[this.signatureid].position,
{marginLeft:null==a.extra[this.signatureid].offsetX?c[d].marginLeft:a.extra[this.signatureid].offsetX,marginTop:null==a.extra[this.signatureid].offsetY?c[d].marginTop:a.extra[this.signatureid].offsetY})}}else void 0!==a.scaleImage&&null!==a.scaleImage&&(b.seal.height*=a.scaleImage,b.seal.width*=a.scaleImage);this.sealService=new Signature$$module$webapp$kinggrid$signature_all.factory.seal[Signature$$module$webapp$kinggrid$signature_all.options.sealType](a,b);this._init();this.trigger("load");return this},
toBase64Img:function(a){var b=a.imgdata,c=b.indexOf(a.signsn);if(-1==c)return b;b=a.imgdata.substring(c+65);return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encodeByte(Utils$$module$webapp$kinggrid$signature_all.Base64.of(a.signsn).decodeByte(b))},clearImg:function(){if(this.imgEles)for(var a in this.imgEles)this.trigger("removeAt",this.imgEles[a][0]),this.imgEles[a].remove();this.imgEles={}},repaint:function(){this.clearImg();this.verify()},getUpdateType:function(){return this._item},
updatePos:function(a,b){var c=this.signatureData.position[a];this._item="position";this.signatureData.position[a]=Utils$$module$webapp$kinggrid$signature_all.extend({},c,b)},updateItem:function(a,b){this._item=a;this.signatureData[a]=b},removeItem:function(a){for(var b in a)delete a[b]},fireUpdate:function(a){var b=this,c=function(c){a&&a(c);b[c?"update":"restore"]();delete b._item};Signature$$module$webapp$kinggrid$signature_all.asyn.update?Signature$$module$webapp$kinggrid$signature_all.asyn.update.call(b,
c):(this.trigger("fireupdate"),c(!0));return this},restore:function(){this.setSignatureData(this.oriSignatureData);this.repaint()},update:function(){this.setSignatureData(this.signatureData);this.repaint();this.trigger("update");return this},remove:function(){this.clearImg();this.trigger("remove");for(var a in this)delete this[a];return this},fireRemove:function(a){var b=this,c=function(c){a&&a(c);c&&b.remove()};Signature$$module$webapp$kinggrid$signature_all.asyn.remove?Signature$$module$webapp$kinggrid$signature_all.asyn.remove.call(b,
c):(this.trigger("fireremove"),c(!0));return this},hide:function(){if(this.imgEles)for(var a in this.imgEles)this.imgEles[a].hide()},createImg:function(){var a=this.signatureData,b=$$$module$webapp$kinggrid$signature_all(document.createElement("img")),c=blankImg$$module$webapp$kinggrid$signature_all;this.broken||(c="data:image/"+a.seal.imgext+";base64,"+this.toBase64Img(a.seal));b.css({width:Math.ceil(9600*parseFloat(a.seal.width)/254),height:Math.ceil(9600*parseFloat(a.seal.height)/254)}).attr({src:c});
return b},show:function(){var a=this.signatureData.position,b=this.imgEles=this.imgEles||{},c;for(c in a){var d="kg-img-div-"+this.signatureid+"-"+c,e=b[d];e||(e=b[d]=this.showAt(c,a[c]));this._handleImg(e)}this.trigger("show")},showAt:function(a,b){this.trigger("beforeShowAt",a,b);var c=Utils$$module$webapp$kinggrid$signature_all.$(a),d=$$$module$webapp$kinggrid$signature_all(c);this.extra&&this.extra[this.signatureid]&&(c=this.extra[this.signatureid].scopePosition)&&(d=c instanceof Object?c.find("#"+
a):$$$module$webapp$kinggrid$signature_all(Utils$$module$webapp$kinggrid$signature_all.$(c)).find("#"+a));if(0==d.length)if(Signature$$module$webapp$kinggrid$signature_all.options.defaultPos)a=Signature$$module$webapp$kinggrid$signature_all.options.defaultPos,d=$$$module$webapp$kinggrid$signature_all(Utils$$module$webapp$kinggrid$signature_all.$(a));else throw Error("no find position:"+a+" signatureid="+this.signatureid);var e=this.createImg();e.addClass("kg-img").attr("id","kg-img-"+this.signatureid);
c=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-img-div").addClass("kg-img-div-"+a).attr({id:"kg-img-div-"+this.signatureid+"-"+a,elemid:a,signatureid:this.signatureid});c.append(e);c.css({width:e.width(),height:e.height()});var f=0,g=0,h=this.signatureData.dateTime;null!=h&&h.isCheck&&h.fontDate&&(this.addDateToImg(h.fontDate,this.signatureData.timestamp.time,c),null!=this.imageAndDate&&this.imageAndDate&&"outside"==h.fontDate.fontPosition[2]&&("right"==h.fontDate.fontPosition[3]?
f+=c.width():"left"==h.fontDate.fontPosition[3]&&(f+=c.width()),"below"==h.fontDate.fontPosition[4]&&(g+=c.height())));c.css({width:e.width()+f,height:e.height()+g});e=c;f="kg-default";if(h=d.attr("display"))d.addClass("display-"+h),f="kg-"+h,g=d,e=document.getElementById("kg-img-container-"+a),e||(e=document.createElement("div"),e.setAttribute("id","kg-img-container-"+a)),e=$$$module$webapp$kinggrid$signature_all(e).addClass(f+"-container"),e.append(c),c.attr("kg-display",!0);else if(g=d.offsetParent(),
"html"==g[0].tagName.toLowerCase()||"relative"==g[0].style.position)g=$$$module$webapp$kinggrid$signature_all("body");c.addClass(f);g.append(e);if(h){if("landscape"===h){d=e.children();f=e.parent().width();var k=0;d.each(function(){k+=parseInt($$$module$webapp$kinggrid$signature_all(this).width())+1});e.width(k>f?k:f)}}else this.calSealPos(d,c,e,b);this.trigger("showAt",c[0],a,b);return c},calSealPos:function(a,b,c,d){var e=a.offsetParent();c=c||b;if("html"==e[0].tagName.toLowerCase()||"relative"==
e[0].style.position)e=$$$module$webapp$kinggrid$signature_all("body");a=a.offset();var f=e.offset();e.is("body")&&(f={top:0,left:0});c.css({top:a.top-f.top,left:a.left-f.left});d?(e=d.marginLeft,d=d.marginTop):(e=b.css("marginLeft"),d=b.css("marginTop"));b.css({marginLeft:e||0,marginTop:d||0})},addDateToImg:function(a,b,c){b=kinggrid.Utils.formatDate(new Date(b),a.fontFormat);var d=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-date"),e=0,f=0;"outside"==a.fontPosition[2]&&
("right"==a.fontPosition[3]?e+=c.width():"left"==a.fontPosition[3]&&(e-=c.width()),"below"==a.fontPosition[4]&&(f+=c.height()));d.css({width:c.width(),height:c.height(),top:f,left:e});e=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-date-tmb").css({width:c.width(),top:"0px"});f=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-date-lcr").css({"text-align":a.fontPosition[0],"font-family":a.fontFamily,"font-size":a.fontSize+"px",
color:a.fontColor});"bottom"==a.fontPosition[1]?e.css({bottom:0}):"middle"==a.fontPosition[1]&&f.css({"line-height":c.height()+"px"});f.html(b);e.html(f);d.html(e);c.append(d)},canSign:function(){return!this.modified&&!Signature$$module$webapp$kinggrid$signature_all.options.readonly&&Signature$$module$webapp$kinggrid$signature_all.options.signable&&!this.signatureData.signMeta},canMove:function(a){(a=!Signature$$module$webapp$kinggrid$signature_all.options.readonly&&this.signatureData.moveable&&Signature$$module$webapp$kinggrid$signature_all.options.moveable&&
!$$$module$webapp$kinggrid$signature_all(a).attr("kg-display"))&&Signature$$module$webapp$kinggrid$signature_all.options.moveable_self&&(a=this.signatureData.keysn==Signature$$module$webapp$kinggrid$signature_all.options.keysn);return a},canDelete:function(){return!Signature$$module$webapp$kinggrid$signature_all.options.readonly},_handleImg:function(a){a.show();if(0==a.children(".kg-shade").length){var b=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-shade");b.append(createImg$$module$webapp$kinggrid$signature_all(blankImg$$module$webapp$kinggrid$signature_all,
a.width(),a.height()));a.append(b)}this._invalid(a);this.trigger("handleImg",a[0])},setSignatureData:function(a){Utils$$module$webapp$kinggrid$signature_all.is("String",a)?this.signatureData=JSON.parse(Utils$$module$webapp$kinggrid$signature_all.Base64.of().decode(a)):this.signatureData=a;this.oriSignatureData=JSON.parse(JSON.stringify(this.signatureData))},getSignatureid:function(){return this.signatureid},getSignatureData:function(){var a=JSON.stringify(this.signatureData);return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(a)},
getBase64Image:function(a,b,c,d){c="kg-img-div-"+a+"-"+c;c=document.getElementById(c);null!=c&&(isIE8$$module$webapp$kinggrid$signature_all?d(this,"",a,b):html2canvas(c).then(function(c){c=c.toDataURL("image/png").split(",");d(this,c,a,b)}))},_invalid:function(a){var b=a.children(".kg-invalid");if(0==b.length){b=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).addClass("kg-hide").addClass("kg-invalid");a.append(b);var c=a.height()/3;b.css({top:c,height:c});c/=3;for(var d=a.width(),
e=0;3>e;e++){var f=$$$module$webapp$kinggrid$signature_all(document.createElement("div")).height(c);0==e%2&&(f.addClass("kg-invalid-item"),f.append(createImg$$module$webapp$kinggrid$signature_all(blackImg$$module$webapp$kinggrid$signature_all,d,c)));b.append(f)}}if(this.modified){c="";for(d=0;d<this.modifiedItems.length;d++)e=this.modifiedItems[d],c+=e.desc+"["+e.field+"]\u7531{"+e.orivalue+"}\u66f4\u6539\u4e3a{"+e.newvalue+"};";a.attr("modified",c).addClass("error");b.removeClass("kg-hide")}else a.removeAttr("modified").removeClass("error"),
b.addClass("kg-hide")},_verify:function(a,b){this.trigger("before_verify");a=this.verifyProtectedData(a);if(!b||b&&b.batchVerify||null==this.oriSignatureData.timestamp.timestampInfo)return this.show(),this.trigger("_verify"),!a;var c=this;this.getVerifyTimeStamp(this.oriSignatureData.timestamp.timestampInfo,function(a){c.timeVerify=a;c.show();c.trigger("_verify");b&&b.sucCall&&b.sucCall.call(c)})},verify:function(a,b){this.trigger("beforeVerify");a=this._verify(a,b);this.trigger("verify");return a},
getVerifyProtectedItems:function(a,b){for(var c in a)if(void 0!=a[c]&&null!=a[c]){var d=a[c];if(d.field==b)return d}return null},getVerifyProtectedData:function(){for(var a=this.validatedData,b=this.signatureData.protectedData,c={},d=0;d<b.length;d++)if(void 0!=b[d]&&null!=b[d]){var e=b[d],f=e.field,g=a&&(a[f]||this.getVerifyProtectedItems(a,f)&&this.getVerifyProtectedItems(a,f).value);if(null==g){var h=Utils$$module$webapp$kinggrid$signature_all.$(f);if(h){if(g=h.getAttribute("kg-value")||h.value,
void 0===g||null===g)g=h.innerHTML||h.innerText}else g=void 0!=e.name&&null!=e.name?document.getElementById(e.name).value:""}e=Utils$$module$webapp$kinggrid$signature_all.val(g,this);e=this._formatValue(e);c[f]=e}return c},getSignTimeStamp:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].field]=a[c].value;return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(stringify$$module$webapp$kinggrid$signature_all(b))},getValidatedTimeStamp:function(){var a=this.getVerifyProtectedData();
a=stringify$$module$webapp$kinggrid$signature_all(a);return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(a)},getVerifyTimeStamp:function(a,b){var c=this.getValidatedTimeStamp(),d=a.CertData,e=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);e.invoke("SetParamByName","TSCERTDATA",Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(d)).ret(function(){e.invoke("KGVerifyTSWithReq",
a.TimeStampResponse,a.TimeStampResult,"",c,a.TimeStr,"").ret(function(a){b.call(this,a.result)})})},getH5SignData:function(){var a=this.hashAlg,b=this.encryptAlg,c=CryptoJS$$module$webapp$kinggrid$signature_all.SHA1(this.getSignData()).toString();return[{hashAlg:a,encryptAlg:b,signdata:c}]},verifyProtectedData:function(a){a&&(this.validatedData=a);a={};$$$module$webapp$kinggrid$signature_all.extend(!0,a,this.signatureData.protectedData);Signature$$module$webapp$kinggrid$signature_all.verifyData&&
(this.validatedData=Signature$$module$webapp$kinggrid$signature_all.verifyData(a));a=[];for(var b=this.getVerifyProtectedData(),c=this.signatureData.protectedData,d=0;d<c.length;d++)if(void 0!=c[d]&&null!=c[d]){var e=c[d],f=b[c[d].field];f!==e.value&&a.push({field:e.field,desc:e.desc,orivalue:e.value,newvalue:f})}this.modified=0<a.length;this.modifiedItems=a;return this.modified},verifySignData:function(a){var b=this;plus$$module$webapp$kinggrid$signature_all.showLoading();var c=this.certService;
if(this.signatureData.signMeta.html2sign){c instanceof ServerCert$$module$webapp$kinggrid$signature_all||(c=new ServerCert$$module$webapp$kinggrid$signature_all(Signature$$module$webapp$kinggrid$signature_all.options),c.sData=b.signatureData);var d=b.getVerifyProtectedData();for(var e=this.signatureData.protectedData,f=[],g=0;g<e.length;g++){var h=e[g],k={},l;for(l in h)h.hasOwnProperty(l)&&(k[l]=h[l]);k.value=d[h.field];f.push(k)}d=stringify$$module$webapp$kinggrid$signature_all(f)}else d=this.getValidatedSignData();
c.verifySign($$$module$webapp$kinggrid$signature_all.extend({seal:this.signatureData.seal,signeddata:this.signatureData.signMeta.signeddata,crtdata:this.signatureData.signMeta.certinfo.crtdata,keysn:this.signatureData.keysn,signsn:this.signatureData.seal.signsn,signdata:d},{successCall:function(c){plus$$module$webapp$kinggrid$signature_all.hideLoading();if(!c.errcode){b.signModified=!c.result;var d=b.verify(null,{sucCall:function(){a&&a(c)}})}null!=d&&a&&a(c)}}))},_renderValue:function(a){return a.replace(/\r\n/ig,
"<br>")},_formatValue:function(a,b){a&&(a=a.replace(/\r\n/ig,"\n"),a=a.replace(/\n/ig,"\r\n"));return a},getItemVal:function(a){var b;if(b=Utils$$module$webapp$kinggrid$signature_all.is("String",a)?Utils$$module$webapp$kinggrid$signature_all.$(a):a)return a=b.tagName.toLowerCase(),"input"===a||"textarea"===a||"select"===a?b.getAttribute("kg-value")||b.value:b.getAttribute("kg-value")||(isIE8$$module$webapp$kinggrid$signature_all?b.innerText:b.textContent);throw Error("No find protectedItem:"+a+" signatureid="+
this.signatureid);},getProtectedData:function(a){var b=this,c=[],d=function(a){var c=Utils$$module$webapp$kinggrid$signature_all.$(a);if(c){var d={field:a};d.desc=c.getAttribute("kg-desc")||a;d.value=b.getItemVal(c);return d}throw Error("No find protectedItem:"+a+" signatureid="+this.signatureid);},e=function(a){if(Utils$$module$webapp$kinggrid$signature_all.is("String",a))a=d(a);else if(!Utils$$module$webapp$kinggrid$signature_all.is("Object",a)||!a.field)throw Error("Unsupported protectedItems:"+
a.toString);Utils$$module$webapp$kinggrid$signature_all.is("Function",a.value)&&(a.value=a.value.call(b,a.field,a.desc));a.value=b._formatValue(a.value);return a};if(a)if(Utils$$module$webapp$kinggrid$signature_all.is("Array",a))for(var f=0,g=a.length;f<g;f++)c.push(e(a[f]));else c.push(e(a));return c},__findSignedData:function(a){if(Utils$$module$webapp$kinggrid$signature_all.is("String",a))return a.split(";")[0];if(Utils$$module$webapp$kinggrid$signature_all.is("Array",a))return a[0];throw Error("error signeddata: "+
a);},getValidatedSignData:function(){var a=this.getVerifyProtectedData();a=stringify$$module$webapp$kinggrid$signature_all(a);a=Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(a);return CryptoJS$$module$webapp$kinggrid$signature_all.SHA1(a).toString()},getSignData:function(a){a=(a||this.signatureData).protectedData;for(var b={},c=0;c<a.length;c++)b[a[c].field]=a[c].value;return Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(stringify$$module$webapp$kinggrid$signature_all(b))},
showSignSignatureDialog:function(a){var b={target:Utils$$module$webapp$kinggrid$signature_all.is("Array",a.target)?a.target:[a.target],title:kinggrid.msg("SignSignature","KG_TITLE"),onCancel:function(){Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall&&Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall.call()},onShow:function(){var a=this;setTimeout(function(){a.find("#kg-password").focus()},40);a.find("#kg-password").keydown(function(b){13==b.keyCode&&a.options.onOk.call(a)})},
onOk:function(){var b=this.find("#kg-password");if(!b.val())return plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("in_pwd_msg","KG_MSG"),function(){b.focus()}),!1;a._onOk.call(this,b.val());return!1}};return this.showDialog("signSignatureBtl",b)},changeMoveAble:function(a,b){this.signatureData.moveable=a;this.fireUpdate();b&&b()},signSignature:function(a){var b=this,c={target:b,_onOk:function(c){var d=this,f=b.getH5SignData();b.runSign(f,c,function(c){c.result?b.fireUpdate(function(a){a&&
d.remove()}):b.error(c,null,null,{_beginDlgOkCall:!0});a&&a(c)})}};if(b.signatureData.phoneshield)"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&b.sealService.getPhoneShieldLic({},function(a){"1"==a.phoneshield||"3"==a.phoneshield?(kinggrid.options.timeout=1E3*(a.validatetime+10),c._onOk("")):"2"==a.phoneshield?b.error({errcode:"11110"},"then"):b.error({errcode:"11109"},"then")});else return b.showSignSignatureDialog(c)},showRevokeSignatureDialog:function(a){var b={target:Utils$$module$webapp$kinggrid$signature_all.is("Array",
a.target)?a.target:[a.target],title:kinggrid.msg("RevokeSignature","KG_TITLE"),quickClose:void 0==Signature$$module$webapp$kinggrid$signature_all.options.quickClose?!0:Signature$$module$webapp$kinggrid$signature_all.options.quickClose,onCancel:function(){Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall&&Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall.call()},onShow:function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call();
var a=this;setTimeout(function(){a.find("#kg-password").focus()},40);a.find("#kg-password").keydown(function(b){13==b.keyCode&&a.options.onOk.call(a)})},onOk:function(){var b=this.find("#kg-password");if(!b.val())return plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("in_pwd_msg","KG_MSG"),function(){b.focus()}),!1;a._onOk.call(this,b.val());return!1}};return this.showDialog("revokeSignatureBtl",b)},revokeSignature:function(a){var b=this,c={target:b,_onOk:function(c){var d=this;plus$$module$webapp$kinggrid$signature_all.showLoading();
b.sealService.verifyPwd({pwd:c,keysn:b.signatureData.keysn,successCall:function(c){plus$$module$webapp$kinggrid$signature_all.hideLoading();c.result&&(void 0!=c.delkeysn?c.delkeysn==b.signatureData.keysn:1)?void 0!==Signature$$module$webapp$kinggrid$signature_all.options.delCallBack&&Signature$$module$webapp$kinggrid$signature_all.options.delCallBack?Signature$$module$webapp$kinggrid$signature_all.options.delCallBack(b.signatureid,b.signatureData)&&b.fireRemove(function(a){a&&(d.remove?d.remove():
b.remove())}):b.fireRemove(function(a){a&&(d.remove?d.remove():b.remove())}):b.error(c,null,null,{_beginDlgOkCall:!0});a&&a(c)},phoneshield:b.signatureData.phoneshield})}};if(b.signatureData.phoneshield&&"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType)b.sealService.getPhoneShieldLic({},function(a){"1"==a.phoneshield||"3"==a.phoneshield?(kinggrid.options.timeout=1E3*(a.validatetime+10),c._onOk("")):"2"==a.phoneshield?b.error({errcode:"11110"},"then"):b.error({errcode:"11109"},
"then")});else if(Signature$$module$webapp$kinggrid$signature_all.options.showNoPW&&"server"==Signature$$module$webapp$kinggrid$signature_all.options.sealType)c._onOk(Signature$$module$webapp$kinggrid$signature_all.options.password);else return b.showRevokeSignatureDialog(c)},showDialog:function(a,b){var c=Utils$$module$webapp$kinggrid$signature_all.is("Array",b.target)?b.target:[b.target],d={title:kinggrid.msg("KinggridSignature","KG_TITLE"),onShow:function(){var a=this;setTimeout(function(){a.find("#kg-password").focus()},
40);a.find("#kg-password").keydown(function(b){13==b.keyCode&&a.options.onOk.call(a)})},onCancel:b.errCall||function(){plus$$module$webapp$kinggrid$signature_all.hideLoading();return!0},content:function(){var b=[Signature$$module$webapp$kinggrid$signature_all.options.template[a]].concat(c);return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,b)}};b=Utils$$module$webapp$kinggrid$signature_all.extend(d,b);var e=plus$$module$webapp$kinggrid$signature_all.showDialog(a,b);if("showSealsBtl"===
a){var f=e.find("#sealTpl-dialog"),g=!1,h=0,k=0,l=0,m=0;f.prevObject[0].onmousedown=function(a){g=!0;a=a||event;null!=a&&(h=a.clientX,k=a.clientY,l=parseInt(f.prevObject[0].style.top),m=parseInt(f.prevObject[0].style.left))};f.prevObject[0].onmousemove=function(a){if(g&&(a=a||event,null!=a)){var b=m+a.clientX-h;a=l+a.clientY-k;0<b&&0<a&&(f.prevObject[0].style.left=b+"px",f.prevObject[0].style.top=a+"px")}};f.prevObject[0].onmouseup=function(a){g&&(g=!1,m=l=k=h=0)}}"signatureInfoBtl"!=a&&"signInfoBtl"!=
a||e.find(".ui-dialog-close").click(function(){e.close();Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall&&Signature$$module$webapp$kinggrid$signature_all.options.dlgCancelCall.call()});return e},runMove:function(a,b,c){var d=this;globalLisenter$$module$webapp$kinggrid$signature_all.trigger("startMove",d,a,b);return"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&Signature$$module$webapp$kinggrid$signature_all.options.moveable_self&&d.keysn!=d.signatureData.keysn?
(Signature$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("cannot_move","KG_MSG")),!1):function(a,b,c){b=Drag$$module$webapp$kinggrid$signature_all.create(b,a,!0);b.onend=function(a,b,e,f){c&&c(b,e,f);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("endMove",d,a,e,f);b&&(a=$$$module$webapp$kinggrid$signature_all(this),d.updatePos(a.attr("elemid"),{marginLeft:e,marginTop:f}),d.fireUpdate())};a.preventDefault();return b}(a,b,c)},runSign:function(a,b,c){var d=this,e=d.signatureData;
plus$$module$webapp$kinggrid$signature_all.showLoading();d.certService.sign({seal:this.signatureData.seal,keysn:this.signatureData.keysn,signsn:this.signatureData.seal.signsn,password:b,phoneshield:this.signatureData.phoneshield,signMeta:a,successCall:function(b){plus$$module$webapp$kinggrid$signature_all.hideLoading();b.result&&(b.signeddata?(b.certinfo.algName=b.certinfo.algName.toUpperCase(),d.updateItem("signMeta",{hashAlg:a[0].hashAlg,encryptAlg:a[0].encryptAlg,signdata:a[0].signdata,signeddata:d.__findSignedData(b.signeddata),
certinfo:b.certinfo})):(b.result=!1,b.errcode="signErr"),e.certType=Signature$$module$webapp$kinggrid$signature_all.options.certType);c&&c(b)}})}});plus$$module$webapp$kinggrid$signature_all=kingPlus$$module$webapp$kinggrid$signature_all();
Signature$$module$webapp$kinggrid$signature_all.options=$$$module$webapp$kinggrid$signature_all.extend({b64Url:"/iWebSignature_base64",imageUrl:"/iWebSignature_image"},kinggrid.options,{dialogConfig:{okValue:"\u786e  \u5b9a",cancelValue:"\u53d6  \u6d88",fixed:!0,backdropOpacity:.2,modal:!0},template:{}},window.KGCONFIG);Signature$$module$webapp$kinggrid$signature_all.addProvider=function(a,b,c){Signature$$module$webapp$kinggrid$signature_all.factory[a][b]=c};var aisleKing$$module$webapp$kinggrid$signature_all;
Signature$$module$webapp$kinggrid$signature_all.init=function(a,b){this.Seals={};Utils$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.options,a);var c=Signature$$module$webapp$kinggrid$signature_all.options;b=b?b:a.okCall;c.serverUrl&&(c.b64Url="_signature_b64",c.imageUrl="_signature_image",0<c.serverUrl.indexOf("?")?c.serverUrl+="&action=rest":c.serverUrl+="?action=rest");"client"==c.sealType?(c.clientUrl=c.https,aisleKing$$module$webapp$kinggrid$signature_all=
Signature$$module$webapp$kinggrid$signature_all.aisleKing=kinggrid.surry(c.clientUrl?c.clientUrl:"http://127.0.0.1:9581","IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode)):aisleKing$$module$webapp$kinggrid$signature_all=Signature$$module$webapp$kinggrid$signature_all.aisleKing=kinggrid.surry(c.serverUrl||c.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);
(a=c.clientConfig)&&"client"===c.sealType?Signature$$module$webapp$kinggrid$signature_all.AXI("SetParamByName",a,b):b&&b.call();globalLisenter$$module$webapp$kinggrid$signature_all.trigger("init")};Signature$$module$webapp$kinggrid$signature_all.factory={cert:{},seal:{}};Signature$$module$webapp$kinggrid$signature_all.SealService=SealService$$module$webapp$kinggrid$signature_all;Signature$$module$webapp$kinggrid$signature_all.CertService=CertService$$module$webapp$kinggrid$signature_all;
Signature$$module$webapp$kinggrid$signature_all.asyn={};
Signature$$module$webapp$kinggrid$signature_all._create=function(a){var b=this;b.setAttr(a);b.certService=new Signature$$module$webapp$kinggrid$signature_all.factory.cert[b.certType](a);b.sealService=new Signature$$module$webapp$kinggrid$signature_all.factory.seal[b.sealType](a);b.on("createSignature",function(a,d,e){a=[];var c=b._getLogInfo({LOGTYPE:"00",LOGSORT:"13",LOGMEMO:"\u76d6\u7ae0\u6210\u529f",LOGSORTSUBCLASS:"1301"});a.push(Utils$$module$webapp$kinggrid$signature_all.extend(d||{},c));e&&
a.push(b._getLogInfo({LOGTYPE:"00",LOGSORT:"304",LOGMEMO:"\u6570\u5b57\u7b7e\u540d\u6210\u529f"}));b.sealService.saveLog(a)});return this};var signature$$module$webapp$kinggrid$signature_all=function(){};signature$$module$webapp$kinggrid$signature_all.prototype=Signature$$module$webapp$kinggrid$signature_all.prototype;var prototype$$module$webapp$kinggrid$signature_all=new signature$$module$webapp$kinggrid$signature_all;Signature$$module$webapp$kinggrid$signature_all._create.prototype=prototype$$module$webapp$kinggrid$signature_all;
$$$module$webapp$kinggrid$signature_all.extend(prototype$$module$webapp$kinggrid$signature_all,{keyData:null,sealExpired:function(a,b,c,d,e){var f=this,g=!0;if(void 0===Signature$$module$webapp$kinggrid$signature_all.options.valid||null===Signature$$module$webapp$kinggrid$signature_all.options.valid||!1===Signature$$module$webapp$kinggrid$signature_all.options.valid)return f.certExpired(b,c,d);if(void 0!==a.endata&&null!==a.endata){var h=a.endata;e=parseInt(c.substr(0,4));a=parseInt(c.substr(5,2));
g=parseInt(c.substr(8,2));var k=parseInt(h.substr(0,4)),l=parseInt(h.substr(5,2));h=parseInt(h.substr(8,2));e>k?(f.errorCallback({errcode:"11104"},b.errorCall),g=!1):e==k?a>l?(f.errorCallback({errcode:"11104"},b.errorCall),g=!1):a==l?g>h?(f.errorCallback({errcode:"11104"},b.errorCall),g=!1):g=!0:g=!0:g=!0}else return a=Signature$$module$webapp$kinggrid$signature_all.options.serverUrl+"_key_sealIsExpired",e=(parseInt(e)+1).toString(),$$$module$webapp$kinggrid$signature_all.ajax({url:a,type:"POST",
data:{keysn:f.keyData.keysn,year:(new Date).getFullYear(),month:(new Date).getMonth(),date:(new Date).getDate(),index:e},async:!1,success:function(a){if(a.error)return f.errorCallback({errcode:"11105"},b.errorCall),!1;if(0==a.result)return f.certExpired(b,c,d);f.errorCallback({errcode:"11104"},b.errorCall);return!1},error:function(a){f.errorCallback({errcode:"11105"},b.errorCall)}}),!1;return g?f.certExpired(b,c,d):g},certExpired:function(a,b,c){var d=this,e=!1;if(void 0===Signature$$module$webapp$kinggrid$signature_all.options.valid||
null===Signature$$module$webapp$kinggrid$signature_all.options.valid||!1===Signature$$module$webapp$kinggrid$signature_all.options.valid)return!0;kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode).invoke("KGGetCerInfo","").ret(function(f){var g=parseInt(b.substr(0,4)),h=parseInt(b.substr(5,2)),k=parseInt(b.substr(8,2));if(f.result){f=
f.certinfo.notAfter;var l=parseInt(f.substr(0,4)),m=parseInt(f.substr(4,1));m=0==m?parseInt(f.substr(5,1)):parseInt(f.substr(4,2));var p=parseInt(f.substr(6,1));p=0==p?parseInt(f.substr(7,1)):parseInt(f.substr(6,2));g>l?d.errorCallback({errcode:"11103"},a.errorCall):g==l?h>m?d.errorCallback({errcode:"11103"},a.errorCall):h==m?k>p?d.errorCallback({errcode:"11103"},a.errorCall):e=!0:e=!0:e=!0}else d.errorCallback({errcode:"11106"},a.errorCall);void 0!==c&&null!==c&&c(e)});return e},errorCallback:function(a,
b,c,d){b?(plus$$module$webapp$kinggrid$signature_all.hideLoading(),b.call(null,a,c)):this.error(a,c,null,d)},runHW:function(a,b){var c=this;plus$$module$webapp$kinggrid$signature_all.showLoading();"undefined"!=typeof a.imageData&&null!=a.imageData&&(void 0!==a.beginCall&&a.beginCall&&a.beginCall.call(c),c.sealService.loadSeal({data:a.imageData,successCall:function(d){plus$$module$webapp$kinggrid$signature_all.hideLoading();if(d.result&&d.seals){for(var e in d.seals){d.seals=[{width:a.width,height:a.height,
imgext:d.seals[e].imgext,signname:a.name,signsn:d.seals[e].signsn,username:d.seals[e].username,imgdata:a.imageData,headinfoex:d.seals[e].headinfoex}];break}c.keyData=d;c.showSeals(b)}else c.errorCallback(d,a.errorCall)},errorCall:function(b){c.errorCallback(b,a.errorCall)}}))},run:function(a){var b=this;b.keyData?b.showSeals(a):(plus$$module$webapp$kinggrid$signature_all.showLoading(),void 0!==a.beginCall&&a.beginCall&&a.beginCall.call(b),b.sealService.loadSeal({successCall:function(c){plus$$module$webapp$kinggrid$signature_all.hideLoading();
c.result?c.seals&&c.seals.length?(b.keyData=c,void 0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&void 0===c.ServerTime?void 0!==b.serverUrl&&null!==b.serverUrl?(c={usercode:b.usercode,keysn:b.keyData.keysn,signname:b.signname,authcode:Signature$$module$webapp$kinggrid$signature_all.authcode},kinggrid.surry(b.serverUrl).request("_key_load",c).ret(function(c){c.result?(b.curDate=c.ServerTime,b.keyData=c,b.showSeals(a)):
b.errorCallback(c,a.errorCall)})):(b.curDate=(new Date).toLocaleString(),b.showSeals(a)):(b.curDate=c.ServerTime,b.showSeals(a))):b.errorCallback({errcode:"11100"+Signature$$module$webapp$kinggrid$signature_all.options.imgtag},a.errorCall):b.errorCallback(c,a.errorCall)},errorCall:function(c){b.errorCallback(c,a.errorCall)}}));return this},getSealsByKeysn:function(a,b,c){var d=this;d.sealService.loadSeal({successCall:function(a){if(a.result){var c=[];if(void 0!==b&&null!=b){for(var e=0;e<a.seals.length;++e)c[e]=
d.toBase64Img(a.seals[e]);b(c)}}},errorCall:function(a){d.errorCallback(a,c.errorCall)}})},loadSeals:function(a,b){var c=this;c.sealService.loadSeal({successCall:function(b){void 0!==a&&null!==a&&null!==b&&void 0!==b.seals&&null!==b.seals&&a(b)},errorCall:function(a){c.errorCallback(a,b&&b.errorCall?b.errorCall:null)}})},runSS:function(a,b){var c=this;null!==b&&(c.keyData=b,null==b.seals||0==b.seals.length?c.errorCallback({errcode:"11107"},a.errorCall):void 0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&
0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&void 0===b.ServerTime?void 0!==c.serverUrl&&null!==c.serverUrl?(b={usercode:c.usercode,keysn:c.keyData.keysn,signname:c.signname,authcode:Signature$$module$webapp$kinggrid$signature_all.authcode},kinggrid.surry(c.serverUrl).request("_key_load",b).ret(function(b){b.result?(c.curDate=b.ServerTime,c.keyData=b,c.showSeals(a)):c.errorCallback(b,a.errorCall)})):(c.curDate=(new Date).toLocaleString(),c.showSeals(a)):(c.curDate=b.ServerTime,
c.showSeals(a)))},formatPos:function(a,b,c){var d={};if(a){var e=function(a){var e=a.elemid||a[0].id;e||(e="body");d[e]=void 0!=b&&void 0!=c?{marginLeft:b,marginTop:c}:Utils$$module$webapp$kinggrid$signature_all.filter(a,e)};if(Utils$$module$webapp$kinggrid$signature_all.is("Array",a))for(var f=0;f<a.length;f++)e(a[f]);else Utils$$module$webapp$kinggrid$signature_all.is("String",a)?d[a]=void 0!=b&&void 0!=c?{marginLeft:b,marginTop:c}:{}:e(a)}else d.body={};return d},exec:function(a,b,c,d,e,f){var g=
this;delete g.signatureData;var h=null!=a.protectedItemsType&&"1"==a.protectedItemsType?a.protectedItems:g.getProtectedData(a.protectedItems);h={timestamp:{time:void 0==a.signtime?(new Date).getTime():(new Date(Date.parse(a.signtime.replace(/-/g,"/")))).getTime(),signtime:void 0==a.showtime?a.signtime:a.showtime,timestampInfo:a.timestampInfo},appname:navigator.userAgent,documentid:void 0==a.documentid?g.documentid:a.documentid,documentname:void 0==a.documentname?g.documentname:a.documentname,moveable:Utils$$module$webapp$kinggrid$signature_all.boolean(a,
"moveable",Signature$$module$webapp$kinggrid$signature_all.options.moveable),keysn:g.keyData.keysn,orgname:g.keyData.orgname,usercode:g.keyData.usercode,username:g.keyData.username||c.username,phoneshield:Signature$$module$webapp$kinggrid$signature_all.options.phoneshield?!0:!1,gbOvalue:g.keyData.gbOvalue,seal:c,protectedData:h,sealType:a.sealType||g.sealType,extparam:a.extparam,ver:Signature$$module$webapp$kinggrid$signature_all.version,dateTime:a.datetime};g.signatureData=h;g.certService.sData=
g.signatureData;g.sealService.sData=g.signatureData;plus$$module$webapp$kinggrid$signature_all.showLoading();var k=a.autoCert||g.autoCert||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield&&"1"!=Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone,l=function(a){var b=g.signatureData;if(a&&a.position){if(a.offsetX&&a.offsetY)a.changeOffsetXY&&a.changeOffsetXY(a),b.position=g.formatPos(a.position,a.offsetX,a.offsetY);else if(a.changeOffsetXY){var d={width:Math.ceil(9600*
parseFloat(c.width)/254),height:Math.ceil(9600*parseFloat(c.height)/254)};d=a.changeOffsetXY(d);b.position=g.formatPos(a.position,d.offsetX,d.offsetY)}else b.position=g.formatPos(a.position);d=a.signatureid||g.genId();a&&a.scopePosition&&(void 0==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra={}),Signature$$module$webapp$kinggrid$signature_all.options.extra[d]={scopePosition:a.scopePosition});b.timeid=(new Date).getTime();
var e=(new Signature$$module$webapp$kinggrid$signature_all(d,b)).load(Signature$$module$webapp$kinggrid$signature_all.options);a.okCall&&(b={name:c.signname,height:c.height,width:c.width,imgdata:g.toBase64Img(c)},a.isBatchSignature?a.okCall.call(e,function(a){},a.documentid):a.okCall.call(e,function(b){g.trigger("createSignature",e,a.logMeta,k);b&&e.show()},b));plus$$module$webapp$kinggrid$signature_all.hideLoading()}else throw Error("no set position");};if(k){g.getSignData(h);h=g.getH5SignData();
if(a.signMeta)h[Utils$$module$webapp$kinggrid$signature_all.is("Array",a.signMeta)?"concat":"push"](a.signMeta);a.beforeSignCall&&a.beforeSignCall.call(g,h);e?"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType?g.runSign(h,d,function(h){h.result&&(l(a),f&&1<f.batchSignature.length&&(a.documentid=f.batchSignature[f.batchSignature.length-1].documentid,a.documentname=f.batchSignature[f.batchSignature.length-1].documentname,a.position=f.batchSignature[f.batchSignature.length-1].position,
a.protectedItems=f.batchSignature[f.batchSignature.length-1].protectedItems,--f.batchSignature.length,g.exec(a,b,c,d,e,f)));b(h)}):g.runSign(h,d,function(c){c.result&&l(a);b(c)}):g.runSign(h,d,function(c){c.result&&l(a);b(c)})}else e?l(a):g.sealService.verifyPwd({pwd:d,keysn:h.keysn,successCall:function(c){c.result&&l(a);b(c)}})},runPwd:function(a){var b=this;b.showPwdDialog({cancelCall:a.cancelCall,_onOk:function(c){Signature$$module$webapp$kinggrid$signature_all.options.showNoPW=!0;Signature$$module$webapp$kinggrid$signature_all.options.password=
c;var d=this.find("#kg-remenberPwd").is(":checked");b.trigger("execSuccess",this,c,d);b.run($$$module$webapp$kinggrid$signature_all.extend(a,{beginCancalCall:function(){Signature$$module$webapp$kinggrid$signature_all.options.showNoPW=!1;Signature$$module$webapp$kinggrid$signature_all.options.password=""}}))}})},showPwdDialog:function(a){var b=this,c=a._onOk;b.showDialog("passwordTpl",{onCancel:a.cancelCall,onShow:function(){var a=this;b.trigger("showSealsDialog_PW",a);setTimeout(function(){a.find("#kg-password").focus()},
40);a.find("#kg-password").keydown(function(b){13==b.keyCode&&a.options.onOk.call(a)})},onOk:function(){var a=this.find("#kg-password"),b=a.val();b?(c.call(this,b),this.remove()):plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("in_pwd_msg","KG_MSG"),function(){a.focus()});return!1},content:function(){return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,[plus$$module$webapp$kinggrid$signature_all.template.passwordTpl])}})},getPassCheck:function(a,b,c){if(a&&1==a)return a;
if(void 0===c||!0===c||"auto"===c)try{return b.find("#kg-remenberPwd").is(":checked")}catch(d){}return!1},showSeals:function(a){var b=this,c={errorCall:a.errorCall,cancelCall:a.cancelCall,beginCancalCall:a.beginCancalCall,protectedItems:a.protectedItems,protectedItemsType:a.protectedItemsType,protectedItemsCheckedAll:void 0==a.protectedItemsCheckedAll?!0:a.protectedItemsCheckedAll,_onOk:function(c,d,e,f,m,p){var g=this,h=new plus$$module$webapp$kinggrid$signature_all.kgFont(null==g.fontSel?null==
b.signdate?{}:b.signdate:g.fontSel),k=g.isCheck;!1!==Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg&&b.autoDlg||!Signature$$module$webapp$kinggrid$signature_all.options.signdate||!Signature$$module$webapp$kinggrid$signature_all.options.signdate.ischeck||(k=Signature$$module$webapp$kinggrid$signature_all.options.signdate.ischeck);a.protectedItems=null==g.proItems?0==a.protectedItemsCheckedAll?[]:a.protectedItems:g.proItems;a.datetime={isCheck:k,fontDate:h};void 0!=f&&null!=f?
(a.signtime=f,void 0!=m&&null!=m?(a.showtime=(f+" ("+m.TimeExt+")").replace(/-/g,"/"),a.showtime+=kinggrid.msg("timestamp_time","KG_MSG"),a.timestampInfo=m):(a.showtime=(new Date(Date.parse(f.replace(/-/g,"/")))).toLocaleString(),a.showtime+=kinggrid.msg("server_time","KG_MSG"))):(a.signtime=void 0,a.showtime=(new Date).toLocaleString(),a.showtime+=kinggrid.msg("local_time","KG_MSG"));p=b.getPassCheck(p,g,Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg);void 0===Signature$$module$webapp$kinggrid$signature_all.options.valid||
null===Signature$$module$webapp$kinggrid$signature_all.options.valid||!1===Signature$$module$webapp$kinggrid$signature_all.options.valid?a.batchSignature?b.sealService.verifyPwd({pwd:d,usercode:void 0==a.usercode?"":a.usercode,keysn:b.keyData.keysn,successCall:function(e){if(e.result){for(e=0;e<a.batchSignature.length&&(a.batchSignature[e].signtime=a.signtime,a.batchSignature[e].showtime=a.showtime,null!=a.position&&(a.batchSignature[e].position=a.position),a.batchSignature[e].autoCert=a.autoCert,
a.batchSignature[e].okCall=a.okCall,a.batchSignature[e].cancelCall=a.cancelCall,a.batchSignature[e].beginCall=a.beginCall,a.batchSignature[e].endCall=a.endCall,null!=a.protectedItems&&(a.batchSignature[e].protectedItems=a.protectedItems),a.batchSignature[e].protectedItemsType=a.protectedItemsType,a.batchSignature[e].datetime=a.datetime,a.batchSignature[e].offsetX=a.offsetX,a.batchSignature[e].offsetY=a.offsetY,a.batchSignature[e].changeOffsetXY=a.changeOffsetXY,a.batchSignature[e].isBatchSignature=
!0,b.exec(a.batchSignature[e],function(c){c.result?void 0!==Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||!0===Signature$$module$webapp$kinggrid$signature_all.options.showNoPW?void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b):(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||b.autoDlg)&&b.trigger("execSuccess",g,d,p):b.errorCallback(c,a.errorCall)},c,
d,!0,a),void 0!==a.batchSignature[e].endCall&&a.batchSignature[e].endCall&&a.batchSignature[e].endCall.call(b),"client"!=Signature$$module$webapp$kinggrid$signature_all.options.sealType||!a.autoCert);++e);void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b);(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||b.autoDlg)&&g.remove()}else b.errorCallback(e,a.errorCall)}}):(b.exec(a,
function(c){c.result?(void 0!==Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||!0===Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield?void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b):(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||b.autoDlg)&&b.trigger("execSuccess",g,
d,p),g.remove()):b.errorCallback(c,a.errorCall,null,{_beginDlgOkCall:!0})},c,d),void 0!==a.endCall&&a.endCall&&a.endCall.call(b)):void 0!==b.curDate&&null!==b.curDate&&b.sealExpired(c,a,b.curDate,function(e){e?a.batchSignature?b.sealService.verifyPwd({pwd:d,keysn:b.keyData.keysn,successCall:function(e){if(e.result){for(e=0;e<a.batchSignature.length&&(a.batchSignature[e].signtime=a.signtime,a.batchSignature[e].showtime=a.showtime,null!=a.position&&(a.batchSignature[e].position=a.position),a.batchSignature[e].autoCert=
a.autoCert,a.batchSignature[e].okCall=a.okCall,a.batchSignature[e].cancelCall=a.cancelCall,a.batchSignature[e].beginCall=a.beginCall,a.batchSignature[e].endCall=a.endCall,null!=a.protectedItems&&(a.batchSignature[e].protectedItems=a.protectedItems),a.batchSignature[e].protectedItemsType=a.protectedItemsType,a.batchSignature[e].datetime=a.datetime,a.batchSignature[e].offsetX=a.offsetX,a.batchSignature[e].offsetY=a.offsetY,a.batchSignature[e].changeOffsetXY=a.changeOffsetXY,a.batchSignature[e].isBatchSignature=
!0,b.exec(a.batchSignature[e],function(c){c.result?void 0!==Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||!0===Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield?void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b):(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||b.autoDlg)&&
b.trigger("execSuccess",g,d,p):b.errorCallback(c,a.errorCall)},c,d,!0),void 0!==a.batchSignature[e].endCall&&a.batchSignature[e].endCall&&a.batchSignature[e].endCall.call(b),"client"!=Signature$$module$webapp$kinggrid$signature_all.options.sealType||!a.autoCert);++e);void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b);(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||b.autoDlg)&&
g.remove()}else b.errorCallback(e,a.errorCall)}}):(b.exec(a,function(c){c.result?(void 0!==Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||!0===Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield?void 0!==a.beginCancalCall&&a.beginCancalCall&&a.beginCancalCall.call(b):(void 0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||!0===Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg||
b.autoDlg)&&b.trigger("execSuccess",g,d,p),g.remove()):b.errorCallback(c,a.errorCall,null,{_beginDlgOkCall:!0})},c,d),void 0!==a.endCall&&a.endCall&&a.endCall.call(b)):b.errorCallback({errcode:"11103"},a.errorCall)},e)}};if(void 0!==Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg){var d=!0;if("auto"==Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg){var e=b.keyData;e.seals&&1==e.seals.length&&(d=!1)}b.autoDlg=d;if(!1!==Signature$$module$webapp$kinggrid$signature_all.options.showSealsDlg&&
d)this.showSealsDialog(c);else if(void 0===Signature$$module$webapp$kinggrid$signature_all.options.password&&void 0!==b.password&&(Signature$$module$webapp$kinggrid$signature_all.options.password=b.password),void 0===Signature$$module$webapp$kinggrid$signature_all.options.password)b.errorCallback({errcode:"11108"},a.errorCall);else if(void 0!=Signature$$module$webapp$kinggrid$signature_all.options.timestamp&&1==Signature$$module$webapp$kinggrid$signature_all.options.timestamp)if("client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType){var f=
kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);f.invoke("KGGetTSURLInfo").ret(function(d){d.result?f.invoke("KGGetTSWithDigest",d.TimeStampUrl,d.TimeStampUserName,d.TimeStampPassword,b.getSignTimeStamp(b.getProtectedData(a.protectedItems)),"").ret(function(d){d.result?c._onOk.call(b,b.keyData.seals[0],Signature$$module$webapp$kinggrid$signature_all.options.password,
0,d.TimeStr,d):(b.errorCallback(d,a.errorCall,"KGGetTSWithDigest"),c._onOk.call(b,e.seals[0],pwdVal,0))}):(b.errorCallback(d,a.errorCall,"KGGetTSURLInfo"),c._onOk.call(b,e.seals[0],pwdVal,0))})}else $$$module$webapp$kinggrid$signature_all.ajax({url:Signature$$module$webapp$kinggrid$signature_all.options.serverUrl+"_key_getTimeStamp",type:"POST",data:{keysn:b.keyData.keysn},async:!1,success:function(a){a.result?c._onOk.call(b,b.keyData.seals[0],Signature$$module$webapp$kinggrid$signature_all.options.password,
0,a.timestamp):c._onOk.call(b,b.keyData.seals[0],Signature$$module$webapp$kinggrid$signature_all.options.password,0)},error:function(a){c._onOk.call(b,b.keyData.seals[0],Signature$$module$webapp$kinggrid$signature_all.options.password,0)}});else c._onOk.call(b,b.keyData.seals[0],Signature$$module$webapp$kinggrid$signature_all.options.password,0)}else this.showSealsDialog(c)},showSealsDialog:function(a){var b=this,c=b.keyData;null!=b.signdate&&(c.signDateIsCheck=b.signdate.ischeck);var d=null!=a.protectedItemsType&&
"1"==a.protectedItemsType?a.protectedItems:b.getProtectedData(a.protectedItems);c.showProtectedBtn=d&&0<d.length&&Signature$$module$webapp$kinggrid$signature_all.options.showProtectedBtn;for(var e=a.protectedItemsCheckedAll,f=[],g=0;d&&g<d.length;g++)f[g]=d[g],f[g].isChecked=e;c.newProItems=f;var h=[c],k=a._onOk,l=a.beginCancalCall;d={onCancel:a.cancelCall,onShow:function(){var d=this,e=d.find(".kg-switcher");if(e.length){var f=new Utils$$module$webapp$kinggrid$signature_all.Switcher(e[0],b.switcher||
{});e.find(".arrow-right").click(function(a){a.preventDefault();f.swipeNext()});e.find(".arrow-left").click(function(a){a.preventDefault();f.swipePrev()});e.find(".kg-guide span").click(function(a){a.preventDefault();f.to(+this.getAttribute("index"))});b.switcher=f}d.find("#kg-dateSet").click(function(a){b.showFontDialog(d)});setTimeout(function(){d.find("#kg-password").focus()},40);b.trigger("showSealsDialog",d);Signature$$module$webapp$kinggrid$signature_all.options.showNoPW&&Signature$$module$webapp$kinggrid$signature_all.options.phoneshield||
b.trigger("showSealsDialog_PW",d);d.find("#kg-password").keydown(function(a){13==a.keyCode&&d.options.onOk.call(d)});d.find("#kg-protectedDataSet").click(function(e){b.showProtectedDataDialog(d,a,c)})},onOk:function(){var d=this,e=d.find("#kg-password"),f=e.val()||Signature$$module$webapp$kinggrid$signature_all.options.password;if(!Signature$$module$webapp$kinggrid$signature_all.options.phoneshield&&!f)return plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("in_pwd_msg","KG_MSG"),function(){setTimeout(function(){e.focus()},
100)}),!1;var g=d.find(".kg-wrapper .active");d.isCheck=d.find("#kg-addDate").is(":checked");var h=d.find("#kg-remenberPwd").is(":checked"),l=b.keyData.seals[g.attr("index")].SealTag||b.keyData.seals[g.attr("index")].sealtag;if("client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&l&&"GM"==l){var v=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);
l=b.keyData.seals[g.attr("index")].SealCert||b.keyData.seals[g.attr("index")].signercert;var E=b.keyData.seals[g.attr("index")].ValidStart||b.keyData.seals[g.attr("index")].validstart,x=b.keyData.seals[g.attr("index")].ValidEnd||b.keyData.seals[g.attr("index")].validend,y=b.keyData.seals[g.attr("index")].CertList||b.keyData.seals[g.attr("index")].certlist;v.invoke("KGValidate_GM","",l,E,x,y,"").ret(function(e){if(e.result)if(void 0!=Signature$$module$webapp$kinggrid$signature_all.options.timestamp&&
1==Signature$$module$webapp$kinggrid$signature_all.options.timestamp){var l=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);l.invoke("KGGetTSURLInfo").ret(function(e){e.result?l.invoke("KGGetTSWithDigest",e.TimeStampUrl,e.TimeStampUserName,e.TimeStampPassword,b.getSignTimeStamp(b.getProtectedData(a.protectedItems)),"").ret(function(e){e.result?
k.call(d,c.seals[g.attr("index")],f,g.attr("index"),e.TimeStr,e,h?!0:!1):(b.errorCallback(e,a.errorCall,"KGGetTSWithDigest"),k.call(d,c.seals[g.attr("index")],f,g.attr("index"),void 0,void 0,h?!0:!1))}):(b.errorCallback(e,a.errorCall,"KGGetTSWithDigest"),k.call(d,c.seals[g.attr("index")],f,g.attr("index"),void 0,void 0,h?!0:!1))})}else k.call(d,c.seals[g.attr("index")],f,g.attr("index"),void 0,void 0,h?!0:!1);else return b.errorCallback(e,a.errorCall,"KGValidate_GM"),!1})}else if("client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&
b.keyData.seals[g.attr("index")].sealtag&&"GB"==b.keyData.seals[g.attr("index")].sealtag){v=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);var z=b.keyData.seals[g.attr("index")];v.invoke("KGVerifyGBSealAction",z.sesealinfo,z.signsn).ret(function(c){if(c.result)b.keyData.gbOvalue=c.ovalue,k.call(d,z,f,g.attr("index"),void 0,void 0,
h?!0:!1);else return b.errorCallback(c,a.errorCall,"KGVerifyGBSealAction"),!1})}else return g=d.find(".kg-wrapper .active"),d.isCheck=d.find("#kg-addDate").is(":checked"),void 0!=Signature$$module$webapp$kinggrid$signature_all.options.timestamp&&1==Signature$$module$webapp$kinggrid$signature_all.options.timestamp?"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType?(v=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1",
"4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode),v.invoke("KGGetTSURLInfo").ret(function(e){e.result?v.invoke("KGGetTSWithDigest",e.TimeStampUrl,e.TimeStampUserName,e.TimeStampPassword,b.getSignTimeStamp(b.getProtectedData(a.protectedItems)),"").ret(function(e){e.result?k.call(d,c.seals[g.attr("index")],f,g.attr("index"),e.TimeStr,e):(b.errorCallback(e,a.errorCall,"KGGetTSWithDigest"),k.call(d,c.seals[g.attr("index")],f,g.attr("index")))}):
(b.errorCallback(e,a.errorCall,"KGGetTSURLInfo"),k.call(d,c.seals[g.attr("index")],f,g.attr("index")))})):$$$module$webapp$kinggrid$signature_all.ajax({url:Signature$$module$webapp$kinggrid$signature_all.options.serverUrl+"_key_getTimeStamp",type:"POST",data:{keysn:b.keyData.keysn},async:!1,success:function(a){a.result?k.call(d,c.seals[g.attr("index")],f,g.attr("index"),a.timestamp):k.call(d,c.seals[g.attr("index")],f,g.attr("index"))},error:function(a){k.call(d,c.seals[g.attr("index")],f,g.attr("index"))}}):
k.call(d,c.seals[g.attr("index")],f,g.attr("index")),!1},content:function(){h.push(b.toBase64Img);var a=[Signature$$module$webapp$kinggrid$signature_all.options.template.showSealsBtl].concat(h);if(Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield)a=[Signature$$module$webapp$kinggrid$signature_all.options.template.showSealsBtl_nopassword].concat(h);return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,
a)}};void 0!==l&&l&&(d=Utils$$module$webapp$kinggrid$signature_all.extend({onCancel:function(){void 0!==l&&l&&l.call(b);this.close()}},d));Signature$$module$webapp$kinggrid$signature_all.options.showNoPW||Signature$$module$webapp$kinggrid$signature_all.options.phoneshield?b.showDialog("showSealsBtl_nopassword",d):b.showDialog("showSealsBtl",d);Signature$$module$webapp$kinggrid$signature_all.options.showSignExpirePrompt&&null!=c.currenttime&&void 0!=c.currenttime&&null!=c.overdate&&void 0!=c.overdate&&
(d=new Date(c.currenttime),e=Math.floor(((new Date(c.overdate)).getTime()-d.getTime())/864E5),e<=c.hintdays&&0<=e&&(localStorage.getItem("lastAlertDate")&&null!=localStorage.getItem("lastAlertDate")&&""!=localStorage.getItem("lastAlertDate")?(f=localStorage.getItem("lastAlertDate"),f=new Date(f),0<d.getTime()-f.getTime()&&b.showExpirtDialog("\u5f53\u524d\u7528\u6237\u8fd8\u6709"+e+"\u5929\u8fc7\u671f\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\uff01",c.currenttime)):b.showExpirtDialog("\u5f53\u524d\u7528\u6237\u8fd8\u6709"+
e+"\u5929\u8fc7\u671f\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\uff01",c.currenttime)))},showProtectedDataDialog:function(a,b,c){var d=[{newProData:c.newProItems,proItemsCheckedAll:b.protectedItemsCheckedAll}],e={title:kinggrid.msg("ProtectedDataSet","KG_TITLE"),content:function(){d.push(Utils$$module$webapp$kinggrid$signature_all.html2Escape);var a=[Signature$$module$webapp$kinggrid$signature_all.options.template.protectedDataSetBtl].concat(d);return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,
a)},onOk:function(){for(var d=0;d<c.newProItems.length;d++)f.find("input[name='kg-proItem']").each(function(a,b){if(f.find("input[name='kg-proItem']")[a].checked&&$$$module$webapp$kinggrid$signature_all(this).val()==c.newProItems[d].field)return c.newProItems[d].isChecked=!0,!1;c.newProItems[d].isChecked=!1});var e=[];if(null!=b.protectedItemsType&&"1"==b.protectedItemsType)for(var k=0;k<c.newProItems.length;k++)c.newProItems[k].isChecked&&e.push(c.newProItems[k]);else for(k=0;k<c.newProItems.length;k++)c.newProItems[k].isChecked&&
e.push(c.newProItems[k].field);a.proItems=e}},f=plus$$module$webapp$kinggrid$signature_all.showDialog("protectedDataSetBtl",e);f.find("#kg-proData-items").on("click",function(a){"LABEL"==a.target.tagName&&f.find("#kg-selectedProData").text($$$module$webapp$kinggrid$signature_all(a.target).text().split("]")[1]);if("checkbox"==a.target.type)if($$$module$webapp$kinggrid$signature_all(a.target).is(":checked")){a=!0;for(var c=f.find("input[name='kg-proItem']"),d=0;d<c.length;d++)if(!c[d].checked){a=!1;
break}a&&(f.find("input[name='selectAll']")[0].checked=!0,b.protectedItemsCheckedAll=!0)}else f.find("input[name='selectAll']")[0].checked=!1,b.protectedItemsCheckedAll=!1});f.find("#kg-selectBox").on("click",function(a){if($$$module$webapp$kinggrid$signature_all(a.target).is(":checked")){b.protectedItemsCheckedAll=!0;a=f.find("input[name='kg-proItem']");for(var d=0;d<a.length;d++)a[d].checked=!0,c.newProItems[d].isChecked=!0}else for(b.protectedItemsCheckedAll=!1,a=f.find("input[name='kg-proItem']"),
d=0;d<a.length;d++)a[d].checked=!1,c.newProItems[d].isChecked=!1});return f},showFontDialog:function(a){var b=this,c=plus$$module$webapp$kinggrid$signature_all.dafaultDate,d=null==b.signdate?{}:b.signdate,e=plus$$module$webapp$kinggrid$signature_all.defaultFont;b=this;b=null==d.fontFormat?e.fontFormat:d.fontFormat;var f=null==d.fontFamily?e.fontFamily:d.fontFamily,g=null==d.fontSize?e.fontSize:d.fontSize,h=e.fontColor;null!=d.fontColor&&/^#([0-9a-fA-f]{6})$/.test(d.fontColor)&&(h=d.fontColor.toUpperCase());
d=null==d.position?e.position:d.position;null!=a.fontSel&&(b=a.fontSel.fontFormat,f=a.fontSel.fontFamily,g=a.fontSel.fontSize,h=a.fontSel.fontColor,d=plus$$module$webapp$kinggrid$signature_all.fontTemplate.position[a.fontSel.fontPositionIndex]);var k=this.getArrayPush(Signature$$module$webapp$kinggrid$signature_all.options.fontTemplate.fontFormat,b),l=[{fontFormat:this.getFormatDate(k,c),fontFamily:this.getArrayPush(Signature$$module$webapp$kinggrid$signature_all.options.fontTemplate.fontFamily,f),
fontSize:this.getArrayPush(Signature$$module$webapp$kinggrid$signature_all.options.fontTemplate.fontSize,g),fontColor:this.getArrayPush(Signature$$module$webapp$kinggrid$signature_all.options.fontTemplate.fontColor,h),fontPosition:Signature$$module$webapp$kinggrid$signature_all.options.fontTemplate.position,dFontFormat:kinggrid.Utils.formatDate(new Date(c),b),dFontFamily:f,dFontSize:g,dFontColor:h,dFontPosition:d}];c={title:kinggrid.msg("DateSet","KG_TITLE"),content:function(){var a=[Signature$$module$webapp$kinggrid$signature_all.options.template.dateSetBtl].concat(l);
return Utils$$module$webapp$kinggrid$signature_all.template.apply(null,a)},onOk:function(){var b=this.find("#kg-fontFormat").get(0).selectedIndex;a.fontSel={fontFormat:k[b],fontFamily:this.find("#kg-fontFamily").val(),fontSize:this.find("#kg-fontSize").val(),fontColor:kinggrid.Utils.colorHex(this.find("#kg-select-color").css("backgroundColor")),fontPositionIndex:this.find("#kg-fontPosition").get(0).selectedIndex}}};var m=plus$$module$webapp$kinggrid$signature_all.showDialog("dateSetBtl",c);m.find("#kg-select-color").on("click",
function(){"block"==m.find(".kg-color-div").css("display")?(m.find(".kg-color-div").css("display","none"),m.find("#kg-color-ul").css("display","none")):(m.find(".kg-color-div").css("display","block"),m.find("#kg-color-ul").css("display","block"))});m.find("#kg-color-ul li a").click(function(){m.find("#kg-select-color").css("backgroundColor",$$$module$webapp$kinggrid$signature_all(this).css("backgroundColor"));m.find(".kg-color-div").css("display","none");m.find("#kg-color-ul").css("display","none")});
m.find(".kg-color-div").on("mouseover",function(a){this.contains(a.fromElement||a.relatedTarget)||$$$module$webapp$kinggrid$signature_all(this).show()});m.find(".kg-color-div").on("mouseout",function(a){this.contains(a.toElement||a.relatedTarget)||$$$module$webapp$kinggrid$signature_all(this).hide()});return m},getArrayPush:function(a,b){-1==jQuery.inArray(b,a)&&a.push(b);return a},getFormatDate:function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=kinggrid.Utils.formatDate(new Date(b),a[d]);return c},
genId:function(){return now$$module$webapp$kinggrid$signature_all()+rand$$module$webapp$kinggrid$signature_all()},getSeal:function(a){return this.keyData.seals[a]},saveSignature:function(a,b,c,d){var e=this;void 0!=a&&void 0!=b&&void 0!=c&&(a=void 0!=Signature$$module$webapp$kinggrid$signature_all.options.cache_path&&null!=Signature$$module$webapp$kinggrid$signature_all.options.cache_path?{documentId:a,signatureId:b,signaturedata:c,cachepath:Signature$$module$webapp$kinggrid$signature_all.options.cache_path}:
{documentId:a,signatureId:b,signaturedata:c,cachepath:""},kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl).request("_signature_saveHtmlSignature",a).ret(function(a){void 0!==d&&null!==d&&d.call(e,a)}))},removeSignature:function(a,b,c){var d=this;void 0!=a&&void 0!=b&&(a={documentId:a,signatureId:b},kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl).request("_signature_reomveHtmlSignature",a).ret(function(a){void 0!==c&&null!==c&&c.call(d,
a)}))},getSaveSignatures:function(a,b,c){void 0!=a&&kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl).request("_signature_getHtmlSignature",{documentId:a}).ret(function(a){a.result?b(a.sign):c&&c(a.result)})},showExpirtDialog:function(a,b){plus$$module$webapp$kinggrid$signature_all.showDialog("showExpirtDialog",{content:'<div class="kg-dialog kg-dialog-runSignature" id="sealExpirt-dialog"><div class="kg-dialog-content">'+a+'</div><div ><input type="checkbox" name="noMorePrompts" id="kg-noMorePrompts">&nbsp;<label for="kg-noMorePrompts">\u4e0d\u518d\u63d0\u793a</label></div> </div>',
onOk:function(){this.find("#kg-noMorePrompts").is(":checked")&&localStorage.setItem("lastAlertDate",b)},onCancel:function(){}})}});
$$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.options,{certType:"client",sealType:"client",clientUrl:"http://127.0.0.1:9581",moveable:!0,signable:!0,fontTemplate:plus$$module$webapp$kinggrid$signature_all.fontTemplate,template:{showSealsBtl:plus$$module$webapp$kinggrid$signature_all.template.sealTpl,showSealsBtl_nopassword:plus$$module$webapp$kinggrid$signature_all.template.sealTpl_nopassword,signSignatureBtl:'<div id="kg-dialog-sign" class="kg-dialog kg-dialog-password kg-dialog-sign"><div class="kg-form"><div class="form-item clearfix"><label class="kg-sm kg-sm-3 kg-label">\u5bc6\u7801\uff1a</label><div class="kg-sm kg-sm-7"> <input type="password" name="kgpassword" autocomplete="new-password" id="kg-password" class="form-control"></div> </div></div></div>',
revokeSignatureBtl:'<div id="kg-verifyPass" class="kg-dialog  kg-dialog-password"><div class="kg-form"><div class="form-item clearfix"><label class="kg-sm kg-sm-3 kg-label">\u7b7e\u7ae0\uff1a</label><div class="kg-sm kg-sm-7"><p class="kg-form-static"><%this.signatureData.seal.signname%></p></div></div><div class="form-item clearfix"><label class="kg-sm kg-sm-3 kg-label">\u5bc6\u7801\uff1a</label><div class="kg-sm kg-sm-7"> <input type="password" name="kgpassword" autocomplete="new-password" id="kg-password" class="form-control"></div> </div></div></div>',
protectedDataSetBtl:'<div id="kg-setProData" class="kg-dialog "><div id="kg-pro-data" class="kg-sm-13 kg-dialog-proData "><% var newProData = this.newProData; %><% var isAllChecked = this.proItemsCheckedAll; %><div id="kg-proData-items" class="kg-dialog-proData-items"><% for(var i=0;i<newProData.length;i++){%><div class="kg-dialog-proData-item"><% var proId = "proItem"+i; %><% var filedd = newProData[i].desc && newProData[i].desc != "" ? newProData[i].desc : newProData[i].field; %><% var content = "[" + filedd+"]" + arguments[0](newProData[i].value); %><% if(newProData[i].isChecked){ %><input type="checkbox" checked name="kg-proItem" id="<% proId%>" value="<% newProData[i].field%>" class="kg-dialog-checkbox">&nbsp;<label class="kg-dialog-label" custom="pro-value"><% content%></label>&nbsp;<% } %><% else{ isAllChecked = false; %><input type="checkbox" name="kg-proItem" id="<% proId%>" value="<% newProData[i].field%>" class="kg-dialog-checkbox">&nbsp;<label class="kg-dialog-label"  custom="pro-value"><% content%></label>&nbsp;<% } %></div><%}%></div><div class="kg-dialog-line"></div><div class="kg-dialog-proData-selProData"><label id="kg-selectedProData" class="kg-selProData"></label></div></div><div ><% if(isAllChecked){ %><input type="checkbox" checked  name="selectAll" id="kg-selectBox"  class="kg-dialog-checkbox">&nbsp;<label class="kg-dialog-label" for="kg-selectBox" custom="pro-value">\u5168\u90e8\u9009\u4e2d</label>&nbsp;<% } else{ %><input type="checkbox"  name="selectAll" id="kg-selectBox"  class="kg-dialog-checkbox">&nbsp;<label class="kg-dialog-label" for="kg-selectBox" custom="pro-value">\u5168\u90e8\u9009\u4e2d</label>&nbsp;<% } %></div></div>',
dateSetBtl:'<div id="kg-setDate" class="kg-dialog kg-dialog-Date"><div class="kg-form"><div class="form-item clearfix"><label class="kg-sm kg-sm-4 kg-label">\u683c\u5f0f\uff1a</label><div class="kg-sm kg-sm-6"><select name="fontFormat" id="kg-fontFormat" class="kg-select kg-fontFormat"><% var fontFormat = this.fontFormat; %><% for(var i=0;i<fontFormat.length;i++) {%><% if(fontFormat[i] == this.dFontFormat){%><option class="kg-option" value="<% fontFormat[i]%>" selected><% fontFormat[i]%></option><%}else{%><option class="kg-option" value="<% fontFormat[i]%>"><% fontFormat[i]%></option><%}%><%}%></select></div></div><div class="form-item clearfix"><label class="kg-sm kg-sm-4 kg-label">\u5b57\u4f53\uff1a</label><div class="kg-sm kg-sm-6"><select name="fontFamily" id="kg-fontFamily" class="kg-select kg-fontFamily"><% var fontFamily = this.fontFamily; %><% for(var i=0;i<fontFamily.length;i++) {%><% if(fontFamily[i] == this.dFontFamily){%><option class="kg-option" value="<% fontFamily[i]%>" selected><% fontFamily[i]%></option><%}else{%><option class="kg-option" value="<% fontFamily[i]%>"><% fontFamily[i]%></option><%}%><%}%></select></div> </div><div class="form-item clearfix"><label class="kg-sm kg-sm-4 kg-label">\u5c3a\u5bf8\uff1a</label><div class="kg-sm kg-sm-6"><select name="fontSize" id="kg-fontSize" class="kg-select kg-fontSize"><% var fontSize = this.fontSize; %><% for(var i=0;i<fontSize.length;i++) {%><% if(fontSize[i] == this.dFontSize){%><option class="kg-option" value="<% fontSize[i]%>" selected><% fontSize[i]%></option><%}else{%><option class="kg-option" value="<% fontSize[i]%>"><% fontSize[i]%></option><%}%><%}%></select></div> </div><div class="form-item clearfix"><label class="kg-sm kg-sm-4 kg-label">\u989c\u8272\uff1a</label><div class="kg-sm kg-sm-6"><% var fontColor = this.fontColor; %><div id="kg-select-color" class="kg-select-color" style="background-color:<% this.dFontColor%>"/><div class="kg-color-div"><ul class="kg-color-ul" id="kg-color-ul"><% for(var i=0;i<fontColor.length;i++){ %><li class="kg-color-li"><a href="javascript:;" style="background-color:<% fontColor[i]%>"></a></li><%}%></ul></div></div></div><div class="form-item clearfix"><label class="kg-sm kg-sm-4 kg-label">\u4f4d\u7f6e\uff1a</label><div class="kg-sm kg-sm-6"><select name="fontPosition" id="kg-fontPosition" class="kg-select kg-fontPosition"><% var fontPosition = this.fontPosition; %><% for(var i=0;i<fontPosition.length;i++) {%><% if(fontPosition[i] == this.dFontPosition){%><option class="kg-option" value="<% fontPosition[i]%>" selected><% fontPosition[i]%></option><%}else{%><option class="kg-option" value="<% fontPosition[i]%>"><% fontPosition[i]%></option><%}%><%}%></select></div> </div></div></div>'}});
Signature$$module$webapp$kinggrid$signature_all.list={};Signature$$module$webapp$kinggrid$signature_all.updateList=[];Signature$$module$webapp$kinggrid$signature_all.removeList=[];
function formartSignatureData$$module$webapp$kinggrid$signature_all(a,b,c){var d=[],e={};for(k in a){var f={},g=a[k];Utils$$module$webapp$kinggrid$signature_all.is("String",g)&&0!=g.indexOf("ey")?(f["b64_"+k]=a[k],d.push(f)):e[k]=g}var h=[];(function(a){for(var b in a)h.push((new Signature$$module$webapp$kinggrid$signature_all(b,a[b])).load(Signature$$module$webapp$kinggrid$signature_all.options))})(e);if(a=d.length){e=Signature$$module$webapp$kinggrid$signature_all.options.signSize||5;var k=Math.ceil(a/
e);for(f=1;f<=k;f++){g=e*(f-1);var l=e*f>a?a:e*f;aisleKing$$module$webapp$kinggrid$signature_all=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl);aisleKing$$module$webapp$kinggrid$signature_all.request(Signature$$module$webapp$kinggrid$signature_all.options.b64Url,d.slice(g,l)).ret(function(a){if(a.result)for(var b in a){if(0==b.indexOf("b64_")){var c=a[b];Utils$$module$webapp$kinggrid$signature_all.is("String",c)&&(c=JSON.parse(c));h.push((new Signature$$module$webapp$kinggrid$signature_all(b.substring(4),
c)).load(Signature$$module$webapp$kinggrid$signature_all.options))}}else Signature$$module$webapp$kinggrid$signature_all.prototype.error.call(null,a)})}}aisleKing$$module$webapp$kinggrid$signature_all.fin(function(a,d,e){b&&b(1==h.length?h[0]:h);c&&c()})}
Signature$$module$webapp$kinggrid$signature_all.loadSignature=function(a,b,c,d){var e={};void 0==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra={});e[a]=b;void 0!==e.extra&&null!==e.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra[e.signatureid]=e.extra);formartSignatureData$$module$webapp$kinggrid$signature_all(e,c||function(a){Signature$$module$webapp$kinggrid$signature_all.verify()},d)};
Signature$$module$webapp$kinggrid$signature_all.loadSignatures=function(a,b,c){var d={};void 0==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra={});if(Utils$$module$webapp$kinggrid$signature_all.is("Array",a))for(var e=0;e<a.length;e++){var f=a[e];d[f.signatureid]=f.signatureData;void 0!==f.extra&&null!==f.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra[f.signatureid]=f.extra)}else for(e in a)d[e]=
a[e];formartSignatureData$$module$webapp$kinggrid$signature_all(d,b||function(){Signature$$module$webapp$kinggrid$signature_all.verify()},c)};
Signature$$module$webapp$kinggrid$signature_all.resetSignaturePos=function(a){void 0==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra={});if(Utils$$module$webapp$kinggrid$signature_all.is("Array",a))for(var b=0;b<a.length;b++){var c=a[b];void 0!==c.extra&&null!==c.extra&&(Signature$$module$webapp$kinggrid$signature_all.options.extra[c.signatureid]=c.extra)}else for(b in a)Signature$$module$webapp$kinggrid$signature_all.options.extra[b]=
a[b]};Signature$$module$webapp$kinggrid$signature_all.clearRPW=function(){delCookie$$module$webapp$kinggrid$signature_all("ksn");delCookie$$module$webapp$kinggrid$signature_all("pwd");delCookie$$module$webapp$kinggrid$signature_all("ck")};var globalLisenter$$module$webapp$kinggrid$signature_all=new Listener$$module$webapp$kinggrid$signature_all("Signature");Signature$$module$webapp$kinggrid$signature_all.addLiseter=function(a,b){globalLisenter$$module$webapp$kinggrid$signature_all.on(a,b)};
Signature$$module$webapp$kinggrid$signature_all.verify=function(){var a=Signature$$module$webapp$kinggrid$signature_all.list,b=[];globalLisenter$$module$webapp$kinggrid$signature_all.trigger("beforeVerify",d);for(var c in a){var d=a[c];d._verify(null,{batchVerify:!0})||b.push(d);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("eachVerify",d)}globalLisenter$$module$webapp$kinggrid$signature_all.trigger("verify",d);return b};
Signature$$module$webapp$kinggrid$signature_all.verifySignByList=function(a){var b=[];globalLisenter$$module$webapp$kinggrid$signature_all.trigger("beforeVerify",d);for(var c in a){var d=a[c],e=d._verify(null,{batchVerify:!0}),f=d.signatureData,g={};g.appname=f.appname;g.documentid=f.documentid;g.documentname=f.documentname;g.keysn=f.keysn;g.orgname=f.orgname;g.timestamp=f.timestamp;g.usercode=f.usercode;g.username=f.username;g.signname=f.seal.signname;g.signsn=f.seal.signsn;e||(g.modifiedItems=d.modifiedItems);
b.push(g);globalLisenter$$module$webapp$kinggrid$signature_all.trigger("eachVerify",d)}globalLisenter$$module$webapp$kinggrid$signature_all.trigger("verify",d);return b};Signature$$module$webapp$kinggrid$signature_all.bind=function(a){Utils$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.asyn,a)};Signature$$module$webapp$kinggrid$signature_all.show=function(){var a=Signature$$module$webapp$kinggrid$signature_all.list,b;for(b in a)a[b].show()};
Signature$$module$webapp$kinggrid$signature_all.hide=function(){var a=Signature$$module$webapp$kinggrid$signature_all.list,b;for(b in a)a[b].hide()};
Signature$$module$webapp$kinggrid$signature_all.AXI=function(a,b,c){Signature$$module$webapp$kinggrid$signature_all.authcode=f;var d=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode),e;for(e in b){var f=b[e];""!==e&&""!==f?d.invoke(a,e,f):null!==e&&""!==e?d.invoke(a,e):d.invoke(a)}d.ret(function(a){a.result&&(Signature$$module$webapp$kinggrid$signature_all.options.moveable_self?
(Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&d.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone),d.invoke("KGGetKeyOtherInfo","0").ret(function(b){b.result&&(b=b.Res.substring(1,b.Res.length-1),Signature$$module$webapp$kinggrid$signature_all.options.keysn=b);void 0!==c&&null!==c&&c(a)})):void 0!==c&&null!==c&&c(a))});return d};
Signature$$module$webapp$kinggrid$signature_all.showAndHideBySignatureId=function(a,b){var c=Signature$$module$webapp$kinggrid$signature_all.list,d;for(d in c)0<=d.indexOf(a)&&(b?c[d].show():c[d].hide())};Signature$$module$webapp$kinggrid$signature_all.addIcon=function(a){var b=Signature$$module$webapp$kinggrid$signature_all.options.icons||[];b.push(a);Signature$$module$webapp$kinggrid$signature_all.options.icons=b};
Signature$$module$webapp$kinggrid$signature_all.create=function(a){var b=$$$module$webapp$kinggrid$signature_all.extend({},Signature$$module$webapp$kinggrid$signature_all.options,a);void 0!==a&&void 0!==a.imgtag&&(Signature$$module$webapp$kinggrid$signature_all.options.imgtag=a.imgtag);return new Signature$$module$webapp$kinggrid$signature_all._create(b)};$$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.prototype,{saveSignatures:function(){},getSignatures:function(){}});
var ClientSeal$$module$webapp$kinggrid$signature_all=function(a){var b=this;$$$module$webapp$kinggrid$signature_all.each(a,function(a,d){if("function"===typeof b[a])b[a](d);else b[a]=d})};Utils$$module$webapp$kinggrid$signature_all.inherit(ClientSeal$$module$webapp$kinggrid$signature_all,Signature$$module$webapp$kinggrid$signature_all.SealService);
var ClientCert$$module$webapp$kinggrid$signature_all=function(a){var b=this;$$$module$webapp$kinggrid$signature_all.each(a,function(a,d){if("function"===typeof b[a])b[a](d);else b[a]=d})};Utils$$module$webapp$kinggrid$signature_all.inherit(ClientCert$$module$webapp$kinggrid$signature_all,Signature$$module$webapp$kinggrid$signature_all.CertService);
$$$module$webapp$kinggrid$signature_all.extend(ClientSeal$$module$webapp$kinggrid$signature_all.prototype,{saveLog:function(a){var b=[];Utils$$module$webapp$kinggrid$signature_all.is("Object",a)?b.push(a):b=a;a=stringify$$module$webapp$kinggrid$signature_all({MSG:b});kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode).invoke("SetParamByName",
"SAVEMSG",a)},loadSeal:function(a){var b=this,c=a.successCall,d=a.errorCall,e=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);b.appcode?e.invoke("SetParamByName","APPCODE",b.appcode):b.appcode="";Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&e.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone);
e.invoke("KGGetKeyInfo").ret(function(e){if(e.result){Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&localStorage.setItem("fjrsToken",e.fjrs_token);Signature$$module$webapp$kinggrid$signature_all.options.phoneshield=!e.phoneshield||"1"!=e.phoneshield&&"3"!=e.phoneshield?!1:!0;Signature$$module$webapp$kinggrid$signature_all.options.phoneshield&&(kinggrid.options.timeout=1E3*(e.validatetime+10));if(""==e.seals)if(null!=a.data)e.seals={},e.seals[0]={signname:"",width:"",signsn:null,
height:"",imgdata:"",imgext:".png"};else{d.call(b,{result:!1,errcode:"11"});return}else if(void 0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&null!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag){var f=[],h;for(h in e.seals){var k=e.seals[h];void 0!==k&&parseInt(k.imgtag)==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&(void 0!=e.fjrs_sealname?e.fjrs_sealname==e.seals[h].signname&&
(f[f.length]=e.seals[h]):f[f.length]=e.seals[h])}e.seals=f}c.call(b,e)}else d.call(b,e)})},verifyPwd:function(a){var b=this,c=a.pwd,d=a.phoneshield?"1":"0",e=a.successCall;null==c&&(c="");var f=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);f.invoke("SetParamByName","ISPHONE",d);Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&
(f.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone),f.invoke("SetParamByName","FJRSDELKEYSN",a.keysn));f.invoke("KGVerifyPin",c,a.keysn).ret(function(a){e.call(b,a)})},getKeysn:function(a,b){a=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&
(a.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone),a.invoke("SetParamByName","FJRSTOKEN",localStorage.getItem("fjrsToken")));a.invoke("KGGetKeyOtherInfo","0").ret(function(a){a.result?(a=a.Res.substring(1,a.Res.length-1),b(a)):plus$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg(a.errcode,"then"),function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall.call()},
function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call()})})},getPhoneShieldLic:function(a,b){a=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&a.invoke("SetParamByName",
"FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone);a.invoke("KGPhoneShieldLic").ret(function(a){b(a)})}});
$$$module$webapp$kinggrid$signature_all.extend(ClientCert$$module$webapp$kinggrid$signature_all.prototype,{verifySign:function(a){var b=this,c=a.successCall,d=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode);a.seal&&a.seal.sealtag&&"GB"==a.seal.sealtag&&d.invoke("SetParamByName","GBSIGNSN",a.seal.signsn);Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&
d.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone);d.invoke("KGVerifySignMessage","123456",a.signdata,a.signeddata).ret(function(e){var f=e.result||"-8"!==e.errcode?e:{result:!1};f.result&&a.seal&&"GB"==a.seal.sealtag?d.invoke("KGVerifyGBStampAction",a.signeddata).ret(function(a){a.result||(f={result:!1});c.call(b,f)}):c.call(b,f)});a.seal&&a.seal.sealtag&&"GB"==a.seal.sealtag&&d.invoke("SetParamByName","GBSIGNSN","")},parseDate:function(a){var b=
new Date;b.setFullYear(a.substring(0,4),+a.substring(4,6)-1,a.substring(6,8));b.setHours(a.substring(8,10),a.substring(10,12),a.substring(12,14),0);return b.getTime()},sign:function(a){var b=this,c=a.successCall,d=a.signMeta,e=[],f=[],g=a.seal,h=a.phoneshield?"1":"0";a=a.password;null==a&&(a="");for(var k=0;k<d.length;k++){var l=d[k];e.push(l.signdata);f.push(""+l.signdata.length)}d=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",
Signature$$module$webapp$kinggrid$signature_all.options.clientCode);d.invoke("SetParamByName","ISPHONE",h);g&&g.sealtag&&("GB"==g.sealtag&&(h=g.sesealinfo,d.invoke("SetParamByName","CLEARGBSESEALINFO",""),d.invoke("SetParamByName","GBSESEALINFO",h),d.invoke("SetParamByName","GBSIGNSN",g.signsn)),"GM"==g.sealtag&&d.invoke("SetParamByName","ISGM","1"));Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&(d.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone),
d.invoke("SetParamByName","FJRSTOKEN",localStorage.getItem("fjrsToken")));d.invoke("KGCrySignMessage",a,e.join(";"),+f[0]).ret(function(a){a=$$$module$webapp$kinggrid$signature_all.extend({},a);a.result&&(a.certinfo.notAfter=b.parseDate(a.certinfo.notAfter),a.certinfo.notBefore=b.parseDate(a.certinfo.notBefore));c.call(b,a)});g&&g.sealtag&&"GB"==g.sealtag&&(d.invoke("SetParamByName","CLEARGBSESEALINFO",""),d.invoke("SetParamByName","GBSIGNSN",""))}});
Signature$$module$webapp$kinggrid$signature_all.addProvider("cert","client",ClientCert$$module$webapp$kinggrid$signature_all);Signature$$module$webapp$kinggrid$signature_all.addProvider("seal","client",ClientSeal$$module$webapp$kinggrid$signature_all);var ServerSeal$$module$webapp$kinggrid$signature_all=function(a,b){var c=this;c.sData=b;$$$module$webapp$kinggrid$signature_all.each(a,function(a,b){if("function"===typeof c[a])c[a](b);else c[a]=b})};
Utils$$module$webapp$kinggrid$signature_all.inherit(ServerSeal$$module$webapp$kinggrid$signature_all,Signature$$module$webapp$kinggrid$signature_all.SealService);var ServerCert$$module$webapp$kinggrid$signature_all=function(a,b){var c=this;c.sData=b;$$$module$webapp$kinggrid$signature_all.each(a,function(a,b){if("function"===typeof c[a])c[a](b);else c[a]=b})};Utils$$module$webapp$kinggrid$signature_all.inherit(ServerCert$$module$webapp$kinggrid$signature_all,Signature$$module$webapp$kinggrid$signature_all.CertService);
$$$module$webapp$kinggrid$signature_all.extend(ServerSeal$$module$webapp$kinggrid$signature_all.prototype,{getSealsUrl:"_key_load",verifyPwdUrl:"_key_verify",saveLogUrl:"_signature_saveLog",saveLog:function(a){a=stringify$$module$webapp$kinggrid$signature_all(a);kinggrid.surry(this.serverUrl).request(this.saveLogUrl,{loginfo:a}).ret(function(a){a.result||Signature$$module$webapp$kinggrid$signature_all.prototype.error.call(null,a)})},getPwdSaveTime:function(a,b){kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl).request("_signature_getPwdSaveTime").ret(function(c){a(c.result?
c.pwdTime:b)})},loadSeal:function(a){var b=this,c=a.successCall,d=a.errorCall,e={usercode:b.usercode,keysn:b.keysn,signname:b.signname,authcode:b.authcode,password:Signature$$module$webapp$kinggrid$signature_all.options.password,sealTag:Signature$$module$webapp$kinggrid$signature_all.options.sealTag,certContext:Signature$$module$webapp$kinggrid$signature_all.options.cert};kinggrid.surry(b.serverUrl).request(b.getSealsUrl,e).ret(function(e){if(e.result){if(""==e.seals)if(null!=a.data)e.seals={},e.seals[0]=
{signname:"",width:"",signsn:null,height:"",imgdata:"",imgext:".png"};else{d.call(b,{result:!1,errcode:"11101"});return}else if(void 0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&null!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&0!==Signature$$module$webapp$kinggrid$signature_all.options.imgtag){var f=[],h;for(h in e.seals){var k=e.seals[h];void 0!==k&&parseInt(k.imgtag)==Signature$$module$webapp$kinggrid$signature_all.options.imgtag&&(f[f.length]=e.seals[h])}e.seals=
f}c.call(b,e)}else d.call(b,e)})},verifyPwd:function(a){var b=this,c=a.successCall;a={usercode:void 0==b.sData?a.usercode:b.sData.usercode,keysn:void 0==b.sData?a.keysn:b.sData.keysn,password:a.pwd};kinggrid.surry(b.serverUrl).request(b.verifyPwdUrl,a).ret(function(a){c.call(b,a)})}});
$$$module$webapp$kinggrid$signature_all.extend(ServerCert$$module$webapp$kinggrid$signature_all.prototype,{signUrl:"_sign",verifySignUrl:"_sign_verify",verifySign:function(a){var b=this,c=b.sData,d=a.successCall;kinggrid.surry(b.serverUrl).request(b.verifySignUrl,{certType:c.certType,isUTF8:c.isUTF8,signsn:c.seal.signsn,html2sign:c.signMeta.html2sign,keysn:c.keysn,signdata:a.signdata,signeddata:c.signMeta.signeddata,crtdata:c.signMeta.certinfo.crtdata,sealTag:c.seal.sealTag}).ret(function(a){d.call(b,
a)})},sign:function(a){for(var b=this,c=a.signMeta,d=a.successCall,e=[],f=0;f<c.length;f++){var g=c[f];"GM"==b.sealTag&&(g.hashAlg="SM3",g.encryptAlg="SM2");e.push("$"+(g.hashAlg||b.hashAlg)+"|"+(g.encryptAlg||b.encryptAlg)+"$"+g.signdata)}a={keysn:a.keysn,password:a.password,signdata:e.join(";"),signsn:a.signsn,sealTag:b.sealTag};kinggrid.surry(b.serverUrl).request(b.signUrl,a).ret(function(a){a.result&&(a.certinfo.algName=a.certinfo.algName.replace("with",""));d.call(b,a)})}});
Signature$$module$webapp$kinggrid$signature_all.addProvider("cert","server",ServerCert$$module$webapp$kinggrid$signature_all);Signature$$module$webapp$kinggrid$signature_all.addProvider("seal","server",ServerSeal$$module$webapp$kinggrid$signature_all);Signature$$module$webapp$kinggrid$signature_all.alert=plus$$module$webapp$kinggrid$signature_all.alert;var version$$module$webapp$kinggrid$signature_all=Signature$$module$webapp$kinggrid$signature_all.version={name:"1.0.20",code:100};
root$$module$webapp$kinggrid$signature_all.Signature=Signature$$module$webapp$kinggrid$signature_all;"use strict";isIE8$$module$webapp$kinggrid$signature_all=!1;root$$module$webapp$kinggrid$signature_all.JSON&&(isIE8$$module$webapp$kinggrid$signature_all='{"x":"\u4e2d"}'!==root$$module$webapp$kinggrid$signature_all.JSON.stringify({x:"\u4e2d"}));Utils$$module$webapp$kinggrid$signature_all=kinggrid.Utils;var options$$module$webapp$kinggrid$signature_all=Signature$$module$webapp$kinggrid$signature_all.options;
Utils$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.options.template,{signInfoBtl:'<div class="kg-dialog kg-dialog-info kg-dialog-signedinfo" id="kg-signedinfo"><%var modified = this.signModified;%><%var timeVerify = this.timeVerify;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u9a8c\u8bc1\u6b63\u5e38\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u88ab\u7be1\u6539\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class="active"><a href="#" kg-target="certinfo">\u8bc1\u4e66\u4fe1\u606f</a></li></ul><%var certinfo = this.signatureData.signMeta.certinfo; %><div class="kg-tab-content"><div class="kg-tab-pane active certinfo"><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u7248\u672c\uff1a</label><span class="kg-value">V<%certinfo.version%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5e8f\u53f7\uff1a</label><span class="kg-value"><%certinfo.serialNumber%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u540d\u7b97\u6cd5\uff1a</label><span class="kg-value"><%certinfo.algName%></span></div><div class="clearfix kg-item "><label class="kg-label">\u9881\u53d1\u8005\uff1a</label><span class="kg-value"><%certinfo.issuerDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u4f7f\u7528\u8005\uff1a</label><span class="kg-value"><%certinfo.subjectDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6709\u6548\u671f\u4ece\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notBefore) , "yyyy-MM-dd hh:mm:ss")%></span></div><div class="clearfix kg-item "><label class="kg-label">\u81f3\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notAfter) , "yyyy-MM-dd hh:mm:ss")%></span></div></div></div></div></div></div></div>',
signatureInfoBtl:'<div class="kg-dialog kg-dialog-info" id="kg-sigantureinfo"><%var modified = this.modified;%><%var timeVerify = this.timeVerify;%><%var sealType = Signature.options.sealType;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u6b63\u5e38\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u88ab\u7be1\u6539\uff01</span><%if(timeVerify!=null){%><span class="timestamp <%timeVerify==true?"green":"red"%>"><%timeVerify==true?"(\u65f6\u95f4\u6233\u53ef\u4fe1\u4efb)":"(\u65f6\u95f4\u6233\u4e0d\u53ef\u4fe1\u4efb)"%></span><%}%></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class=" <% modified?"":"active"%> "><a href="#" kg-target="signatureinfo">\u7b7e\u7ae0\u4fe1\u606f</a></li><%if(modified){%><li class=" <% modified?"active":""%> " ><a href="#" kg-target="modifieditems">\u7be1\u6539\u4fe1\u606f</a></li><%}%></ul><div class="kg-tab-content"><div class="kg-tab-pane <% modified?"":"active"%> signatureinfo"><% var SDATA = this.signatureData; %><% var modifiedItems = this.modifiedItems; %><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u5e94\u7528\u7a0b\u5e8f\uff1a</label><span class="kg-value"><%timeVerify%><%SDATA.appname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6388\u6743\u5355\u4f4d\uff1a</label><span class="kg-value"><%SDATA.orgname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7528\u6237\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.username%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5bc6\u94a5\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.keysn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.seal.signname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.seal.signsn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u65e5\u671f\uff1a</label><span class="kg-value"><%SDATA.timestamp.signtime%></span></div><%if(sealType == "client" && SDATA.seal.headinfoex){%><div class="clearfix kg-item "><label class="kg-label">\u5236\u7ae0\u4eba\u540d\uff1a</label><span class="kg-value"><%SDATA.seal.headinfoex.sealProducer%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5236\u7ae0\u65e5\u671f\uff1a</label><span class="kg-value"><%SDATA.seal.headinfoex.sealMakingTime%></span></div><%}%></div></div><%if(modified){%><%var modifiedItems = this.modifiedItems;%><% for(var i=0;i<modifiedItems.length;i++) {%><% var item = modifiedItems[i]; %><div class="kg-tab-pane modifieditems <% modified?"active":""%> "><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label" kg-field="<%item.field%>"><%item.desc%>\u7531\uff1a</label><span class="kg-value"><%this["_renderValue"](this["html2Escape"](item.orivalue)) %></span></div><div class="clearfix kg-item "><label class="kg-label">\u66f4\u6539\u4e3a\uff1a</label><span class="kg-value"><%this["_renderValue"](this["html2Escape"](item.newvalue))%></span></div></div></div><%}%><%}%></div></div></div></div>',
handwritedlg:'<div class="kg-dialog kg-dialog-info" style="width:<%this.canvasWidth%>px;" id="kg-handwrite" unselectable="on" onselectstart="return false;" style="-moz-user-select:none;">\u540d\u79f0:<input type="text" value="\u624b\u5199\u7b7e\u540d" id="nameid" />&nbsp;&nbsp;&nbsp;\u989c\u8272:<select id="hw_color"><option value="black">\u9ed1</option><option value="red">\u7ea2</option><option value="blue">\u84dd</option><option value="green">\u7eff</option></select>&nbsp;&nbsp;&nbsp;\u7b14\u5bbd:<select id="hw_width"><option value="1">1</option><option value="2" selected>2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option></select><canvas id="canvasId" width=<% this.canvasWidth%> height=<% this.canvasHeight%>></canvas><br /><div id="div-judge" style="display: block" align="center"><button type="button" id="clearid" class="kg-button">\u6e05\u9664</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" id="okid" class="kg-button">\u7b7e\u540d</button></div></div>',
barcodedlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><label class="kg-label">\u4e8c\u7ef4\u7801\u5185\u5bb9\uff1a</label><textarea id="bcId"></textarea><br /><div id="output"><br /></div><div id="div-judge" style="display: block"><button type="button" id="bc_clearid" class="kg-button">\u6e05\u9664</button><button type="button" id="bc_okid" class="kg-button">\u786e\u5b9a</button></div></div>',scanBCdlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><div id="support"></div> <div id="contentHolder"><video id="video" width="320" height="320" autoplay></video><canvas style="display:none; background-color:#F00;" id="canvas_scanBC" width="320" height="320"></canvas> <br/> </div></div>'});
plus$$module$webapp$kinggrid$signature_all=kingPlus$$module$webapp$kinggrid$signature_all();var _borken$$module$webapp$kinggrid$signature_all,_borkenReq$$module$webapp$kinggrid$signature_all;
Signature$$module$webapp$kinggrid$signature_all.addLiseter("init",function(){aisleKing$$module$webapp$kinggrid$signature_all=Signature$$module$webapp$kinggrid$signature_all.aisleKing;for(var a=Signature$$module$webapp$kinggrid$signature_all.options.icons,b=0;b<a.length;++b){var c=a[b];switch(c.iconClass){case "kg-icon-move-":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_move_donot&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_move_donot&&(c.enable=!1);break;
case "kg-icon-move":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_move&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_move&&(c.enable=!1);break;case "kg-icon-remove":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_remove&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_remove&&(c.enable=!1);break;case "kg-icon-sign":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_sign&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_sign&&
(c.enable=!1);break;case "kg-icon-signverify":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_signverify&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_signverify&&(c.enable=!1);break;case "kg-icon-sealinfo":null!=Signature$$module$webapp$kinggrid$signature_all.options.icon_sealinfo&&0==Signature$$module$webapp$kinggrid$signature_all.options.icon_sealinfo&&(c.enable=!1)}}});
Signature$$module$webapp$kinggrid$signature_all.addLiseter("beforeVerify",function(){_borken$$module$webapp$kinggrid$signature_all=[];_borkenReq$$module$webapp$kinggrid$signature_all={signsn:[],sealImg:[]}});Signature$$module$webapp$kinggrid$signature_all.addLiseter("eachVerify",function(a){a.broken&&(_borken$$module$webapp$kinggrid$signature_all.push(a),_borkenReq$$module$webapp$kinggrid$signature_all.signsn.push(a.signatureData.seal.signsn),_borkenReq$$module$webapp$kinggrid$signature_all.sealImg.push(a.signatureData.seal.imgdata))});
Signature$$module$webapp$kinggrid$signature_all.addLiseter("startMove",function(a,b,c){"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&Signature$$module$webapp$kinggrid$signature_all.options.moveable_self&&(b=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode),Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone&&
(b.invoke("SetParamByName","FJRSISPHONE",Signature$$module$webapp$kinggrid$signature_all.options.fjrsIsphone),b.invoke("SetParamByName","FJRSTOKEN",localStorage.getItem("fjrsToken"))),b.invoke("KGGetKeyOtherInfo","0").ret(function(b){b.result?(b=b.Res.substring(1,b.Res.length-1),a.keysn=b,a.keysn!=a.signatureData.keysn&&Signature$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("cannot_move","KG_MSG"))):Signature$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg(b.errcode,"then"))}))});
Signature$$module$webapp$kinggrid$signature_all.addLiseter("verify",function(){});var resizeSeal$$module$webapp$kinggrid$signature_all={},resizeTime$$module$webapp$kinggrid$signature_all;
$$$module$webapp$kinggrid$signature_all(window).resize(function(){resizeTime$$module$webapp$kinggrid$signature_all&&clearTimeout(resizeTime$$module$webapp$kinggrid$signature_all);resizeTime$$module$webapp$kinggrid$signature_all=setTimeout(function(){for(var a in resizeSeal$$module$webapp$kinggrid$signature_all){var b=$$$module$webapp$kinggrid$signature_all(resizeSeal$$module$webapp$kinggrid$signature_all[a]),c=$$$module$webapp$kinggrid$signature_all(Utils$$module$webapp$kinggrid$signature_all.$(b.attr("elemid")));
Signature$$module$webapp$kinggrid$signature_all.prototype.calSealPos.call(null,c,b)}},200)});
Utils$$module$webapp$kinggrid$signature_all.extend(Signature$$module$webapp$kinggrid$signature_all.prototype,{_init:function(){var a=this;a.on("showAt",function(a){Utils$$module$webapp$kinggrid$signature_all.$(a.getAttribute("elemid")).getAttribute("display")||(resizeSeal$$module$webapp$kinggrid$signature_all[a.id]=a)});a.on("removeAt",function(a){delete resizeSeal$$module$webapp$kinggrid$signature_all[a.id]});a.on("beforeShowAt",function(a){3960<this.signatureData.seal.imgdata.length&&isIE8$$module$webapp$kinggrid$signature_all&&
(this.brokenImgDiv=a)});a.on("showAt",function(b){if(a.brokenImgDiv){var c=a.signatureData.seal,d=c.signsn;aisleKing$$module$webapp$kinggrid$signature_all&&(aisleKing$$module$webapp$kinggrid$signature_all=kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.serverUrl),aisleKing$$module$webapp$kinggrid$signature_all.request(a.imageUrl,{signsn:d,sealImg:c.imgdata,sid:a.signatureid}).ret(function(c){c.result&&(c=c.imageUrl||a.imageUrl+"_",$$$module$webapp$kinggrid$signature_all(b).find(".kg-img").attr({src:Signature$$module$webapp$kinggrid$signature_all.options.serverUrl+
c+"&a0=0&sid="+a.signatureid}),delete a.brokenImgDiv)}))}});a.on("showAt",function(b){b=$$$module$webapp$kinggrid$signature_all(b);if(0<=$$$module$webapp$kinggrid$signature_all().jquery.indexOf("1.4"))b.live("click",function(){var b=a._verify(null,{sucCall:function(){a.signatureInfo()}});void 0!==Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo(a.modified,
a.modifiedItems,a.signatureData)||null!=b&&a.signatureInfo()});else b.on("click",function(){var b=a._verify(null,{sucCall:function(){a.signatureInfo()}});void 0!==Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo(a.modified,a.modifiedItems,a.signatureData)||null!=b&&a.signatureInfo()});b.append('<div class="kgImgIcons kg-img-icons" ></div>')});
a.on("handleImg",function(b){var c=$$$module$webapp$kinggrid$signature_all(b);c.find(".kg-img-icon").remove();if(options$$module$webapp$kinggrid$signature_all.icons){c=c.children(".kg-img-icons");for(var d=options$$module$webapp$kinggrid$signature_all.icons.length-1;0<=d;d--){var e=options$$module$webapp$kinggrid$signature_all.icons[d];if(Utils$$module$webapp$kinggrid$signature_all.val(e.enable,a,b)){"doornotmove"==e.id&&(a.signatureData.moveable?(e.iconClass=e.iconClass.substring(0,13)+"not",e.title=
kinggrid.msg("SignatureMoveNot","KG_TITLE"),e.value="0"):(e.iconClass=e.iconClass.substring(0,13)+"do",e.title=kinggrid.msg("SignatureMoveDo","KG_TITLE"),e.value="1"));if("moveSignature"==e.id&&!a.signatureData.moveable)break;var f=$$$module$webapp$kinggrid$signature_all('<a href="#" title="'+e.title+'" class="kg-img-icon" id="kg-img-icon-'+e.id+"-"+this.signatureid+'"><i class="'+e.iconClass+'"></i></a>');e.value&&(f=$$$module$webapp$kinggrid$signature_all('<a href="#" title="'+e.title+'" class="kg-img-icon" id="kg-img-icon-'+
e.id+"-"+this.signatureid+'" extval="'+e.value+'"><i class="'+e.iconClass+'"></i></a>'));c.append(f);e.exec&&e.exec.call(a,b);(function(b,c,d){f.click(function(c){c.imgDiv=b;d.call(a,c,b)})})(b,f,e.click||function(a){a.preventDefault();a.stopPropagation()})}}}})},signatureInfo:function(){this.html2Escape=Utils$$module$webapp$kinggrid$signature_all.html2Escape;return this.showDialog("signatureInfoBtl",{target:this,onCancel:!1,onShow:function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&
Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call();var a=this.find(".kg-tab");this.tab=Utils$$module$webapp$kinggrid$signature_all.tab(a)}})},signInfo:function(){var a={title:kinggrid.msg("SignVerify","KG_TITLE"),target:this,onCancel:!1,onShow:function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call()}};return this.showDialog("signInfoBtl",a)},handWriteDlg:function(a,
b){this.canvasHeight=a.canvas_height||500;this.canvasWidth=a.canvas_width||670;var c={title:kinggrid.msg("HWSignature","KG_TITLE"),target:this,onCancel:!1},d=this.showDialog("handwritedlg",c),e=d.find("#canvasId")[0];a.penColor=d.find("#hw_color").val();a.minWidth=.5;a.maxWidth=4.5;if(e.getContext){var f=new SignaturePad$$module$webapp$kinggrid$signature_all(e,a);e.onmouseleave=function(a){f.simulate_mouseevent(e,"mouseup");f.simulate_mouseevent(d.find("#kg-handwrite")[0],"mouseup")};d.find("#hw_color").click(function(){var a=
d.find("#hw_color").val();f.penColor=a});d.find("#hw_width").click(function(){switch(d.find("#hw_width").val()){case "1":f.minWidth=.5;f.maxWidth=2.5;break;case "2":f.minWidth=.5;f.maxWidth=4.5;break;case "3":f.minWidth=1;f.maxWidth=6;break;case "4":f.minWidth=1;f.maxWidth=8;break;case "5":f.minWidth=2.5;f.maxWidth=10;break;case "6":f.minWidth=3;f.maxWidth=12;break;default:f.minWidth=.5,f.maxWidth=2.5}});c=d.find("#clearid");var g=d.find("#okid");c.click(function(){f.clear()});g.click(function(){d.close();
var c=f.toDataURL().replace(/^data:image\/\w+;base64,/,"");c&&(c={height:a.image_height||"5.00",width:a.image_width||"6.70",imageData:c,name:d.find("#nameid").val()},b(c),d.remove())});d.find(".ui-dialog-close").click(function(){d.close();a.onCancel&&a.onCancel.call()})}else d.close(),a.onError?a.onError.call():this.error({errcode:"11113"},"then")},fingerPrintsDevice:function(a,b){var c=this;kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1",
"4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode).invoke("KGRunFingerPrints",a.device_type||"0",a.image_type||"gif","JSComServer","","").ret(function(d){if(d.result){var e=d.FingerPrintsMap,f=parseFloat(254*d.ImageWidth/9600).toFixed(2);d=parseFloat(254*d.ImageHeight/9600).toFixed(2);b({width:a.image_height||f,height:a.image_width||d,imageData:e,name:"\u6307\u7eb9\u7b7e\u540d"})}else c.errorCallback(d,a.errorCall,"KGRunFingerPrints")})},handWriteDevice:function(a,
b){var c=this;void 0!=a.copy_right&&null!=a.copy_right&&kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode).invoke("KGRunHandWritten",a.device_type||"0",a.copy_right,"JSComServer","","").ret(function(d){if(d.result){var e=d.HandWrittenValue,f=parseFloat(254*d.ImageWidth/9600).toFixed(2);d=parseFloat(254*d.ImageHeight/9600).toFixed(2);
b({width:a.image_height||f,height:a.image_width||d,imageData:e,name:"\u624b\u5199\u7b7e\u540d"})}else c.errorCallback(d,a.errorCall,"KGRunHandWritten")})},eqpHandWriter:function(a,b){var c=this;void 0!=a.Value&&null!=a.Value&&kinggrid.surry(Signature$$module$webapp$kinggrid$signature_all.options.clientUrl,"IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319",Signature$$module$webapp$kinggrid$signature_all.options.clientCode).invoke("KGEQPHandWriter",a.Value,a.DllName,"JSComServer").ret(function(d){if(d.result){var e=
d.imagedata,f=parseFloat(254*d.imagewidth/9600).toFixed(2);d=parseFloat(254*d.imageheight/9600).toFixed(2);b({width:a.image_height||f,height:a.image_width||d,imageData:e,name:"\u624b\u5199\u5c4f\u7b7e\u540d"})}else c.errorCallback(d,a.errorCall,"KGEQPHandWriter")})},barCodeDlg:function(a,b){if(void 0!=a.content&&null!=a.content){var c=$$$module$webapp$kinggrid$signature_all("#output").qrcode(a.content);b({height:a.image_height||"5",width:a.image_width||"5",imageData:c,name:"\u4e8c\u7ef4\u7801"})}},
scanBCDlg:function(a,b){var c={title:kinggrid.msg("scanBCSignature","KG_TITLE"),target:this,onCancel:!1},d=this.showDialog("scanBCdlg",c);try{var e=document.getElementById("canvas_scanBC").getContext("2d"),f=document.getElementById("video");c={video:!0,audio:!1};var g=!0,h=function(a){g=!1;a.PERMISSION_DENIED?alert("\u7528\u6237\u62d2\u7edd\u4e86\u6d4f\u89c8\u5668\u8bf7\u6c42\u5a92\u4f53\u7684\u6743\u9650","\u63d0\u793a"):a.NOT_SUPPORTED_ERROR?alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668",
"\u63d0\u793a"):a.MANDATORY_UNSATISFIED_ERROR?alert("\u6307\u5b9a\u7684\u5a92\u4f53\u7c7b\u578b\u672a\u63a5\u6536\u5230\u5a92\u4f53\u6d41","\u63d0\u793a"):alert("\u7cfb\u7edf\u672a\u80fd\u83b7\u53d6\u5230\u6444\u50cf\u5934\uff0c\u8bf7\u786e\u4fdd\u6444\u50cf\u5934\u5df2\u6b63\u786e\u5b89\u88c5\u3002\u6216\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\uff0c\u91cd\u8bd5","\u63d0\u793a")};if(navigator.getUserMedia){if(-1<navigator.userAgent.indexOf("MQQBrowser"))return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668",
"\u63d0\u793a"),!1;navigator.getUserMedia(c,function(a){f.src=a;f.play()},h)}else if(navigator.webkitGetUserMedia)navigator.webkitGetUserMedia(c,function(a){f.src=window.webkitURL.createObjectURL(a);f.play()},h);else if(navigator.mozGetUserMedia)navigator.mozGetUserMedia(c,function(a){f.src=window.URL.createObjectURL(a);f.play()},h);else if(navigator.msGetUserMedia)navigator.msGetUserMedia(c,function(a){$$$module$webapp$kinggrid$signature_all(document).scrollTop($$$module$webapp$kinggrid$signature_all(window).height());
f.src=window.URL.createObjectURL(a);f.play()},h);else return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668"),!1;g&&alert("\u4e3a\u4e86\u83b7\u5f97\u66f4\u51c6\u786e\u7684\u6d4b\u8bd5\u7ed3\u679c\uff0c\u8bf7\u5c3d\u91cf\u5c06\u4e8c\u7ef4\u7801\u7f6e\u4e8e\u6846\u4e2d\uff0c\u7136\u540e\u8fdb\u884c\u62cd\u6444\u3001\u626b\u63cf\u3002 \u8bf7\u786e\u4fdd\u6d4f\u89c8\u5668\u6709\u6743\u9650\u4f7f\u7528\u6444\u50cf\u529f\u80fd");
var k=setTimeout(function(){e&&(e.drawImage(f,0,0,320,320),$$$module$webapp$kinggrid$signature_all("#contentHolder").html5_qrcode(function(c){$$$module$webapp$kinggrid$signature_all("#read").html(c);d.close();alert(c);a.content=c;barCodeDlg(a,b);window.clearInterval(k)},function(a){$$$module$webapp$kinggrid$signature_all("#read_error").html(a);d.close();window.clearInterval(k)},function(a){$$$module$webapp$kinggrid$signature_all("#vid_error").html(a);d.close();window.clearInterval(k)}))},200)}catch(l){printHtml("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301HTML5 CANVAS")}}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-move",title:kinggrid.msg("moveSignature","KG_TITLE"),id:"moveSignature",enable:function(a){return this.canMove(a)},exec:function(a){var b=this;(function(a,d){0<=$$$module$webapp$kinggrid$signature_all().jquery.indexOf("1.4")?($$$module$webapp$kinggrid$signature_all(d).live("touchstart mousedown",".kg-icon-move",function(c){a&&b.runMove(c,d)}),$$$module$webapp$kinggrid$signature_all(d).live("touchstart mouseover",".kg-icon-move",
function(b){void 0!==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(b=d.attributes.signatureid.nodeValue)&&void 0!==Signature$$module$webapp$kinggrid$signature_all.options.extra[b]&&Signature$$module$webapp$kinggrid$signature_all.options.extra[b].icon_move&&(a=Signature$$module$webapp$kinggrid$signature_all.options.extra[b].icon_move())})):($$$module$webapp$kinggrid$signature_all(d).on("touchstart mousedown",".kg-icon-move",function(c){a&&b.runMove(c,d)}),$$$module$webapp$kinggrid$signature_all(d).on("touchstart mouseover",
".kg-icon-move",function(b){void 0!==Signature$$module$webapp$kinggrid$signature_all.options.extra&&(b=d.attributes.signatureid.nodeValue)&&void 0!==Signature$$module$webapp$kinggrid$signature_all.options.extra[b]&&Signature$$module$webapp$kinggrid$signature_all.options.extra[b].icon_move&&(a=Signature$$module$webapp$kinggrid$signature_all.options.extra[b].icon_move())}))})(!0,a)}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-move-",title:kinggrid.msg("SignatureMoveNot","KG_TITLE"),id:"doornotmove",enable:!0,click:function(a){var b=this;a.preventDefault();a.stopPropagation();var c=a.target.parentElement,d=function(a){$$$module$webapp$kinggrid$signature_all(a).attr("extval")&&"0"==$$$module$webapp$kinggrid$signature_all(a).attr("extval")?b.changeMoveAble(!1):b.changeMoveAble(!0)};b.signatureData.html2?b.error({errcode:"11112"},"then"):"server"==
Signature$$module$webapp$kinggrid$signature_all.options.sealType?Signature$$module$webapp$kinggrid$signature_all.options.keysn==b.signatureData.keysn?d(c):b.error({errcode:"11111"},"then"):"client"==Signature$$module$webapp$kinggrid$signature_all.options.sealType&&b.sealService.getKeysn({},function(a){a==b.signatureData.keysn?d(c):b.error({errcode:"11111"},"then")})}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-remove",title:kinggrid.msg("RevokeSignature","KG_TITLE"),id:"revokeSignature",enable:function(){return this.canDelete()},click:function(a){a.preventDefault();a.stopPropagation();this.revokeSignature()}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-sign",title:kinggrid.msg("SignSignature","KG_TITLE"),id:"sign",enable:function(){return this.canSign()},click:function(a){a.preventDefault();a.stopPropagation();a=this._verify(null,{sucCall:function(){this.signSignature()}});null!=a&&(a?this.signSignature():Signature$$module$webapp$kinggrid$signature_all.alert(kinggrid.msg("invalid_signdata","KG_MSG"),function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall&&
Signature$$module$webapp$kinggrid$signature_all.options.beginDlgOkCall.call()},function(){Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall&&Signature$$module$webapp$kinggrid$signature_all.options.beginDlgShowCall.call()}))}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-signverify",title:kinggrid.msg("SignVerify","KG_TITLE"),id:"verifysign",enable:function(){return this.signatureData.signMeta},click:function(a){a.preventDefault();a.stopPropagation();var b=this;b.verifySignData(function(a){a.errcode?b.error(a):b.signInfo()})}});
Signature$$module$webapp$kinggrid$signature_all.addIcon({iconClass:"kg-icon-sealinfo",title:kinggrid.msg("SignatureVerify","KG_TITLE"),id:"signatureInfo",enable:!0,click:function(a){a.preventDefault();a.stopPropagation();a=this._verify(null,{sucCall:function(){this.signatureInfo()}});void 0!==Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo&&Signature$$module$webapp$kinggrid$signature_all.options.verifySignatureInfo(this.modified,
this.modifiedItems,this.signatureData)||null!=a&&this.signatureInfo()}});
var getsec$$module$webapp$kinggrid$signature_all=function(a){var b=1*a.substring(1,a.length);a=a.substring(0,1);if("s"==a)return 1E3*b;if("h"==a)return 36E5*b;if("d"==a)return 864E5*b},setCookie$$module$webapp$kinggrid$signature_all=function(a,b,c){c=getsec$$module$webapp$kinggrid$signature_all(c);var d=new Date;d.setTime(d.getTime()+1*c);document.cookie=a+"="+escape(b)+";expires="+d.toGMTString()},getCookie$$module$webapp$kinggrid$signature_all=function(a){var b;return(b=document.cookie.match(new RegExp("(^| )"+
a+"=([^;]*)(;|$)")))?unescape(b[2]):null},delCookie$$module$webapp$kinggrid$signature_all=function(a){var b=new Date;b.setTime(b.getTime()-1);var c=getCookie$$module$webapp$kinggrid$signature_all(a);null!=c&&(document.cookie=a+"="+c+";expires="+b.toGMTString())};
Signature$$module$webapp$kinggrid$signature_all.prototype.onshowSealsDialog_PW=function(a){var b=this.keysn||this.keyData.keysn;"true"==getCookie$$module$webapp$kinggrid$signature_all("ck")&&a.find("#kg-remenberPwd").attr("checked","checked");if(a.find("#kg-remenberPwd").is(":checked")){var c=getCookie$$module$webapp$kinggrid$signature_all("ksn");b==c&&(a=a.find("#kg-password"),b=getCookie$$module$webapp$kinggrid$signature_all("pwd"),Signature$$module$webapp$kinggrid$signature_all.options.pw_enc_save&&
(b=Utils$$module$webapp$kinggrid$signature_all.Base64.of().decode(b)),null!=b?a.val(b):a.val("123"))}};
Signature$$module$webapp$kinggrid$signature_all.prototype.onexecSuccess=function(a,b,c){var d=this.keysn||this.keyData.keysn;if(c){var e=getCookie$$module$webapp$kinggrid$signature_all("ksn");a=Signature$$module$webapp$kinggrid$signature_all.options.pw_timeout;c=function(a){if(d!=e){if("undefined"==typeof a||0>a.indexOf("s")&&0>a.indexOf("h")&&0>a.indexOf("d"))a="s1800";Signature$$module$webapp$kinggrid$signature_all.options.pw_enc_save&&(b=Utils$$module$webapp$kinggrid$signature_all.Base64.of().encode(b));
setCookie$$module$webapp$kinggrid$signature_all("ksn",d,a);setCookie$$module$webapp$kinggrid$signature_all("pwd",b,a);setCookie$$module$webapp$kinggrid$signature_all("ck","true",a)}};Signature$$module$webapp$kinggrid$signature_all.options.pw_server_timeout?this.sealService.getPwdSaveTime(c,a):c(a)}else delCookie$$module$webapp$kinggrid$signature_all("ksn"),delCookie$$module$webapp$kinggrid$signature_all("pwd"),delCookie$$module$webapp$kinggrid$signature_all("ck")};
function Queue$$module$webapp$kinggrid$signature_all(a){var b=[];this.push=function(c){if(null==c)return!1;null==a||isNaN(a)||b.length==a&&this.pop();b.unshift(c);return!0};this.pop=function(){return b.pop()};this.size=function(){return b.length};this.quere=function(){return b}}
var SignaturePad$$module$webapp$kinggrid$signature_all=function(a){var b=function(a,b){var c=this;b=b||{};this.velocityFilterWeight=b.velocityFilterWeight||.7;this.minWidth=b.minWidth||.5;this.maxWidth=b.maxWidth||2.5;this.dotSize=b.dotSize||function(){return(this.minWidth+this.maxWidth)/2};this.penColor=b.penColor||"black";this.backgroundColor=b.backgroundColor||"rgba(0,0,0,0)";this.onEnd=b.onEnd;this.onBegin=b.onBegin;this._canvas=a;this._ctx=a.getContext("2d");this._ctx.lineJoin="round";this._ctx.lineCap=
"round";this.count=0;this.clear();this.ptQueue=new Queue$$module$webapp$kinggrid$signature_all(6);this.testTimer=function(){};this.funcCompleteListener=function(){for(var a=c.maxWidth;0<c.ptQueue.size();){console.log(a+"----"+c.ptQueue.size());var b=c.ptQueue.pop();this.curPos=b;c._drawLine(a);this.oldPos=b;a-=a/10}};this._handleMouseDown=function(a){1===a.which&&(c._mouseButtonDown=!0,c._strokeBegin(a))};this._handleMouseMove=function(a){c._mouseButtonDown&&c._strokeUpdate(a)};this._handleMouseUp=
function(a){1===a.which&&c._mouseButtonDown&&(c._mouseButtonDown=!1,c._strokeEnd(a))};this._handleTouchStart=function(a){1==a.targetTouches.length&&c._strokeBegin(a.changedTouches[0])};this._handleTouchMove=function(a){a.preventDefault();c._strokeUpdate(a.targetTouches[0])};this._handleTouchEnd=function(a){a.target===c._canvas&&(a.preventDefault(),c._strokeEnd(a))};this._handleTouchCancel=function(a){a.target===c._canvas&&(a.preventDefault(),c._strokeEnd(a))};this._handleMouseEvents();this._handleTouchEvents()};
b.prototype.simulate_mouseevent=function(b,c){if(void 0!==b&&null!==b)if(a.all)b.fireEvent("on"+c);else{var d=a.createEvent("MouseEvents");d.initEvent(c,!0,!0);b.dispatchEvent(d)}};b.prototype.clear=function(){var a=this._ctx,b=this._canvas;a.fillStyle=this.backgroundColor;a.clearRect(0,0,b.width,b.height);a.fillRect(0,0,b.width,b.height);this._reset()};b.prototype.toDataURL=function(a,b){var c=this._canvas;return c.toDataURL.apply(c,arguments)};b.prototype.fromDataURL=function(a){var b=this,c=new Image,
d=window.devicePixelRatio||1,e=this._canvas.width/d,l=this._canvas.height/d;this._reset();c.src=a;c.onload=function(){b._ctx.drawImage(c,0,0,e,l)};this._isEmpty=!1};b.prototype._strokeUpdate=function(a){a=this._createPoint(a);this._ctx.fillStyle=this.penColor;this._ctx.strokeStyle=this.penColor;this.curPos=a;this._drawLine();this.oldPos=this.curPos};b.prototype._strokeBegin=function(a){for(this._reset();0<this.ptQueue.size();)this.ptQueue.pop();this.oldPos=this._createPoint(a);self.oldPos=self.curPos;
this.penPress=0;this.LstTrans=.1;this.LstSize=0;this._ctx.fillStyle=this.penColor;this._ctx.strokeStyle=this.penColor;this.count=0;if("function"===typeof this.onBegin)this.onBegin(a)};b.prototype._strokeDraw=function(a){var b=this._ctx,c="function"===typeof this.dotSize?this.dotSize():this.dotSize;b.beginPath();this._drawPoint(a.x,a.y,c);b.closePath();b.fill()};b.prototype._strokeEnd=function(a){this.penPress=0;this.oldPos=this.curPos;if("function"===typeof this.onEnd)this.onEnd(a)};b.prototype._handleMouseEvents=
function(){this._mouseButtonDown=!1;this._canvas.addEventListener("mousedown",this._handleMouseDown);this._canvas.addEventListener("mousemove",this._handleMouseMove);this._canvas.addEventListener("mouseup",this._handleMouseUp)};b.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none";this._canvas.style.touchAction="none";this._canvas.addEventListener("touchstart",this._handleTouchStart);this._canvas.addEventListener("touchmove",this._handleTouchMove);this._canvas.addEventListener("touchend",
this._handleTouchEnd);this._canvas.addEventListener("touchcancel",this._handleTouchCancel)};b.prototype.on=function(){this._handleMouseEvents();this._handleTouchEvents()};b.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown);this._canvas.removeEventListener("mousemove",this._handleMouseMove);this._canvas.removeEventListener("mouseup",this._handleMouseUp);this._canvas.removeEventListener("touchstart",this._handleTouchStart);this._canvas.removeEventListener("touchmove",
this._handleTouchMove);this._canvas.removeEventListener("touchend",this._handleTouchEnd);this._canvas.removeEventListener("touchcancel",this._handleTouchCancel)};b.prototype.isEmpty=function(){return this._isEmpty};b.prototype._reset=function(){this.points=[];this._lastVelocity=0;this._lastWidth=(this.minWidth+this.maxWidth)/2;this._isEmpty=!0;this._ctx.fillStyle=this.penColor};b.prototype._createPoint=function(a){var b=this._canvas.getBoundingClientRect();return new c(a.clientX-b.left,a.clientY-
b.top)};b.prototype._addPoint=function(a){var b=this.points;b.push(a);if(2<b.length){3===b.length&&b.unshift(b[0]);var c=this._calculateCurveControlPoints(b[0],b[1],b[2]);a=c.c2;c=this._calculateCurveControlPoints(b[1],b[2],b[3]);c=c.c1;a=new d(b[1],a,c,b[2]);this._addCurve(a);b.shift()}};b.prototype._calculateCurveControlPoints=function(a,b,d){var e=a.x-b.x,f=a.y-b.y,g=b.x-d.x,m=b.y-d.y,p=(a.x+b.x)/2;a=(a.y+b.y)/2;var n=(b.x+d.x)/2;d=(b.y+d.y)/2;g=Math.sqrt(g*g+m*m);f=g/(Math.sqrt(e*e+f*f)+g);e=
b.x-(n+(p-n)*f);b=b.y-(d+(a-d)*f);return{c1:new c(p+e,a+b),c2:new c(n+e,d+b)}};b.prototype._addCurve=function(a){var b=a.endPoint.velocityFrom(a.startPoint);b=this.velocityFilterWeight*b+(1-this.velocityFilterWeight)*this._lastVelocity;var c=this._strokeWidth(b);this._drawCurve(a,this._lastWidth,c);this._lastVelocity=b;this._lastWidth=c};b.prototype._drawPoint=function(a,b,c){var d=this._ctx;d.moveTo(a,b);d.arc(a,b,c,0,2*Math.PI,!1);this._isEmpty=!1};b.prototype._drawCurve=function(a,b,c){var d=this._ctx;
c-=b;var e;var f=Math.floor(a.length());d.beginPath();for(e=0;e<f;e++){var g=e/f;var p=g*g;var n=p*g;var r=1-g;var q=r*r;var B=q*r;var v=B*a.startPoint.x;v+=3*q*g*a.control1.x;v+=3*r*p*a.control2.x;v+=n*a.endPoint.x;B*=a.startPoint.y;B+=3*q*g*a.control1.y;B+=3*r*p*a.control2.y;B+=n*a.endPoint.y;g=b+n*c;this._drawPoint(v,B,g)}d.closePath();d.fill()};b.prototype._drawLine=function(a){var b;var c=a||this.maxWidth;0==this.curPos.x-this.oldPos.x&&(this.curPos.x+=.1);0==this.curPos.y-this.oldPos.y&&(this.curPos.y+=
.1);a=this.curPos.x-this.oldPos.x;var d=this.curPos.y-this.oldPos.y;this.penPress=Math.round(this.penPress+(Math.max((1024-5*Math.pow(a*a+d*d,.5))/10,5)-this.penPress)/3);d=this.penPress/100;a=1*d;c=d*c*2;1<a?a=1:.2>a&&(a=.2);d=this.curPos.x-this.oldPos.x;var e=this.curPos.y-this.oldPos.y;var l=c-this.LstSize;var m=a-this.LstTrans;if(Math.abs(d)>=Math.abs(e)&&0<Math.abs(d)){var p=Math.abs(d);var n=0<d?1:-1;var r=e/p;var q=l/p;var B=m/p;var v=this.oldPos.x;var E=this.oldPos.y;for(b=0;b<=p;b++){var x=
this.oldPos.x+n*b;var y=this.oldPos.y+r*b;var z=this.LstSize+q*b;var u=this.LstTrans+B*b;this._ctx.globalAlpha=Math.max(u,.85);this._ctx.lineWidth=Math.max(z,1);this._ctx.beginPath();this._ctx.moveTo(Math.round(v-.1*n),Math.round(E-.1*n));this._ctx.lineTo(Math.round(x+.1*n),Math.round(y+.1*n));this._ctx.stroke();this._ctx.closePath();v=x;E=y}}if(Math.abs(e)>=Math.abs(d)&&0<Math.abs(e))for(p=Math.abs(e),n=0<e?1:-1,r=d/p,q=l/p,B=m/p,v=this.oldPos.x,E=this.oldPos.y,b=0;b<=p;b++)x=this.oldPos.x+r*b,y=
this.oldPos.y+n*b,z=this.LstSize+q*b,u=this.LstTrans+B*b,this._ctx.globalAlpha=Math.max(u,.85),this._ctx.lineWidth=Math.max(z,1),this._ctx.beginPath(),this._ctx.moveTo(Math.round(v-.1*n),Math.round(E-.1*n)),this._ctx.lineTo(Math.round(x+.1*n),Math.round(y+.1*n)),this._ctx.stroke(),this._ctx.closePath(),v=x,E=y;this.LstTrans=a;this.LstSize=c};b.prototype._strokeWidth=function(a){return Math.max(this.maxWidth/(a+1),this.minWidth)};var c=function(a,b,c){this.x=a;this.y=b;this.time=c||(new Date).getTime()};
c.prototype.velocityFrom=function(a){return this.time!==a.time?this.distanceTo(a)/(this.time-a.time):1};c.prototype.distanceTo=function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))};var d=function(a,b,c,d){this.startPoint=a;this.control1=b;this.control2=c;this.endPoint=d};d.prototype.length=function(){var a=0,b;for(b=0;10>=b;b++){var c=b/10;var d=this._point(c,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x);c=this._point(c,this.startPoint.y,this.control1.y,
this.control2.y,this.endPoint.y);if(0<b){var k=d-k;var l=c-l;a+=Math.sqrt(k*k+l*l)}k=d;l=c}return a};d.prototype._point=function(a,b,c,d,k){return b*(1-a)*(1-a)*(1-a)+3*c*(1-a)*(1-a)*a+3*d*(1-a)*a*a+k*a*a*a};return b}(document),$jscompDefaultExport$$module$webapp$kinggrid$signature_all=Signature$$module$webapp$kinggrid$signature_all,module$webapp$kinggrid$signature_all={};module$webapp$kinggrid$signature_all.default=$jscompDefaultExport$$module$webapp$kinggrid$signature_all;
// V2.0.0.388
export default Signature;
